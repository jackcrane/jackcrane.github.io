var Bb=Backbone,Bbc=Backbone.Collection,Bbm=Backbone.Model,Hb=Handlebars;var p3=_.extend({_history:[],_modules:{},_title:null,_titleExtra:null,_router:null,_modalHeightTimer:null,_modalScrollTop:null,_lastError:null,_currentMainView:false,_confirmMode:{Enabled:false},Config:{},Data:{},Us:{},module:(function(){return function(a){if(p3._modules[a]){return p3._modules[a]}p3._modules[a]=_.extend({Ms:{},Cs:{},Vs:{},Us:{},Data:{}},Bb.Events);return p3._modules[a]}}()),router:function(){if(p3._router===null){var a=Bb.Router.extend({initialize:function(){this.bind("all",function(d,b){var c=d.split(":");if(c[0]==="beforeroute"){p3.setTitle();if(p3.Layout.Containers.Modal&&p3.Layout.Containers.Modal.hasClass("in")){p3.Layout.Containers.Modal.off("hide.goback");p3.Layout.Containers.Modal.modal("hide")}if(p3.Layout.Containers.LowerNav&&p3.Layout.Containers.LowerNav.has(":first-child")){p3.hideLowerNav()}}if(c[0]==="route"){p3.trigger("route");p3.exitConfirmMode();if(c.length>1){p3._history.push(Bb.history.location.hash);p3.logAction(c[1])}}})},route:function(d,c,b){var e=this;p3.on("contextLoaded",function(){var f;if(p3.Data.Context){f=_.find(p3.Data.Context.get("Tasks"),function(g){return g.HashString&&g.HashString.replace("#","")===d})}if(c==="home"||c.indexOf("login")>-1||f){return Bb.Router.prototype.route.call(e,d,c,function(){e.trigger.apply(e,["beforeroute:"+c].concat(_.toArray(arguments)));b.apply(e,arguments)})}})}});p3._router=new a();p3._router.route("*path","home",function(b){p3.clearContainer(p3.Layout.Containers.MainPage)})}return p3._router},initializeApp:function(a){$(document).ready(function(){p3.trigger("initStart");var b=p3.module("app");p3.setConfig(a);$("HTML").addClass("site-mode-"+p3.Config.AppMode.Name.toLowerCase());p3.Layout=new b.Vs.Layout(a);p3.Layout.render($("#app"))})},initializeEmbed:function(a){$(document).ready(function(){p3.trigger("initStart");var b=p3.module("app");a.AppMode=p3.Us.Enum.AppModes.EMBED;p3.setConfig(a);p3.Layout=new b.Vs.LayoutEmbed(a);p3.Layout.render($("#app"))})},initializeLogin:function(a){$(document).ready(function(){p3.trigger("initStart");var b=p3.module("login");p3.setConfig(a);p3.Layout=new b.Vs.Layout({});p3.Layout.render($("#app"))})},setConfig:function(a){p3.Config=a||{};if(!p3.Config.AppMode){p3.Config.AppMode=p3.Us.Enum.AppModes.WEBAPP}p3.Config.RootPath="/app/";if(p3.Config.SourceUrl!==undefined&&p3.Config.SourceUrl.length>0){p3.Config.SourceRootPath=p3.Config.SourceUrl+"/"+p3.Config.Version}else{p3.Config.SourceRootPath="/app"}p3.Config.TemplatePath=p3.Config.SourceRootPath+"/src/ui/templates/";if(p3.Config.AppMode===p3.Us.Enum.AppModes.PODIUM){p3.Config.useNavIcon=p3.getSessionState("useNavIcon")}else{p3.setSessionState("useNavIcon",p3.Config.useNavIcon)}if(!p3.Config.useNavIcon){$("HTML").addClass("no-nav-icon")}aP="/api/";p3.Config.CssImagePath="{libsUrl}/p3-cache/img/";if(!p3.Config.FtpImagePath){p3.Config.FtpImagePath="/ftpimages/{sid}/"}if(!p3.Config.PhotonUrl){p3.Config.PhotonUrl="{photonUrl}/ftpimages/{sid}/"}if(!p3.Config.PhotonForUserPhotoUrl){p3.Config.PhotonForUserPhotoUrl="{photonUrl}/ftpimages/{sid}/user/"}if(!p3.Config.PhotonForTempUrl){p3.Config.PhotonForTempUrl="{photonUrl}/temp/{sid}/"}p3.Config.FtpImagePathNoCDN="/ftpimages/{sid}/";p3.trigger("configSet")},setConfigPlaceholders:function(){var a,b;p3.Config.SchoolId=p3.Data.SchoolContext.getSchoolId();p3.Config.LabelDictionary=p3.Data.SchoolContext.getLabelDictionary();p3.Config.IsSmallCollege=p3.Data.SchoolContext.getSmallCollegeIndicator();for(a in p3.Config){if(p3.Config.hasOwnProperty(a)){b=p3.Config[a];if(_.isString(b)){b=b.replace(/\{sid\}/g,p3.Config.SchoolId);if(a.toLowerCase().indexOf("photon")!==-1){b=b.replace(/\{photonUrl\}/g,p3.Data.SchoolContext.getPhotonUrl())}if(a.toLowerCase().indexOf("cssimage")!==-1){b=b.replace(/\{libsUrl\}/g,p3.Data.SchoolContext.getLibrariesUrl())}}p3.Config[a]=b}}},fT:function(e,b,d){var g,f,c=(p3.Config.Version&&!p3.Config.IsDebug)?true:false,a=c?{v:p3.Config.Version||null}:null;if(!e){return b(null)}if(!Hb.templates){Hb.templates={}}e=e.toLowerCase();if(!Hb.templates[e]){f=(d&&d.RootPath)?d.RootPath.toLowerCase():p3.Config.TemplatePath;Hb.templates[e]={Compiled:null,_deferred:null,Deferred:function(){if(!this._deferred){this._deferred=$.ajax({data:a,url:f.toLowerCase()+e,cache:c,dataType:"html",success:function(h){if(p3.Config.IsDebug&&e!=="shared/modal.template.html"){h="<!--Begin: "+e+"-->"+h+"<!--End: "+e+"-->"}g.Compiled=Hb.compile(h.replace(/(\r\n|\n|\r|\t)/gm,""))}})}return this._deferred}}}g=Hb.templates[e];if(g&&g.Compiled!==null){return b(g.Compiled)}$.when(g.Deferred()).then(function(){try{return b(g.Compiled)}catch(h){p3.logError({message:h.message,stack:h.stack});throw h}})},fTs:function(e){var a=$.Deferred(),c=[],d=[],b=function(g){var f=$.Deferred();p3.fT(g,function(h){h.path=g;f.resolve(h)});return f.promise()};_.each(e,function(f){c.push(b(f).then(function(g){d.push(g)}))});$.when.apply($,c).then(function(){a.resolve(d)});return a.promise()},clearContainer:function(b){var a=(b instanceof jQuery)?b:$(b),c=a.data("views");if(c&&c.length>0){_.each(c,function(d){if(d.Containers){_.each(d.Containers,function(e){p3.clearContainer(e)})}d.remove();d.off();if(_.isFunction(d.dispose)){d.dispose()}});a.removeData("views")}a.empty()},setTitle:function(a){p3._title=a;p3._updateTitle()},setTitleExtra:function(a){p3._titleExtra=a;p3._updateTitle()},_updateTitle:function(){var b=p3._title||"",a;if(p3.Data.Context){a=p3.Data.Context.getSelectedPersona()}if(p3._titleExtra!==null){b="("+p3._titleExtra+") "+b}if(a){b=a.Description+(b?" : "+b:"")}document.title=b},rV:function(e,c,b){var a=$(c),d;if(a.length>0){if(b){p3.clearContainer(a)}if(!a.data("views")){a.data("views",[])}d=a.data("views");d.push(e);e.render(c)}},renderMainPage:function(c,b,a){if(p3._currentMainView.Page){if((c.Page&&p3._currentMainView.Page.name!==c.Page.name)){p3._currentMainView.Page.dispose()}}p3.rV(c,p3.Layout.Containers.MainPage,true);p3._currentMainView=c;if(b||a){$("#skyui-header").show();if(b!==true){$("#site-top-spacer").addClass("white-bg")}$("BODY").addClass("sky-bg")}else{$("BODY").removeClass("sky-bg");$("#site-top-spacer").removeClass("white-bg");$("#skyui-header").hide()}p3.renderMainPageHeader(b);p3.renderMainPageMenu(a)},renderSkyBackground:function(){$("BODY").addClass("sky-bg")},renderMainPageHeaderText:function(c,b){var a=p3.module("app");p3.renderMainPageHeader(new a.Vs.HeaderTextOnly({title:c,subTitle:b}))},renderMainPageHeader:function(a){if(!p3.Layout.Containers.MainPageHeader){return}if(a instanceof Bb.View){p3.Layout.Containers.MainPageHeader.parent().show();p3.rV(a,p3.Layout.Containers.MainPageHeader,true)}else{if(typeof a==="string"){p3.Layout.Containers.MainPageHeader.parent().show();p3.renderMainPageHeaderText(a)}else{if(a&&(a.title||a.subTitle)){p3.Layout.Containers.MainPageHeader.parent().show();p3.renderMainPageHeaderText(a.title||"",a.subTitle||"")}else{p3.Layout.Containers.MainPageHeader.parent().hide()}}}},renderMainPageMenu:function(a){if(!p3.Layout.Containers.MainPageMenu){return}if(a){p3.Layout.Containers.MainPageMenu.parent().show();p3.rV(a,p3.Layout.Containers.MainPageMenu,true)}else{p3.Layout.Containers.MainPageMenu.html("");p3.Layout.Containers.MainPageMenu.parent().hide()}},renderFixedSidebar:function(c,b){b=b||{};var a=p3.Layout.Containers.SidebarFixed;p3.rV(c,a,true);$("BODY").addClass("sidebar-fixed");if(b.FullScreen){$("BODY").addClass("sidebar-fullscreen")}if(b.WithFixedHeader){$("BODY").addClass("sidebar-with-header")}p3.Layout.Containers.MainBulletin.addClass("left-nav-spacing");p3.Layout.Containers.EmergencyBulletin.addClass("left-nav-spacing");if(!$("html").hasClass("touch")){a.on("mousewheel DOMMouseScroll",function(d){var f=null;if(d.type==="mousewheel"){f=(d.originalEvent.wheelDelta*-1)}else{if(d.type==="DOMMouseScroll"){f=40*d.originalEvent.detail}}if(f){d.preventDefault();a.scrollTop(f+a.scrollTop())}})}},closeFixedSidebar:function(){var a=p3.Layout.Containers.SidebarFixed;p3.clearContainer(a);$("BODY").removeClass("sidebar-fixed sidebar-fullscreen sidebar-with-header");$("BODY").css("background-color","").css("background-image","");p3.Layout.Containers.MainBulletin.removeClass("left-nav-spacing");p3.Layout.Containers.EmergencyBulletin.removeClass("left-nav-spacing");a.off("mousewheel DOMMouseScroll")},renderFixedFooter:function(a){p3.rV(a,p3.Layout.Containers.FooterFixed,true);$("BODY").addClass("footer-fixed")},closeFixedFooter:function(){p3.clearContainer(p3.Layout.Containers.FooterFixed);$("BODY").removeClass("footer-fixed")},renderLeftSidebarTab:function(c,b){var a=p3.Layout.Containers.SidebarTabLeft;p3.rV(c,a,true)},hideLeftSidebarTab:function(){this.clearContainer(p3.Layout.Containers.SidebarTabLeft)},displayError:function(a){this.displaySiteMessage(a,"alert-danger")},displaySuccess:function(a){this.displaySiteMessage(a,"alert-success")},displaySiteMessage:function(b,c){var a=p3.module("app");p3.rV(new a.Vs.Error({message:b,messageClass:c}),p3.Layout.Containers.Message,true)},slideContent:function(d){var c=$(d),a=c.find(".swaparrow:first"),b=c.find(".slide_content:first");if(b.is(":visible")){b.slideUp();this.slideArrowE(a)}else{b.slideDown();this.slideArrowS(a)}},slideArrowE:function(a){if(a.is(".p3icon-downArrow")){a.removeClass("p3icon-downArrow").addClass("p3icon-sideArrow")}else{a.removeClass("arrow-s").addClass("arrow-e")}},slideArrowS:function(a){if(a.is(".p3icon-sideArrow")){a.removeClass("p3icon-sideArrow").addClass("p3icon-downArrow")}else{a.removeClass("arrow-e").addClass("arrow-s")}},loadingIcon:function(b,a,c,d){a=a?" "+a:"";c=c||"100";d=d||"100";$(b).html('<div style="position:relative; min-height:'+c+"px; min-width:"+d+'px"><div class="sky-wait-mask text-align-center'+a+'"><div class="sky-wait">Loading...</div></div></div>')},addModalContainer:function(b){var a=b===true?'<div tabindex="-1"></div>':'<div class="no-resize" tabindex="-1"></div>';return $(a)},showModal:function(a,b){a.addClass("modal bb-modal").on("hidden hidden.bs.modal",function(){a.removeClass("modal fade")});if(b&&typeof b!=="string"){if(b.backdrop===undefined){b.backdrop="static"}if(b.addClass){a.addClass(b.addClass).on("hidden hidden.bs.modal",function(){a.removeClass(b.addClass)})}if(b.backOnHide){a.on("hide hide.bs.modal",function(){window.history.back()})}else{if(b.prevRoute){a.on("hide hide.bs.modal",function(){p3.router().navigate(b.prevRoute)})}}}if(a.hasClass("modal-fullsize")){a.addClass("no-resize")}a.on("hidden hidden.bs.modal",function(){var e=$(document),d=$("body"),c=$(".modal-backdrop"),f=parseInt(c.css("z-index"),10);a.removeClass();a.css({"margin-top":""});a.off("show shown hide hidden show.bs.modal shown.bs.modal hide.bs.modal hidden.bs.modal hide.goback hide.datepicker hide.tooltip");p3.clearContainer(a);d.removeClass("overflow-none");d.off("scroll",p3.modalScroll);e.off("scroll",p3.modalScroll);e.off("mousedown mousemove touchmove gesturestart",p3.modalTrapScroll);$(window).off("resize.modal");p3.clearModalHeightTimer();if(p3._modalScrollTop===undefined||p3._modalScrollTop===null){p3._modalScrollTop=0}window.setTimeout(function(){d.scrollTop(p3._modalScrollTop)},900);if(b&&b.onHidden){window.setTimeout(function(){b.onHidden()},100)}if(f!==1100){c.css({"z-index":f-1})}});a.on("shown shown.bs.modal",function(){var d=$(document),c=$("body");p3._modalScrollTop=c.scrollTop();c.addClass("overflow-none");c.on("scroll",p3.modalScroll);d.on("scroll",p3.modalScroll);d.on("mousedown mousemove touchmove gesturestart",p3.modalTrapScroll);if(!a.hasClass("no-resize")){p3.initModalHeightTimer(a);$(window).on("resize.modal",function(){p3.setModalHeight(a)})}});a.modal(b||{backdrop:"static"});a.on("hide.datepicker",function(){a.find(".hasDatepicker").each(function(){if(this.datepicker){this.datepicker("destroy")}})});a.on("hide.tooltip",function(){_.each($.find(".tooltip"),function(c){$(c).hide()})})},initModalHeightTimer:function(a){p3.clearModalHeightTimer();if(!a.hasClass("no-resize")){p3._modalHeightTimer=window.setInterval(function(){var b=a.find(".modal-body");if(b.children().length>0){p3.setModalHeight(a)}},100)}},clearModalHeightTimer:function(){if(p3._modalHeightTimer!==null){window.clearInterval(p3._modalHeightTimer);p3._modalHeightTimer=null}},setModalHeight:function(b,g){if(b.modal&&b.hasClass("in")){var d=b.find(".modal-header"),a=b.find(".modal-body"),c=b.find(".modal-footer"),e,f=a.scrollTop();e=(b.outerHeight())-(d.outerHeight())-(c.outerHeight());if(!b.hasClass("bb-modal-fullpage")){e-=60}a.css("max-height",e);a.scrollTop(f);p3.clearModalHeightTimer()}},modalScroll:function(a){a.preventDefault();a.stopPropagation();return false},modalTrapScroll:function(b){var a=$(window.event?event.srcElement:b.target),c=a.hasClass("modal")||a.parents().hasClass("modal");if(!c){b.preventDefault();b.stopPropagation();return false}},showConfirm:function(f,e,d,b,c,a){p3.showConfirmCancel(f,e,d,b,null,c,a)},showConfirmCancel:function(i,h,f,d,b,e,c){var a=p3.module("app");function g(){i=(i===null)?"Confirm":i;h=(h===null)?"Are you sure you want to perform this action?":h;p3.rV(new a.Vs.Confirm({ConfirmationTitle:i,ConfirmationText:h,ConfirmCallback:d,CancelCallback:b,ContainerToHide:e,ConfirmButtonText:c}),e,true);p3.showModal(e,f)}if(!e&&p3.Layout.Containers.Modal.is(":visible")){p3.fT("Shared/modal.template.html",function(j){e=$(j({}));e.modal();$(".modal-backdrop").css("z-index","1101");g()})}else{e=e||p3.Layout.Containers.Modal;g()}},showHtmlEditor:function(c,g,a,d,b){var e=function(){if(p3.Layout.Containers.Modal&&p3.Layout.Containers.Modal.hasClass("in")){p3.setModalHeight(p3.Layout.Containers.Modal)}if(d){d.call()}},f="//libs-e1.myschoolapp.com";if(window.htmlEditorInit===undefined){head.js(f+"/tinymce/3.5.8.6/pd-tinymce-3.5.8.6.js",function(){window.htmlEditorInit(c,g,a,e,b)})}else{window.htmlEditorInit(c,g,a,e,b)}},logAction:function(b){try{if(!p3.Data.Context||!p3.Config.ActionLogEnabled){return}var e=p3.Data.Context.getCurrentTask(),a,d;if(e){a=Bbm.extend({url:"webapp/logaction"});d=new a({TaskId:e.TaskId,TaskName:e.Description,Url:window.location.href});d.save({})}}catch(c){}},logError:function(a){if(!a.message||!a.stack){return}if(p3._lastError&&_.isEqual(p3._lastError,a)){return}p3._lastError=a;try{var e=(p3.Data.Context)?p3.Data.Context.getCurrentTask():{},b=Bbm.extend({url:"webapp/logerror"}),d=new b({TaskId:(e&&e.TaskId)?e.TaskId:0,Url:window.location.href,Message:a.message,StackTrace:a.stack});d.save({})}catch(c){}},switchImage:function(d){var c=1,b,a=$(".img-show");$(".img-show").hide();if(d.target.text==="Next"){if(a.next("div").hasClass("img-box")){b=a.next("div.img-box")}else{b=$("div.img-box:first")}}else{if(a.prev("div").hasClass("img-box")){b=a.prev("div.img-box")}else{b=$("div.img-box:last")}}b.fadeIn();a.removeClass("img-show");a.addClass("img-hide");b.removeClass("img-hide");b.addClass("img-show");c+=b.prevAll("div.img-box").size();$("#lbl_img_cur").text(c);return false},showLowerNav:function(a){a=a||{};this.Layout.Containers.SiteTopSpacer.addClass("site-top-spacer-lower-nav");this.Layout.Containers.LowerNav.addClass("subnavbar subnavbar-fixed").show();if(a.VisibleDesktop){this.Layout.Containers.SiteTopSpacer.addClass("site-top-spacer-lower-nav-desktop");this.Layout.Containers.LowerNav.addClass("visible-desktop").addClass("hidden-sm").addClass("hidden-xs")}},hideLowerNav:function(){this.Layout.Containers.LowerNav.removeClass("subnavbar subnavbar-fixed visible-desktop").hide();this.clearContainer(p3.Layout.Containers.LowerNav);this.Layout.Containers.SiteTopSpacer.removeClass("site-top-spacer-lower-nav site-top-spacer-lower-nav-desktop")},transferHome:function(){window.location.hash="";window.location.href=p3.Config.RootPath},log:function(a){if(window.console&&window.console.log){window.console.log(a)}},logTable:function(a){if(window.console&&window.console.table){window.console.table(a)}else{this.log(a)}},initAjaxMsg:function(){var b=0,c,e,d=null,a=$(document);e=function(){a.skylo("start");if(!d){d=setTimeout(function(){a.skylo("set",50)},1000)}};c=function(){a.skylo("end");if(d){clearTimeout(d);d=null}};a.ajaxSend(function(){b++;e()}).ajaxComplete(function(){b--;if(b<=0){c()}}).ajaxStop(function(){c()})},getSessionState:function(a){var b=p3.getSessionProvier(),c=b.get("session");if(!c){return null}return a?c[a]:c},setSessionState:function(b,e,a){var c=p3.getSessionProvier(),d=c.get("session")||{};d[b]=e;c.set("session",d);if(a){return a()}},getSessionProvier:function(){return new window.Basil({namespace:"p3",storages:["session","local","memory"]})},enterConfirmMode:function(a){a=a||{};a.Enabled=true;a.Message=a.Message||"Are you sure you wish to leave this page?";p3._confirmMode=a},exitConfirmMode:function(){p3._confirmMode={Enabled:false}},setCustomHeader:function(a){var b=(p3.Config&&p3.Config.Version)?p3.Config.Version:"";if(!a){$(document).ajaxSend(function(c,e,d){if(!d.crossDomain){e.setRequestHeader("WH-Version",b)}})}},isAppEapActive:function(a){var b,c=false;for(b=0;b<p3.Config.EAP.length;b++){if(p3.Config.EAP[b].AppEapId===a.Value&&p3.Config.EAP[b].IsEnabled){c=true}}return c}},Bb.Events);jQuery(function(a){window.onbeforeunload=function(){if(p3.Config.AppMode===p3.Us.Enum.AppModes.PODIUM&&window.pdChangeCheck){if(window.pdChangeCheck.runCheck()){p3.enterConfirmMode({Message:"Changes have not been saved."})}else{p3.exitConfirmMode()}}if(p3._confirmMode.Enabled){return p3._confirmMode.Message}};a(document).on("click","a:not([data-bypass])",function(d){var c=a(this),e;if(c.hasClass("pplink")){return true}e=c.attr("href");if(e&&e!=="#"&&e.indexOf("#")===0){d.preventDefault();if(p3._confirmMode.Enabled){if(!window.confirm(p3._confirmMode.Message)){return false}}if(c.data("reload")&&Bb.history.getFragment()===e.replace("#","")){p3.router().navigate("#",false)}p3.router().navigate(e,true)}});function b(){var c=a("#__AjaxAntiForgery").children().val();a(document).ajaxSend(function(d,f,e){if(e.hasContent&&c){if(!e.crossDomain){f.setRequestHeader("RequestVerificationToken",c)}if(e.contentType!==false){f.setRequestHeader("Content-Type",e.contentType)}}})}p3.initAjaxMsg();b();a(document).idleTimer(300000);window.onerror=function(d,e,c){if(!d||!e||!c){return}if(d==="Script error."||c<=0||(e.indexOf("/app/src/")===-1&&e.indexOf("/p3-cache/src/")===-1&&e.indexOf("WebResource.axd")===-1)){return}p3.logError({message:d,stack:e+" Line: "+c})};if(!a.browser){a.browser=head.browser}});p3.on("initStart",function(){Bb._sync=Bb.sync;Bb.sync=function(b,c,d){var e=d.error,a;d.error=function(i,h,f){var g=(i&&i.responseText)?i.responseText:null;if(g&&(g.indexOf("INVALID_SESSION")>0||g.indexOf("UNAUTHORIZED_ACCESS")>0||g.indexOf("Request authorization failed")>0)){if(p3.Data.UserStatus){p3.Data.UserStatus.fetch()}if(g.indexOf("UNAUTHORIZED_ACCESS")<1){return false}}if(g&&(g.indexOf("Invalid HTML")>0)){p3.displayError("Invalid HTML Entered.");return false}if(i&&i.status===418){p3.displayError("Your request has been blocked by our application firewall.");return false}if(_.isFunction(c.unstream)){c.unstream()}if(e){e(i,h,f)}};a=function(f){if(_.isString(f)&&f.length>0){f=f.replace("/?","?");if(f.substr(f.length-1)==="/"){f=f.substring(0,f.length-1)}if(f.indexOf(aP)!==0){f=aP+f}}return f};c.url=a(c.url);c.urlRoot=a(c.urlRoot);if(b.toLowerCase()!=="read"&&d.url){d.url=a(d.url)}return Bb._sync(b,c,d)};Bbc.prototype.save=function(a){var b="update",c;b=(a&&a.method)?a.method:"update";c=(this.sync||Bb.sync).call(this,b,this,a);return c};Bbm.prototype.reset=function(a){this.clear({silent:true});this.set(a,{silent:true})}});p3.on("configSet",function(){p3.setCustomHeader();if($.fn.tooltip.Constructor.DEFAULTS){$.fn.tooltip.Constructor.DEFAULTS.container="body";$.fn.tooltip.Constructor.DEFAULTS.trigger="hover"}});(function(a){a.Captcha={Settings:{ScriptLoaded:false,SiteKey:"6LcYjggTAAAAAFZixPQotuvtEmFn-MSObAelDNa8",ContainerId:"g_recaptcha",ErrorContainerId:"g_recaptcha_error",WidgetId:null,RenderOptions:{}},GetContainer:function(){return'<div id="'+a.Captcha.Settings.ContainerId+'"></div><div class="alert alert-danger" id="'+a.Captcha.Settings.ErrorContainerId+'">Please complete the Captcha test.</div>'},Initialize:function(b){a.Captcha.Dispose();b=b||{};if(!b.sitekey){b.sitekey=a.Captcha.Settings.SiteKey}a.Captcha.Settings.RenderOptions=b;if(a.Captcha.Settings.ScriptLoaded){a.Captcha.Render();return true}var c=document.createElement("script");c.src="https://www.google.com/recaptcha/api.js?onload=reCaptchaCallback&render=explicit";c.async=true;c.defer=true;document.head.appendChild(c);a.Captcha.Settings.ScriptLoaded=true;return true},Dispose:function(){a.Captcha.Settings.RenderOptions={};a.Captcha.Settings.WidgetId=null;$("#"+a.Captcha.Settings.ContainerId).empty();a.Captcha.HideError()},Render:function(){if(a.Captcha.Settings.WidgetId!==null){grecaptcha.reset(a.Captcha.Settings.WidgetId)}else{try{a.Captcha.Settings.WidgetId=grecaptcha.render(a.Captcha.Settings.ContainerId,a.Captcha.Settings.RenderOptions)}catch(b){grecaptcha.reset(a.Captcha.Settings.WidgetId);b=null}}},GetResponse:function(){return grecaptcha.getResponse(a.Captcha.Settings.WidgetId)},DisplayError:function(){$("#"+a.Captcha.Settings.ErrorContainerId).show()},HideError:function(){$("#"+a.Captcha.Settings.ErrorContainerId).hide()}}}(p3.Us));var reCaptchaCallback=function(){p3.Us.Captcha.Render()};(function(a){a.Culture={isDate:function(l,b){if(a.Validate.isEmptier(l)){return(b===undefined)?true:b}var c=this.getCulture(),d=$.trim(c.App.dateFormat.toLowerCase()),e=(d.indexOf("/")!==-1)?"/":(d.indexOf("-")!==-1)?"-":(d.indexOf(".")!==-1)?".":"/",m=(l.indexOf("/")!==-1)?"/":(l.indexOf("-")!==-1)?"-":(d.indexOf(".")!==-1)?".":false,k=[],g=[],h=[31,28,31,30,31,30,31,31,30,31,30,31],f=0,j=0,n=0,i=false;if(m!==e){return false}k=l.split(e);g=d.split(e);f=parseInt(k[g.indexOf("dd")],10);j=parseInt(k[g.indexOf("mm")],10);n=parseInt(k[g.indexOf("yy")],10);if(n.toString().length<4){return false}if(n<1753){return false}if(n>9999){return false}if(j>12||j<1||f<1||n<1){return false}if(j===1||j>2){if(f>h[j-1]){return false}}if(j===2){if((!(n%4)&&n%100)||!(n%400)){i=true}if((i===false)&&(f>=29)){return false}if((i===true)&&(f>29)){return false}}return true},isTime:function(n){if(a.Validate.isEmptier(n)){return true}var c=this.getCulture(),d=$.trim(c.DateTimeFormat.ShortTimePattern),b=(d.indexOf(" ")!==-1)?d.split(" ")[1]:"",o=(d.indexOf(" ")!==-1)?d.split(" ")[0]:d,p=(n.indexOf(" ")!==-1)?n.split(" ")[0]:n,m=":",e=o.split(m),k=p.split(m),j=(e[0].length>1)?true:false,h=(d.indexOf("HH")!==-1||d.indexOf("H")!==-1)?true:false,f=parseInt(k[e.indexOf(h?j?"HH":"H":j?"hh":"h")],10),i=parseInt(k[e.indexOf("mm")],10),l=(e.indexOf("ss")!==-1)?parseInt(k[e.indexOf("ss")],10):0,g=(b.length>0)?(f>12)?"PM":"AM":"";if(f>24||isNaN(f)){return false}if(i>60||isNaN(i)){return false}if(l>60){return false}if(b.length>0&&g.length===0){return false}if(b===""){if(n.indexOf(" ")!==-1||n.toLowerCase().indexOf("am")!==-1||n.toLowerCase().indexOf("pm")!==-1){return false}}return true},is24HourFormat:function(){var b=this.getCulture(),c=false;if(b.DateTimeFormat.ShortTimePattern.indexOf("HH")!==-1||b.DateTimeFormat.ShortTimePattern.indexOf("H")!==-1){c=true}return c},isMidnight:function(c){if(this.isTime(c)){var b=this.getTime(c);if(b.getHours()===0&&b.getMinutes()===0&&b.getSeconds()===0){return true}}return false},isSameDay:function(d,e){var b=this.getDate(d),c=this.getDate(e),f=moment(b),g=moment(c);return f.isSame(g,"day")},getDateString:function(c){if(c===undefined||c===null){c=new Date()}if(_.isString(c)){c=this.getDate(c)}var b=this.getCulture(),d=$.trim(b.App.dateFormat.toLowerCase()),e=(d.indexOf("/")!==-1)?"/":(d.indexOf("-")!==-1)?"-":(d.indexOf(".")!==-1)?".":"/",g=[],i=new Array(3),h=c.getMonth()+1,f=c.getDate();g=d.split(e);i[g.indexOf("mm")]=(h<10?("0"+h):h);i[g.indexOf("dd")]=(f<10?("0"+f):f);i[g.indexOf("yy")]=c.getFullYear();return i.join(e)},getTimeString:function(l){if(l===undefined||l===null){l=new Date()}var b=this.getCulture(),c=$.trim(b.DateTimeFormat.ShortTimePattern),m=(c.indexOf(" ")!==-1)?c.split(" ")[0]:c,k=":",d=m.split(k),j=new Array(d.length),i=(d[0].length>1)?true:false,g=(c.indexOf("HH")!==-1||c.indexOf("H")!==-1)?true:false,e=l.getHours(),h=l.getMinutes(),f=" AM";if((c.indexOf("tt")!==-1)&&(e>=12)){f=" PM"}if(!g&&e>12){e=e-12}if(!g&&e===0){e="12"}if(i&&e<10){e="0"+e}if(g){f=""}j[d.indexOf(g?i?"HH":"H":i?"hh":"h")]=e;j[d.indexOf("mm")]=(h<10)?"0"+h:h;if(d.indexOf("ss")!==-1){j[d.indexOf("ss")]=l.getSeconds()}return j.join(k)+f},buildDateString:function(f,e,c){var b="",d=new Date(f,e,c);if(d){b=this.getDateString(d)}return b},buildTimeString:function(b,d,e){var f="",c=new Date(2025,1,1,b,d,e);if(c){f=this.getTimeString(c)}return f},getDateRangeString:function(c,b){var d="",e=" - ";if(c&&!b){d=this.displayDate(this.getDateString(c),"fullDate")}else{if(!c&&b){d=this.displayDate(this.getDateString(b),"fullDate")}else{if(c&&b){if(this.isSameDay(this.getDateString(c),this.getDateString(b))){d=this.displayDate(this.getDateString(c),"fullDate")}else{if(c.getFullYear()!==b.getFullYear()){d=this.displayDate(this.getDateString(c),"shortMonthDayYear")+e+this.displayDate(this.getDateString(b),"shortMonthDayYear")}else{if(c.getMonth()!==b.getMonth()){d=this.displayDate(this.getDateString(c),"shortMonthDate")+e+this.displayDate(this.getDateString(b),"shortMonthDayYear")}else{d=this.displayDate(this.getDateString(c),"dateRange");if(d.search("!")>-1){d=d.replace("!",e+this.displayDate(this.getDateString(b),"day"))}else{d=this.displayDate(this.getDateString(c),"shortMonthDate")+e+this.displayDate(this.getDateString(b),"shortMonthDayYear")}}}}}}}return d},getDate:function(v){if(v===undefined||v===null){return false}if(v.getTime){return v}var b=this.getCulture(),c=$.trim(b.App.dateFormat.toLowerCase()),w=v.split(" "),k=(c.indexOf("/")!==-1)?"/":(c.indexOf("-")!==-1)?"-":(c.indexOf(".")!==-1)?".":"/",d=(c.indexOf("/")!==-1)?"/":(c.indexOf("-")!==-1)?"-":(c.indexOf(".")!==-1)?".":"/",t=":",f="",u="",q=[],h=[],s=[0,0,0],g=0,p=0,x=0,l=0,o=0,r=0,m=0,n=0,e=["/",".","-"];for(m=0;m<w.length;m++){for(n=0;n<e.length;n++){if(w[m].indexOf(e[n])!==-1){f=w[m];d=e[n]}}if(w[m].indexOf(t)!==-1){u=w[m]}if(w[m].toLowerCase()==="am"||w[m].toLowerCase()==="pm"){u+=" "+w[m]}}q=f.split(d);h=c.split(k);if(u.length>0){s=this.getTime(u,true)}g=parseInt(q[h.indexOf("dd")],10);p=parseInt(q[h.indexOf("mm")],10);x=parseInt(q[h.indexOf("yy")],10);l=parseInt(s[0],10);o=parseInt(s[1],10);r=parseInt(s[2],10);return new Date(x,p-1,g,l,o,r)},getTime:function(o,g){if(o===undefined||o===null){return false}if(g===undefined||g===null){g=false}if(o.getTime){return new Date(2000,1,1,o.getHours(),o.getMinutes(),o.getSeconds())}var b=this.getCulture(),j=$.trim(b.App.ShortTimePattern),p=o.split(" "),m=":",l=[],k=[],n="",e="",c=0,f=0,h=0,d=0;for(d=0;d<p.length;d++){if(p[d].indexOf(m)!==-1){n=p[d]}if(p[d].toLowerCase()==="am"||p[d].toLowerCase()==="pm"){e=p[d]}}l=n.split(m);k=(j.indexOf(" ")!==-1)?j.split(" ")[0].split(m):j.split(m);c=(!isNaN(parseInt(l[0],10)))?parseInt(l[0],10):0;f=(!isNaN(parseInt(l[1],10)))?parseInt(l[1],10):0;h=(!isNaN(parseInt(l[2],10)))?parseInt(l[2],10):0;if(e.length>0){if(((e.toLowerCase()==="pm")&&(c<12))||(e.length===0&&c<12)){c+=12}if(e.toLowerCase()==="am"&&c===12){c=0}}if(k.indexOf("ss")!==-1){h=parseInt(l[k.indexOf("ss")],10)}if(g){return[c,f,h]}return new Date(2000,1,1,c,f,h)},dateCompare:function(e,f,g){var d=false,b=null,c=null;if(this.isDate(e)&&this.isDate(f)){b=this.getDate(e);c=this.getDate(f);switch(g){case"===":d=(b===c)?true:false;break;case">=":d=(b>=c)?true:false;break;case"<=":d=(b<=c)?true:false;break;case">":d=(b>c)?true:false;break;case"!==":d=(b!==c)?true:false;break;default:d=(b<c)?true:false;break}}return d},localDateTime:function(){var b=new Date();if(p3.Data.SchoolContext.attributes.SchoolInfo.LocalDateTime!==null){b=this.getDate(p3.Data.SchoolContext.attributes.SchoolInfo.LocalDateTime)}return b},serverDateTime:function(){var b=new Date();if(p3.Data.SchoolContext.attributes.SchoolInfo.ServerDateTime!==null){b=this.getDate(p3.Data.SchoolContext.attributes.SchoolInfo.ServerDateTime)}return b},getCulture:function(){return p3.Data.SchoolContext.get("Culture")},getAgeString:function(d){var e=this.localDateTime(),c,b,g,f,h="";if(a.Validate.isEmptier(d)){return null}d=this.getDate(d);b=(e.getMonth()+12*e.getFullYear())-(d.getMonth()+12*d.getFullYear());f=Math.abs(b%12);if(b<0){g=Math.abs(Math.ceil(b/12));if(f>0){h="-"}}else{g=Math.abs(Math.floor(b/12))}if(g===1){g+=" year, "}else{g+=" years, "}if(f===1){f+=" month"}else{f+=" months"}c=h+g+f;return c},_dateFormat:function(c,b){var d=(c instanceof Date)?c:this.getDate(c),e=moment(d);return e.format(b)},_getFormat:function(e){var b=this.getCulture(),d={"default":b.App.FullDateTimePattern,shortDate:b.App.ShortDatePattern,longDate:b.App.FullMonthDayPattern,fullDate:b.App.LongDatePattern,fullDateAbbr:b.App.LongDatePatternAbbr,shortTime:b.App.ShortTimePattern,longTime:b.App.LongTimePattern,monthDay:b.App.MonthDayPattern,shortMonthDay:b.App.ShortMonthDayPattern,monthYear:b.App.YearMonthPattern,sortableDate:"YYYY-MM-DD",sortableDateTime:b.App.SortableDateTimePattern,universalSortableDateTime:b.App.UniversalSortableDateTimePattern,fullMonth:b.App.FullMonthPattern,abbrMonth:b.App.ShortMonthPattern,day:b.App.ShortDayPattern,abbrDay:b.App.ShortDayNamePattern,dashboard:b.App.DashboardDatePattern,timeSpan:"HH:mm:ss",shortDayMonthDate:b.App.ShortDayMonthDatePattern,smallAMPMTime:b.App.SmallAMPMTimePattern,shortMonthDate:b.App.ShortMonthDatePattern,shortMonthDateTime:b.App.ShortMonthDateTimePattern,shortDateSmallTime:b.App.ShortDateSmallTimePattern,shortMonthDayYear:b.App.ShortMonthDayYearPattern,shortDayDate:b.App.ShortDayDatePattern,dateRange:b.App.ShortMonthDayYearPattern},c=(d[e]!==undefined)?d[e]:d["default"];if(e==="dateRange"){if(c.search("DD")>-1){c=c.replace("DD","DD!")}else{if(c.search("D")>-1){c=c.replace("D","D!")}}}return c},todayAt:function(c,e){var f=this.getDate(c),g=moment(f),j=moment(),b=this.getCulture(),d=(e===undefined)?false:e,i=this._dateFormat(c,b.App.ShortTimePattern),h="";if(g.isSame(j,"day")){h+="Today"}else{h+=this._dateFormat(c,b.App.FullMonthDayPattern)}if(i.length>0){if(!this.isMidnight(i)||d){h+=" at "+i}}return h},formatDateAt:function(b,c,h){var d=this.getDate(b),e=moment(d),i=moment(),g,f="";if(typeof c!=="string"){c="shortDate"}if(typeof h!=="string"){h="smallAMPMTime"}if(e.isSame(i,"day")){f+="Today"}else{f+=this._dateFormat(b,this._getFormat(c))}g=this._dateFormat(b,this._getFormat(h));if(g.length>0){f+=" at "+g}return f},displayDate:function(b,c){if(a.Validate.isEmptier(b)){return null}if(c===undefined){c="shortDate"}return this._dateFormat(b,this._getFormat(c))},displayDateFromInvariant:function(d,b){var c="",e=new Date(d);if(e.getTime()){c=this.displayDate(this.getDateString(e),b)}return c},displayTime:function(h,d,b){if(a.Validate.isEmptier(h)){return null}var c=(d===undefined)?false:d,g=this.getTime(h),f=this.getTimeString(g),e="";if(b===undefined){b="shortTime"}if(!this.isMidnight(f)||c){e=this._dateFormat(this.getDateString(g)+" "+f,this._getFormat(b))}return e},monthDay:function(c){var b=this.getCulture();return this._dateFormat(c,b.App.ShortMonthDayPattern)},getCurrencySymbol:function(){var b=this.getCulture();return b.NumberFormat.CurrencySymbol}};String.prototype.ApiFormat=function(){var b=a.Culture,d=b.getCulture(),c=null;if(b.isDate(this.toString())){if(d.Culture!=="en-US"){c=b.getDate(this.toString());return(c.getMonth()+1)+"/"+c.getDate()+"/"+c.getFullYear()}}return this.toString()};String.prototype.fixDateFormat=function(){var b=a.Culture,c=this.toString();if(c.indexOf("mm/dd/yyyy")!==-1){return c.replace("mm/dd/yyyy",b.getCulture().App.dateErrorFormat.toLowerCase())}return this.toString()};if(!Array.prototype.indexOf){Array.prototype.indexOf=function(g,b){if(this===null){throw new TypeError('"this" is null or not defined')}var c,f=Object.create(this),d=f.length>>>0,e=+b||0;if(d===0){return -1}if(Math.abs(e)===Infinity){e=0}if(e>=d){return -1}c=Math.max(e>=0?e:d-Math.abs(e),0);while(c<d){if(f.hasOwnProperty(c)&&f[c]===g){return c}c++}return -1}}if(typeof Object.create!=="function"){Object.create=(function(){function b(){return}return function(c){if(typeof c!=="object"){throw new TypeError("Object prototype may only be an Object or null")}b.prototype=c;var d=new b();b.prototype=null;return d}}())}}(p3.Us));(function(a){a.Enum={GetEnum:function(b){return $.extend(true,{},a.Enum[b])},AppModes:{WEBAPP:{Name:"WebApp",Value:1},PODIUM:{Name:"Podium",Value:2},EMBED:{Name:"Embed",Value:3}},AppCategories:{PLATFORM:{Name:"Platform",Value:5},CONTENTMANAGEMENT:{Name:"Content Management",Value:6},COMMUNITYGROUPS:{Name:"Community Groups",Value:7},COURSEMANAGEMENT:{Name:"Course Management",Value:8},GRADEBOOK:{Name:"Gradebook",Value:9},ALUMNI:{Name:"Alumni",Value:10},INQUIRY:{Name:"Inquiry",Value:11},MULTIMEDIALIBRARY:{Name:"Multimedia Library",Value:12},PUSHPAGE:{Name:"Pushpage",Value:13},EVENTREGISTRATION:{Name:"Event Registration",Value:14},GIVING:{Name:"Giving",Value:15},MENTORING:{Name:"Mentoring",Value:16},STORE:{Name:"Store",Value:17},AUCTION:{Name:"Auction",Value:18},CLASSIFIEDS:{Name:"Classifieds",Value:19},ATHLETICS:{Name:"Athletics",Value:20},ATHLETICGROUPS:{Name:"Althletic Groups",Value:21},COMMENT:{Name:"Comment",Value:22},SCHEDULE:{Name:"Schedule",Value:23},ATTENDANCE:{Name:"Attendance",Value:24},ADVISORYGROUP:{Name:"Advisory Groups",Value:25},DORMGROUPS:{Name:"Dorm Groups",Value:26},ACTIVITYGROUPS:{Name:"Activity Groups",Value:27},EMAIL:{Name:"Email",Value:28},ONLINESIGNUP:{Name:"Online Signup",Value:29},GRADING:{Name:"Grading",Value:30},STOREPLUS:{Name:"Store Plus",Value:31},SENIORSYSTEMOBSOLETE:{Name:"Senior Systems Obsolete",Value:32},AWARDS:{Name:"Awards",Value:33},ADMISSIONS:{Name:"Admissions",Value:34},SITESEARCH:{Name:"SiteSearch",Value:35},SCHEDULESTAR:{Name:"ScheduleStar",Value:37},INFOSNAPAPPLICATION:{Name:"Infosnap Application",Value:38},GOOGLEANALYTICS:{Name:"Google Analytics",Value:39},OMNITURE:{Name:"Omniture",Value:40},WEBSERVICEAPI:{Name:"WebServiceAPI",Value:41},LIBRARYRESOURCES:{Name:"Library Resources",Value:43},INFOSNAPDATASHUTTLE:{Name:"Infosnap Datashuttle",Value:44},LEAGUEMINDER:{Name:"LeagueMinder",Value:45},GOOGLE:{Name:"Google",Value:46},TWOUNIFY:{Name:"TwoUnify",Value:47},ALERTNOW:{Name:"AlertNow",Value:48},DIGICATION:{Name:"Digication",Value:49},MOODLE:{Name:"Moodle",Value:50},SCHOOLDUDE:{Name:"SchoolDude",Value:51},MOBILE:{Name:"Mobile",Value:52},PICKATIME:{Name:"Pickatime",Value:53},MULTIMEDIA:{Name:"Multimedia",Value:54},SENIORSYSTEMS:{Name:"SeniorSystems",Value:59},FACEBOOK:{Name:"Facebook",Value:61},INFOSNAPENROLLMENT:{Name:"Infosnap Enrollment",Value:66},PUSHPAGE2010:{Name:"Pushpage2010",Value:71},ASSIGNMENTDROPBOX:{Name:"Assignment DropBox",Value:76},WIKISPACES:{Name:"Wikispaces",Value:80},BRIGHTCOVE:{Name:"Brightcove",Value:83},LEARNINGPROFILES:{Name:"Learning Profiles",Value:94},ONLINEAPPLICATION:{Name:"Online Application",Value:95},REENROLLMENT:{Name:"ReEnrollment",Value:97},ASSESSMENTS:{Name:"Assessments",Value:98},SCHEDULEMAKER:{Name:"Schedule Maker",Value:99},GOOGLECALENDAR:{Name:"Google Calendar",Value:101},ANNOTATIONEAP:{Name:"AnnotationEAP",Value:105},GRADEDDISCUSSION:{Name:"Graded Discussion",Value:106},ATTENDANCELITE:{Name:"Attendance Lite",Value:108},MEDICAL:{Name:"Medical",Value:115},SAVEDLOGINEAP:{Name:"SavedLoginEAP",Value:116},ONACCOUNT:{Name:"onAccount",Value:117},BBSECUREPAYMENTS:{Name:"BB Secure Payments",Value:118},SKYUI:{Name:"SkyUI",Value:119},BBEMAILSERVICESEAP:{Name:"BB Email Services EAP",Value:122},CONDUCT:{Name:"Conduct",Value:124},CONNECTEE:{Name:"Connect EE",Value:111},SMARTTUITIONCONTRACTS:{Name:"Smart Tuition Contracts",Value:125},LTI:{Name:"LTI",Value:127},WISEDATA:{Name:"WISE",Value:133},ASSIGNMENTRUBRIC:{Name:"Assignment Rubric",Value:139},ADMISSIONSSCHEDULING:{Name:"Admissions Scheduling",Value:142}},SimpleAppEAP:{VIDEO:{Name:"Video",Value:1},SKYUI:{Name:"SKYUI",Value:2},ICALNET:{Name:"ICalNet",Value:3},INSIGHTS:{Name:"Insights",Value:4},REPORTCARDBUILDER:{Name:"ReportCardBuilder",Value:5},BBIDAUTH:{Name:"BBIDAuthentication",Value:6}},Content:{AFFINITY:{Name:"Affinity",Value:34,IconClass:"p3icon-affinity"},ANNOUNCEMENT:{Name:"Announcements",Value:10,IconClass:"p3icon-announcements"},ANNOUNCEMENTDETAIL:{Name:"Announcement Detail",Value:400,IconClass:"p3icon-announcements",PageFunctionType:5},ANNUALFUND:{Name:"Annual Fund",Value:12,IconClass:"p3icon-annualFund"},AUDIO:{Name:"Audio",Value:165,IconClass:"p3icon-topicAudio"},ATHLETICALERTS:{Name:"Athletic Alerts",Value:253,IconClass:"p3icon-announcements"},BREADCRUMB:{Name:"Breadcrumb",Value:392,IconClass:"p3icon-breadcrumb"},BUSINESSINDEX:{Name:"Business Index",Value:11,IconClass:"p3icon-businessIndex"},CALENDARDATEPICKER:{Name:"Date Picker",Value:418,IconClass:"p3icon-calendar",PageFunctionType:11},CALENDAREVENTFILTER:{Name:"Event Filter",Value:417,IconClass:"p3icon-filter",PageFunctionType:11},CALENDAREVENTLIST:{Name:"Event List",Value:416,IconClass:"p3icon-eventList",PageFunctionType:11},CALENDARGRID:{Name:"Calendar Grid",Value:426,IconClass:"p3icon-events",PageFunctionType:11},COURSEDETAIL:{Name:"Course Detail",Value:411,IconClass:"p3icon-lists",PageFunctionType:14},COVERBRIEF:{Name:"Cover Brief",Value:406,IconClass:"p3icon-topicText"},COVERIMAGE:{Name:"Cover Image",Value:404,IconClass:"p3icon-image"},COVERTITLE:{Name:"Cover Title",Value:405,IconClass:"p3icon-header"},DEPTFACULTY:{Name:"Department Faculty",Value:412,IconClass:"p3icon-affinity",PageFunctionType:14},DEPTPICKER:{Name:"Department Picker",Value:410,IconClass:"p3icon-coursePicker"},DOWNLOAD:{Name:"Downloads",Value:3,IconClass:"p3icon-topicDownload"},EMBED:{Name:"Embed",Value:129,IconClass:"p3icon-topicWidget"},EMERGENCYBULLETIN:{Name:"Emergency Bulletin",Value:398,StyleTemplateText:"Lightbox"},EMERGENCYBULLETINBANNER:{Name:"Emergency Bulletin Banner",Value:399,StyleTemplateText:"Banner"},EVENT:{Name:"Events",Value:5,IconClass:"p3icon-events"},EVENTDETAIL:{Name:"Event Detail",Value:401,IconClass:"p3icon-events",PageFunctionType:7},FAQ:{Name:"FAQ",Value:7,IconClass:"p3icon-faq"},FORM:{Name:"Custom Forms",Value:4,IconClass:"p3icon-forms"},FSDIRECTORY:{Name:"Directory",Value:91,IconClass:"p3icon-directory"},GIVING:{Name:"Giving",Value:22,IconClass:"p3icon-forms"},GROUPTEXT:{Name:"Text",Value:250,IconClass:"p3icon-topicText"},HEADER:{Name:"Header",Value:391,IconClass:"p3icon-pageTitle"},INQUIRY:{Name:"Inquiry",Value:23,IconClass:"p3icon-forms"},INTERNET:{Name:"Iframe",Value:39,IconClass:"p3icon-topicWidget"},LINE:{Name:"Horizontal Line",Value:408,IconClass:"p3icon-line"},LINK:{Name:"Links",Value:2,IconClass:"p3icon-topicLink"},LIST:{Name:"Lists",Value:24,IconClass:"p3icon-lists"},LISTDETAIL:{Name:"List Detail",Value:402,IconClass:"p3icon-lists",PageFunctionType:8},LOGO:{Name:"Logo",Value:395,IconClass:"p3icon-logo"},MEDIA:{Name:"Media",Value:409,IconClass:"p3icon-topicPhoto"},MEGAMENU:{Name:"Mega Menu",Value:429,IconClass:"p3icon-navigation"},MENU:{Name:"Menu",Value:389,IconClass:"p3icon-navigation"},MINISITEMAP:{Name:"Mini Sitemap",Value:394,IconClass:"p3icon-miniSitemap"},MOBILEMENU:{Name:"Mobile Menu",Value:414,IconClass:"p3icon-navigation"},NEWSARCHIVELIST:{Name:"News Archive List",Value:419,IconClass:"p3icon-news"},NEWSARCHIVEFILTER:{Name:"News Archive Filter",Value:420,IconClass:"p3icon-filter"},NEWSARCHIVEDATEPICKER:{Name:"News Archive Date Picker",Value:421,IconClass:"p3icon-calendar"},NEWS:{Name:"News",Value:6,IconClass:"p3icon-news",SupportsBackgroundCarousel:true},NEWSCOMMENTLIST:{Name:"News Comment List",Value:424,IconClass:"p3icon-eventList",PageFunctionType:9},NEWSCOMMENTENTRY:{Name:"News Comment Entry",Value:425,IconClass:"p3icon-comment",PageFunctionType:9},NEWSDETAILTEXT:{Name:"News Detail Text",Value:403,IconClass:"p3icon-news",PageFunctionType:9},NEWSDETAILPHOTO:{Name:"News Detail Photos",Value:423,IconClass:"p3icon-topicPhoto",PageFunctionType:9},ONBOARDINQUIRY:{Name:"onBoard Inquiry",Value:430,IconClass:"p3icon-forms"},PAGECONTENTAREA:{Name:"Page Content",Value:390,IconClass:"p3icon-pageContent"},PAGETITLE:{Name:"Page Title",Value:66,IconClass:"p3icon-pageTitle"},PHOTO:{Name:"Photos",Value:31,IconClass:"p3icon-topicPhoto",SupportsBackgroundCarousel:true},POLL:{Name:"Polls",Value:8,IconClass:"p3icon-polls"},RSSFEED:{Name:"RSS Feed",Value:114,IconClass:"p3icon-rss"},RSSREADER:{Name:"RSS Reader",Value:41,IconClass:"p3icon-rss"},SEARCH:{Name:"Search",Value:370,IconClass:"p3icon-search"},SEARCHRESULTS:{Name:"Search Results",Value:413,IconClass:"p3icon-search"},SITEMAP:{Name:"Sitemap",Value:393,IconClass:"p3icon-sitemap"},SPACER:{Name:"Spacer",Value:407,IconClass:"p3icon-spacer"},STORECATALOG:{Name:"Store Catalog",Value:73,IconClass:"p3icon-store"},TEAMCOACH:{Name:"Team Coach",Value:261,IconClass:"p3icon-general"},TEAMINFO:{Name:"Team Description",Value:264,IconClass:"p3icon-topicText"},TEAMPICKER:{Name:"Team Picker",Value:256,IconClass:"p3icon-teamPicker"},TEAMLIST:{Name:"Team List",Value:427,IconClass:"p3icon-lists"},TEAMNEWS:{Name:"Team News",Value:263,IconClass:"p3icon-news"},TEAMROSTER:{Name:"Team Roster",Value:267,IconClass:"p3icon-teamRoster"},TEAMSCHEDULE:{Name:"Team Schedule",Value:268,IconClass:"p3icon-teamSchedule"},RECENTGAMES:{Name:"Recent Games",Value:274,IconClass:"p3icon-newspaper p3midGray"},TEAMSTATISTICS:{Name:"Team Statistics",Value:269,IconClass:"p3icon-stats"},TEXT:{Name:"Text",Value:1,IconClass:"p3icon-topicText"},TRIVIA:{Name:"Trivia",Value:9,IconClass:"p3icon-trivia"},UPCOMINGGAMES:{Name:"Upcoming Games",Value:257,IconClass:"p3icon-teamSchedule"},VIDEO:{Name:"Videos",Value:167,IconClass:"p3icon-topicVideo"},WIDGET:{Name:"Embed",Value:387,IconClass:"p3icon-topicWidget"},DISCUSSION:{Name:"Discussion",Value:415,IconClass:"p3icon-comment"},FORMSLIST:{Name:"Forms List",Value:94,IconClass:"p3icon-forms"},PUSHPAGEARCHIVE:{Name:"Pushpage Archive",Value:77,IconClass:"p3icon-email"},GRADINGRUBRIC:{Name:"Grading Rubric",Value:79,IconClass:"p3icon-coursePicker"},SYLLABUS:{Name:"Syllabus",Value:78,IconClass:"p3icon-coursePicker"},EXPECTATIONS:{Name:"Expectations",Value:80,IconClass:"p3icon-coursePicker"},TEAMSCORES:{Name:"Scoreboard",Value:45,IconClass:"p3icon-teamSchedule"},TEAMSTATS:{Name:"Statistics",Value:71,IconClass:"p3icon-stats"},LTI:{Name:"Learning Tool",Value:435,IconClass:"p3icon-pageTools"}},MenuItemTypes:{Page:{Name:"Page",Value:1},Url:{Name:"Url",Value:2},FirstChild:{Name:"First Child",Value:3},ExistingPage:{Name:"Existing Page",Value:4}},LinkItemTypes:{Url:{Name:"Url",Value:1},AuthResource:{Name:"Authenticated Resource",Value:2},ExistingPage:{Name:"Existing Page",Value:3}},ContentObjectTypes:{CONTENTTYPES:{Name:"Content Types",Value:16,LayoutBuilderSort:11},WIDGETS:{Name:"Widgets",Value:32,LayoutBuilderSort:15},DEFAULT:{Name:"Default",Value:64,LayoutBuilderSort:0},ANNOUNCEMENTDETAILPAGE:{Name:"Announcement Detail",Value:129,LayoutBuilderSort:5},EVENTDETAILPAGE:{Name:"Event Detail",Value:130,LayoutBuilderSort:6},LISTDETAILPAGE:{Name:"List Detail",Value:131,LayoutBuilderSort:7},NEWSDETAILPAGE:{Name:"News Detail",Value:132,LayoutBuilderSort:8},TEAMDETAILPAGE:{Name:"Team Detail",Value:133,LayoutBuilderSort:9},CURRICULUMDETAILPAGE:{Name:"Curriculum Detail",Value:134,LayoutBuilderSort:10},ATHLETICS:{Name:"Athletics",Value:256,LayoutBuilderSort:20},NAVIGATION:{Name:"Navigation",Value:1024,LayoutBuilderSort:15},FORMS:{Name:"Forms",Value:2048,LayoutBuilderSort:16},CALENDAR:{Name:"Calendar",Value:4096,LayoutBuilderSort:12},NEWSARCHIVE:{Name:"News Archive",Value:8192,LayoutBuilderSort:13},SEARCHRESULTS:{Name:"Search Results",Value:8193,LayoutBuilderSort:14}},CMSObjectType:{LAYOUT:1,PAGE:2,PANEL:3,LINK:4,STYLE:5,CUSTOMCSS:6},CMSActionType:{ADD:1,DELETE:2,STRUCTURECHANGE:3,BLOCKADD:4,BLOCKDELETE:5,BLOCKOPTIONS:6,STYLEAPPLIED:7,CHANGESETTINGS:8,CHANGESAPPLIED:9,CHANGESCANCELLED:10,EDIT:11,MOVED:12,PENDING:13,PUBLISHED:14,UNPUBLISHED:15,BLOCKMOVED:16,CONTENTCHANGED:17,ROWADDED:18,ROWDELETED:19,REGIONADDED:20,REGIONDELETED:21,ROWSETTINGS:22,REGIONSETTINGS:23},Element:{HEADER:{Name:"Header",Value:1,IconClass:"p3icon-header",BasicElement:true},TEXT:{Name:"Text",Value:2,IconClass:"p3icon-topicText",BasicElement:true},IMAGE:{Name:"Image",Value:3,IconClass:"p3icon-image",BasicElement:true},SPACER:{Name:"Spacer",Value:4,IconClass:"p3icon-spacer",BasicElement:true},HORIZONTALLINE:{Name:"Horizontal Line",Value:5,IconClass:"p3icon-line",BasicElement:true},LOGO:{Name:"Logo",Value:6,IconClass:"p3icon-logo",BasicElement:true},HTML:{Name:"HTML",Value:7,IconClass:"",BasicElement:false},PAYMENTPLANLIST:{Name:"Payment Plan List",Value:8,IconClass:"",BasicElement:false},FEESCHEDULE:{Name:"Fee Schedule",Value:9,IconClass:"",BasicElement:false},STATICTEXT:{Name:"Static Text",Value:10,IconClass:"",BasicElement:false},SPECIALCONSIDERATION:{Name:"Special Consideration",Value:11,IconClass:"",BasicElement:false},FORMFIELD:{Name:"Form Fields",Value:12,IconClass:"p3icon-forms",BasicElement:true},BUTTON:{Name:"Button",Value:13,IconClass:"",BasicElement:false},SMARTTUITIONDEPOSIT:{Name:"Smart Tution Deposit",Value:14,IconClass:"",BasicElement:false},SIGNERACKNOWLEDGEMENT:{Name:"Signer Acknowledgement",Value:15,IconClass:"",BasicElement:true}},ParentRoles:{ALLSCHOOL:1,PLATFORMMANAGER:2,APPLICATIONDEVELOPER:3,PRODUCTIONDEVELOPER:4,SUPPORTPROFESSIONAL:5,SALESPROFESSIONAL:6,DESIGNER:7,PROJECTLEAD:8,PAGEMANAGER:9,CONTENTEDITOR:12,STUDENT:14,TEACHER:15,PARENT:16,ALUMNI:17,COACH:18,COMMUNITYGROUPMANAGER:19,PUBLIC:20,AUCTIONMANAGER:25,CLASSIFIEDMANAGER:26,INQUIRYMANAGER:27,GIVINGMANAGER:28,MENTORMANAGER:29,REGISTRATIONMANAGER:30,PUSHPAGEMANAGER:31,STOREMANAGER:32,ALUMNIGROUPMANAGER:34,CLASSAGENT:39,PASSWORDMANAGER:40,MENTOR:41,MENTEE:42,MMLMANAGER:104,ATHLETICGROUPMANAGER:271,NONTEACHINGSTAFF:332,ACADEMICGROUPMANAGER:523,CANDIDATE:554,PASTCANDIDATE:555,TRUSTEE:556,PASTTRUSTEE:557,FRIEND:558,PASTTEACHER:559,PASTNONTEACHINGSTAFF:560,PASTCOACH:561,PASTSTUDENT:562,PARENTOFCANDIDATE:563,PARENTOFPASTCANDIDATE:564,PARENTOFPASTSTUDENT:565,PARENTOFALUMNI:566,SYSTEMGROUPMANAGER:1455,CONTENTMANAGER:1492,OFFICIAL:1579,PASTOFFICIAL:1580,COMMENTSMANAGER:2151,COMMUNITYGROUPOWNER:2382,SCHEDULEMANAGER:2385,ATTENDANCEMANAGER:2872,MONITORINGTEAM:3030,DORMGROUPMANAGER:3176,ACTIVITYGROUPMANAGER:3177,ADVISORYGROUPMANAGER:3178,ONLINESIGNUPMANAGER:3254,ADVISOR:4337,PASTADVISOR:4338,DORMSUPERVISOR:4343,PASTDORMSUPERVISOR:4344,ACTIVITYLEADER:4623,PASTACTIVITYLEADER:4624,WEBMAILMANAGER:4857,GRADEBOOKMANAGER:4861,GRADINGMANAGER:5278,REVIEWER:6951,SENIORSYSTEMSMANAGER:7777,AWARDMANAGER:7953,DATAMANAGER:9926,ADMISSIONSMANAGER:8457,INCOMINGSTUDENT:22,EDUCATIONALCONSULTANT:10102,PARENTOFINCOMINGSTUDENT:23,ADMISSIONSSTAFF:9061,INFOSNAPAPPLICATIONMANAGER:10104,WEBSERVICEAPIMANAGER:10108,DATASHUTTLEMANAGER:10110,MAILMERGEMANAGER:10130,MOODLEMANAGER:10120,PICKATIMEMANAGER:10123,GLEEWORKSMANAGER:10125,FACEBOOKFANPAGEMANAGER:10141,PUSHPAGE2010EDITOR:10140,FIRESIGNMANAGER:10144,VENUEVISIONMANAGER:10145,INFOSNAPENROLLMENTMANAGER:10146,PUSHPAGE2010MANAGER:10147,WORDPRESSMANAGER:10150,MAGNUSHEALTHMANAGER:10153,SCHOOLVOLUNTEERMANAGER:10155,EVERTRUEMANAGER:10154,CAREFLOWMANAGER:10162,GOOGLECALENDARMAMANGER:10167},Associations:{PAGECONTENT:{Name:"Page Content",Value:0,Ref:"page",EditorRoles:[{PersonaId:4,RoleId:9},{PersonaId:9,RoleId:12},{PersonaId:9,RoleId:1492}]},ACADEMICS:{Name:"Academics",Value:1,Ref:"course",EditorRoles:[{PersonaId:5,RoleId:523}]},ATHLETICS:{Name:"Athletics",Value:2,Ref:"team"},COMMUNITY:{Name:"Community",Value:3,Ref:"community"},ALUMNI:{Name:"Alumni",Value:4,Ref:"alumni"},ROLES:{Name:"Roles",Value:5,Ref:"role"},DORM:{Name:"Dorm",Value:7,Ref:"dorm"},ACTIVITY:{Name:"Activity",Value:8,Ref:"activity"},ADVISORY:{Name:"Advisory",Value:9,Ref:"advisory"},MENTOR:{Name:"Mentor",Value:10,Ref:"mentor"},PUSHPAGE:{Name:"Pushpage",Value:11,Ref:"pushpage"}},HtmlEditorCategories:{FULL:"full",LIMITED:"limited",LIMITED2LINE:"limited2line",FULL3LINE:"full3line",MERGE:"merge",GRADING:"grading",PUSHPAGE:"pushpage",CONTRACTS:"contracts",FULLFONT:"fullfont"},HtmlEditorEncoding:{NAMED:"named",NUMERIC:"numeric",RAW:"raw"},BroadcastType:{EMAIL:{Name:"Email",Value:1},SMS:{Name:"Sms",Value:2},VOICE:{Name:"Voice",Value:3}},FormType:{APPLICATION:{Name:"Application",Type:"Application",Value:1,ManagementTask:53078,Model:"ApplicationForm",FeeName:"Fee"},CONTRACT:{Name:"Contract",Type:"Contract",Value:2,ManagementTask:53194,Model:"ContractForm",FeeName:"Deposit",IsContractForm:true},INQUIRY:{Name:"Inquiry",Type:"Inquiry",Value:4,ManagementTask:53256,Model:"InquiryForm"},ACKNOWLEDGEMENT_PERMISSION:{Name:"Acknowledgement Permission",Type:"School",Value:8,ManagementTask:53382,Model:"SchoolForm",IsSchoolForm:true},EMERGENCY_CONTACTS:{Name:"Emergency Contacts",Type:"School",Value:16,ManagementTask:53382,Model:"SchoolForm",IsSchoolForm:true},PROFILE_UPDATES:{Name:"Profile Updates",Type:"School",Value:32,ManagementTask:53382,Model:"SchoolForm",IsSchoolForm:true},BLANK_FORM:{Name:"Blank Form",Type:"School",Value:64,ManagementTask:53382,Model:"SchoolForm",IsSchoolForm:true},MEDICAL_FORM:{Name:"Medical",Type:"School",Value:128,ManagementTask:53382,Model:"SchoolForm",IsSchoolForm:true},SMART_TUITION_CONTRACT:{Name:"Contract with Smart Tuition",Type:"Contract",Value:256,ManagementTask:53194,Model:"ContractForm",FeeName:"Deposit",IsContractForm:true},IsContractForm:function(c){var b=_.findWhere(p3.Us.Enum.FormType,{Value:c})||{IsContractForm:false};return !!b.IsContractForm}},FormStatus:{STARTED:{Name:"Started",Value:1},SUBMITTED:{Name:"Submitted",Value:2},PROCESSED:{Name:"Processed",Value:3}},UploadType:{All:{ValidExtensions:/.*/i},IMAGE:{ValidExtensions:/(\.|\/)(gif|jpe?g|png|bmp)$/i},AUDIO:{ValidExtensions:/(\.|\/)(mp3|mpa|wav|wma|aac|aif|aiff|m4a)$/i},VIDEO:{ValidExtensions:/(\.|\/)(avi|flv|mpg|qt|rm|wmv|mp4|m4v|f4v|mpeg|mov)$/i},GIFPNG:{ValidExtensions:/(\.|\/)(gif|png)$/i},FAVICON:{ValidExtensions:/(\.|\/)(ico)$/i},JPGPNG:{ValidExtensions:/(\.|\/)(jpe?g|png)$/i},DOC:{ValidExtensions:/(\.|\/)(doc|docx|odt|pages|rtf|txt|wpd|wps|pdf)$/i},DOCIMAGE:{ValidExtensions:/(\.|\/)(doc|docx|odt|pages|rtf|txt|wpd|wps|pdf|gif|jpe?g|png|bmp)$/i},CSV:{ValidExtensions:/(\.|\/)(csv)$/i},HOMESCREEN:{ValidExtensions:/(\.|\/)(png)$/i}},WorklistFieldType:{DROPDOWN:1,MULTISELECT:2,DATERANGE:3,BITFIELD:4,TEXTBOX:5,NUMERICRANGE:6,NOTEXISTSBITFIELD:7},WorklistFilterType:{DATEDROPDOWN:0,CURRENCYDROPDOWN:1,MULTISELECT:2,TEXT:3,ADDRESS:4,VALUEDROPDOWN:5,CHECKLIST:6,AMOUNTDROPDOWN:7,IDSET:8,GROUPLEVELSELECT:9,MULTISELECTYEARLEVEL:10},AppPersona:{PARENT:{Value:1,Name:"Parent",Type:1},STUDENT:{Value:2,Name:"Student",Type:1},FACULTY:{Value:3,Name:"Faculty",Type:1},ONMESSAGE:{Value:4,Name:"onMessage",Type:2},ONCAMPUS:{Value:5,Name:"onCampus",Type:2},ONRECORD:{Value:6,Name:"onRecord",Type:2},ONBOARD:{Value:7,Name:"onBoard",Type:2},COMMERCE:{Value:8,Name:"Commerce",Type:2},SYSTEM:{Value:9,Name:"System",Type:2},WHUSER:{Value:10,Name:"WH User",Type:2},FRIEND:{Value:11,Name:"Friend",Type:1},ALUM:{Value:12,Name:"Alum",Type:1},ONACCOUNT:{Value:13,Name:"Alum",Type:2}},DictionaryData:{AddressTypes:{name:"Address Types",id:1},Country:{name:"Country",id:20,keyName:"country_code",valueName:"country_name"},GraduationYear:{name:"Graduation Year",id:34},GradeLevel:{name:"Grade Level",id:35,dataName:"level_description"},InquirySource:{name:"Inquiry Source",id:38,keyName:"pk",valueName:"short_description"},PhoneTypes:{name:"Phone Types",id:55},StatesAndProvinces:{name:"States And Provinces",id:56,keyName:"state_province_code",valueName:"state_province_name",dataName:"country_name"},RelationshipTypes:{name:"Relationship Types",id:65},ConstituentEmployeeRoles:{name:"Constituent and Employee Roles",id:69},StudentRoles:{name:"Student Roles",id:75},SchoolYear:{name:"School Year",id:82},SchoolYearCurrent:{name:"School Year Current",id:83},States:{name:"States",id:88},TransferSchool:{name:"Transfer School",id:94},EthnicityTypes:{name:"Ethnicity Types",id:99},ReligionTypes:{name:"Religion Types",id:100},ADMInterviewTypes:{name:"ADM Interview Types",id:101,keyName:"pk",valueName:"short_description"},ADMStaff:{name:"ADM Staff",id:102,keyName:"user_id",valueName:"user_name",inputParam:"@admissions_staff_id=null,@onBoard_ind=1[i]"},ADMVisitTypes:{name:"ADM Visit Types",id:103,keyName:"pk",valueName:"short_description"},ADMReferenceTypes:{name:"ADM Reference Types",id:104,keyName:"pk",valueName:"short_description"},ADMTestTypes:{name:"ADM Test Types",id:105,keyName:"pk",valueName:"short_description"},ApplicationCurrentGrade:{name:"Application Current Grade",id:106,keyName:"pk",valueName:"short_description"},ADMPrograms:{name:"ADM Programs",id:107,keyName:"pk",valueName:"short_description"},ADMInactiveStatusTypes:{name:"ADM Inactive Status Types",id:108,keyName:"pk",valueName:"short_description"},ADMContracts:{name:"ADM Contracts",id:109,keyName:"pk",valueName:"short_description",inputParam:"@active_ind=1[i]"},ADMDecisions:{name:"ADM Decisions",id:110,keyName:"pk",valueName:"short_description",dataName:"type_id"},ADMFinancialAid:{name:"ADM Financial Aid",id:111,keyName:"pk",valueName:"short_description"},ADMChecklists:{name:"ADM Checklists",id:112,inputParam:"@active_only=1[i]",keyName:"pk",valueName:"short_description"},ADMDecisionTypeNoAll:{name:"ADM Decision Type No All",id:113},ADMSpecialRelationships:{name:"ADM Special Relationships",id:114,inputParam:"onBoard_ind=1[i]"},ADMReasonsDeclinedAll:{name:"ADM Reasons Declined All",id:115,keyName:"pk",valueName:"short_description"},ProvinceByCountry:{name:"Province By Country",id:116},ADMConnectionsRelTypes:{name:"ADM Connections Rel Types",id:117},ADMConnectionsTypes:{name:"ADM Connections Types",id:118},ContractCategory:{name:"Contract Category",id:119},ADMFeeRuleTypes:{name:"ADM Fee Rule Types",id:120,inputParam:"@oa_form_type_id=1[i]"},ADMTuitionInsuranceTypes:{name:"ADM Tuition Insurance Types",id:121},ADMFeeRuleRole:{name:"ADM Fee Rule Role",id:122},StatesPlusArmyPO:{name:"States Plus Army PO",id:123},ADMChecklistStatus:{name:"ADM Checklist Status",id:124,keyName:"pk",valueName:"short_description"},ADMReminderTypes:{name:"ADM Reminder Types",id:125,keyName:"pk",valueName:"short_description"},ADMDataCollectionTypes:{name:"ADM Data Collection Types",id:126,keyName:"pk",valueName:"short_description"},ADMCandidateDataCollectionStatuses:{name:"ADM Candidate Data Collection Statuses",id:128,keyName:"item_status_id",valueName:"item_status_desc",dataName:"data_collection_type_id"},ReferralTypes:{name:"Referral Types",id:129},ADMEventTypes:{name:"ADM Event Types",id:130},DepositPercentageType:{name:"Deposit Percentage Type",id:131},OnlineFormFieldType:{name:"Online Form Custom Field Type",id:132,keyName:"dd_id",valueName:"dd_description",dataName:"HTMLtype"},Language:{name:"Language",id:133},Citizenship:{name:"Citizenship",id:134},VisaType:{name:"Visa Type",id:135},VisaStatus:{name:"Visa Status",id:136},FormViewRoles:{name:"Form View Roles",id:137},NotificationReminders:{name:"Notification Reminders",id:138},ADMSchoolTypes:{name:"School Types",id:139,keyName:"dd_id",valueName:"dd_description"},ADMPaymentStatus:{name:"Payment Status",id:140},ADMEvents:{name:"ADM Events",id:141},SchoolLevel:{name:"School Level",id:79},ADMDecisionPlaceholder:{name:"ADM Decision Placeholder",id:142},ADMDecisionType:{name:"ADM Decision Type",id:143,keyName:"pk",valueName:"short_description"},ADMCommTempActiveUserTemp:{name:"ADM Comm Template Active User Template",id:144,keyName:"template_id",valueName:"description",inputParam:"@user_id=0[i],@app_category_id=34[i],@template_style=0[i],@status=0[i]"},ADMCandDecisionType:{name:"ADM Candidate Decision Type",id:145,keyName:"pk",valueName:"short_description"},ADMFinancialAidDecisionType:{name:"ADM Financial Aid Decision Type",id:146},Race:{name:"Race",id:147},ADMParticipantType:{name:"ADM Participant Type",id:148}},PeopleFinder:{FinderType:{ONBOARD:1,ONRECORD:2,ONBOARD_FORM_NOTIFICATION:3,SYSTEM:4,ONACCOUNT:5},SearchType:{ALLNAMES:255,FIRSTNAME_NICKNAME:1,LASTNAME_MAIDENNAME:2},FilterType:{ONBOARD:["SearchFirstName","SearchNickName","SearchLastName","SearchMaidenName"]}},InquiryImport:{IMPORTREADY:1,IMPORTCOMPLETE:2,MIGRATIONCOMPLETE:3,NOTREQUIRED:4},DataCollectionType:{NONE:1,TEST:2,FINANCIALAID:3,REFERENCE:4,COMMUNICATION:5,DECISION:6,INTERVIEW:7,APPLICATIONFORM:8,CONTRACT:9,ENROLLMENT:10,SCHOOL:11,VISIT:12,INQUIRY:13,FAMILYPHOTO:14},CreditCardTypes:{VISA:{Value:"Visa",Name:"Visa"},DISCOVER:{Value:"Discover",Name:"Discover"},MASTERCARD:{Value:"Mastercard",Name:"Mastercard"},AMERICANEXPRESS:{Value:"American Express",Name:"American Express"}},OnlineFormPaymentType:{VISA:{Value:1,Name:"Visa"},MASTERCARD:{Value:2,Name:"MasterCard"},DISCOVER:{Value:3,Name:"Discover"},AMERICANEXPRESS:{Value:4,Name:"American Express"},EFT:{Value:5,Name:"Electronic Funds Transfer"},INSCHOOL:{Value:6,Name:"In School Payment"}},ProspectOrigin:{INQUIRY:1,CREATEACCOUNT:2,ADMIN:3,INQUIRYIMPORT:4,ADMININQUIRY:5},GoogleDriveExportTypes:{FILE:{Value:"FILE",Name:"File",Ext:""},SHARE:{Value:"SHARE",Name:"Google Drive Link",Ext:""},PDF:{Value:"PDF",Name:"PDF",Ext:"pdf"},CSV:{Value:"CSV",Name:"CSV",Ext:"csv"},HTML:{Value:"HTML",Name:"HTML",Ext:"html"},TEXT:{Value:"TEXT",Name:"Text (TXT)",Ext:"txt"},RTF:{Value:"RTF",Name:"RTF",Ext:"rtf"},ODT:{Value:"ODT",Name:"Open Office (ODT)",Ext:"odt"},WORD:{Value:"WORD",Name:"Word (DOCX)",Ext:"docx"},EXCEL:{Value:"EXCEL",Name:"Excel (XLS)",Ext:"xls"},ODS:{Value:"ODS",Name:"Open Office (ODS)",Ext:"ods"},JPG:{Value:"JPG",Name:"JPG",Ext:"jpg"},PNG:{Value:"PNG",Name:"PNG",Ext:"png"},PPT:{Value:"PPT",Name:"PowerPoint (PPTX)",Ext:"pptx"}},FileSelectionStatus:{SUCCESS:{Value:1,Text:"Success"},PENDING:{Value:0,Text:"Pending"},TRANSFER_ERROR:{Value:-1,Text:"File transfer error"},OVER_LIMIT_ERROR:{Value:-2,Text:"File limit exceeded"},UNSUPPORTED_ERROR:{Value:-3,Text:"Unsupported file type"},GOOGLE_INQUIRY_ERROR:{Value:-5,Text:"Google inquiry error"},GOOGLE_ACCESS_ERROR:{Value:-6,Text:"Google access error"},FILE_UPLOAD_ERROR:{Value:-7,Text:"File upload Failed"}},CustomDataTypes:{CHECKBOX:{Value:1,ForceUnique:1},CHECKBOXLIST:{Value:2,ForceUnique:1},CURRENCY:{Value:3,ForceUnique:1},DATETIME:{Value:4,ForceUnique:1},DROPDOWN:{Value:5,ForceUnique:0},NUMBER:{Value:6,ForceUnique:1},TEXT:{Value:7,ForceUnique:0},TEXTPARAGRAPH:{Value:8,ForceUnique:0},YESNO:{Value:9,ForceUnique:1}},LtiCredentialsType:{PERLINK:0,BYDOMAIN:1,FIXED:2},LtiProviderScope:{ALL:0,BULLETINBOARD:1,TOPIC:2,ASSIGNMENT:3,ASSESSMENT:4,DISCUSSION:5},LtiPresentationTargets:{Redirect:{name:"Redirect Browser",id:1},New:{name:"New Browser",id:2},Popup:{name:"Popup Window",id:3},Embed:{name:"Display in Place",id:4}},LtiChangeFlag:{NONE:0,PROVIDERLEVEL:1,TOOLLEVEL:2},OfferingType:{ACADEMICS:{Name:"Academic Course",Value:1},ACTIVITY:{Name:"Activity",Value:2},ADVISORY:{Name:"Advisory",Value:3},DORMS:{Name:"Dormitory Residence",Value:4},TRANSCRIPT:{Name:"Transcript",Value:5},OFFEREDCOURSE:{Name:"Offered Course",Value:6},AWARDS:{Name:"School Wide Awards",Value:8},ATHLETICS:{Name:"Athletic",Value:9},ADMISSIONS:{Name:"Admissions",Value:10},AFFINITY:{Name:"Affinity",Value:11},MENTOR:{Name:"Mentor",Value:12},EVENTS:{Name:"Events",Value:13}},AdmProfileSettingTypes:{CONNECTION:{Name:"Connection Types",Value:1},EVENT:{Name:"Event Types",Value:2},INACTIVATION:{Name:"Candidate Inactivation Reasons",Value:3},INTERVIEW:{Name:"Interview Types",Value:4},RECOMMENDATION:{Name:"Recommendation Types",Value:5},SCHOOLPROGRAM:{Name:"School Program Types",Value:6},SCHOOL:{Name:"School Types",Value:7},SPECIALRELATIONSHIP:{Name:"Special Relationship Types",Value:8},VISIT:{Name:"Visit Types",Value:9},FINANCIALAID:{Name:"Financial Aid",Value:10},REASONDECLINED:{Name:"Reason for Declining",Value:11},FINANCIALAIDDECISIONS:{Name:"Financial Aid Decisions",Value:12,Dictionaries:["ADMFinancialAidDecisionType"]},VISITPARTICIPANT:{Name:"Visit Participant Types",Value:13},INTERVIEWPARTICIPANT:{Name:"Interview Participant Types",Value:14}},SsatbSettingTypes:{GRADE:{Name:"Current Grade Mapping",Value:1},RELATIONSHIP:{Name:"Relationship Mapping",Value:2},ETHNICITY:{Name:"Ethnicity Mapping",Value:3}},CdnUrlTypes:{PHOTON:{Name:"Photon",Value:4},COMMON:{Name:"Common",Value:5},PHOTONEASTONE:{Name:"Photon East 1",Value:6},LIBRARIES:{Name:"Libraries",Value:13}},FilterableViewListType:{MedicalWorklist:1,ListInfraction:2,ListConsequence:3,ListUser:4,ListStudent:5,MedicalVisitWorklist:6,ListCandidate:7,ListContract:8,ListReportCardGrade:9,ListFaculty:10,ListCourse:11,ListCourseRequest:12,ListSectionAttendance:13,ListDayAttendance:14,ListStudentMedicalAllergyCondition:15,ListStudentMedication:16,ListVisitInterviewOpening:17,ListVisitInterview:18,ListGradebookGrades:19},InteractionEventType:{Logins:{Name:"Logins",Id:1},Messages:{Name:"Messages",Id:2},VisitResourceBoardPage:{Name:"Visit Resource Board Page",Id:3},ViewResourceBoardItem:{Name:"View Resource Board Item",Id:101},VisitTopicsPage:{Name:"Visit Topics Page",Id:102},ViewaTopic:{Name:"View a Topic",Id:103},VisitFeaturedContentPage:{Name:"Visit Featured Content Page",Id:104},ViewFeaturedNews:{Name:"View Featured News",Id:105},ViewFeaturedMedia:{Name:"View Featured Media",Id:106},ViewFeaturedEvents:{Name:"View Featured Events",Id:107}},PLATFORM:{Name:"Platform",Value:5},CONTENTMANAGEMENT:{Name:"Content Management",Value:6},TuitionInsuranceCode:{Optional:0,Required:1,None:2,OptionalOptOut:3},ContractFeeType:{TUITION:{Value:1,Name:"Tuition"},REQUIRED_FEE:{Value:2,Name:"Required Fees"},OPTIONAL_FEE:{Value:3,Name:"Optional Fees"},ENROLLMENT_FEE:{Value:4,Name:"Enrollment Fees"},FINANCIAL_AID:{Value:5,Name:"Financial Aid"}},BillingAddressType:{USERADDRESS:{Value:1,Name:"User Address"},BILLINGADDRESS:{Value:2,Name:"Billing Address"}},RubricEvaluationTypes:{Points:{Value:0,Name:"Points"},Range:{Value:1,Name:"Point range"},Letter:{Value:2,Name:"Letter grade"},Percent:{Value:3,Name:"Percentage"},Comment:{Value:4,Name:"Comment only"}},SmartFamilySetupMode:{Enroll2ndStudent:{Value:10,Description:"Add second student to existing family"},ForceParent2Split:{Value:20,Description:"Force second parent to separate account, requested by first parent"},EnrollParent2NoSplit:{Value:30,Description:"Add second parent to family, split no longer available"},PromptParent2Split:{Value:40,Description:"Prompt second parent for same or separate family"},EnrollParent2OneAccount:{Value:50,Description:"Add second parent to family, school does not allow splits"},LinkFamilyToContract:{Value:60,Description:"Link existing family containing parent and student to contract"},Enroll2ndStudentSeparate:{Value:70,Description:"Enroll a second student using a separate account"},GenerateNewFamily:{Value:99,Description:"Generate a new family"}},CalendarSet:{Core:{Value:1,SessionStateName:"calendar-view"},AdmScheduling:{Value:2,SessionStateName:"adm-calendar-view",CalendarTitle:"Admissions Calendar"}}}}(p3.Us));(function(f){function a(){return window.mixpanel}var b;function c(i,k){var g=p3.Data.Context,h=g.get("IsImpersonating"),j,l;if(!b){b=true;l=g.get("MasterUserInfo");i.identify(k.SchoolName+"|"+l.UserName);j={$first_name:l.FirstName,$last_name:l.LastName,$username:l.UserName};if(l.Email){j.$email=l.Email}i.people.set(j)}if(h){k.IsImpersonating=true;l=g.get("UserInfo");if(l){k.Impersonating_User=l.FirstName+" "+l.LastName;k.Impersonating_Login=l.UserName}}}function d(i,k,g){var j=a(),h;if(j&&j.track){k["Page Name"]=k["Page Name"]||document.title;k.Url=k.Url||window.location.pathname+window.location.hash;h=p3.Config;k.SchoolId=h.SchoolId;k.Version=h.Version;k.SchoolName=p3.Data.SchoolContext.get("SchoolInfo").SchoolName;c(j,k);j.track(i,k,g)}}function e(g,h,j){if(a()&&g===p3.Layout.Containers.Modal){var k,i;if(h==="Loaded"){k=new Date().getTime();d("Form",{Form:j,Action:"Loaded"});g.data("mixpanel-form",j);g.data("mixpanel-start",k)}else{j=g.data("mixpanel-form");k=g.data("mixpanel-start");if(j&&k){i=new Date().getTime();d("Form",{Form:j,Action:h,"Duration in seconds":(i-k)/1000})}g.data("mixpanel-form","");g.data("mixpanel-start","")}}}f.EventTracker={track:d,trackFormClosed:function(g){e(g,"Closed")},trackFormSaved:function(g){e(g,"Saved")},trackFormLoaded:function(g,h){if(h){e(g,"Loaded",(h.template||"").replace(".template.html",""))}},trackPageLoaded:function(g){if(p3.Data.Context){g=g||{};g.Action="Loaded";d("Page",g)}}}}(p3.Us));(function(){function b(c){return c.replace(/\w\S*/g,function(d){return d.charAt(0).toUpperCase()+d.substr(1).toLowerCase()})}Hb.registerHelper("eachWithIndex",function(c,k,h){var d="",e,g,f;if(_.isArray(c)){for(e=0,g=c.length;e<g;e++){f=c[e];f.index=e+k;d+=h.fn(f)}}return d});Hb.registerHelper("eachWithFirstLast",function(c,h){var d="",e,g,f;if(_.isArray(c)){for(e=0,g=c.length;e<g;e++){f=c[e];f.first=(e===0)?true:false;f.last=(e===g-1)?true:false;d+=h.fn(f)}}return d});Hb.registerHelper("eachWithIndexFirstLast",function(c,k,h){var d="",e,g,f;if(_.isArray(c)){for(e=0,g=c.length;e<g;e++){f=c[e];f.first=(e===0)?true:false;f.last=(e===g-1)?true:false;f.index=e+k;d+=h.fn(f)}}return d});Hb.registerHelper("eachKeyValue",function(c,k){if(!_.isArray(c)){c=[c]}var d="",h,e,g,f;for(e=0,g=c.length;e<g;e++){f=c[e];for(h in f){if(f.hasOwnProperty(h)){d+=k.fn({key:h,value:f[h]})}}}return d});Hb.registerHelper("eachKeyValueWithContent",function(c,k){if(!_.isArray(c)){c=[c]}var d="",h,e,g,f;for(e=0,g=c.length;e<g;e++){f=c[e];for(h in f){if(f.hasOwnProperty(h)&&f[h]&&!_.isObject(f[h])){d+=k.fn({key:h,value:f[h]})}}}return d});Hb.registerHelper("eachKeyValueWithAccess",function(d,c,l){if(!_.isArray(d)){d=[d]}var e="",k,f,h,g;for(f=0,h=d.length;f<h;f++){g=d[f];for(k in g){if(g.hasOwnProperty(k)&&$.inArray(k,c)){e+=l.fn({key:k,value:g[k]})}}}return e});Hb.registerHelper("eachKeyValueWithContentAccess",function(d,c,l){if(!_.isArray(d)){d=[d]}var e="",k,f,h,g;for(f=0,h=d.length;f<h;f++){g=d[f];for(k in g){if(g.hasOwnProperty(k)&&g[k]&&!_.isObject(g[k])&&$.inArray(k,c)>-1){e+=l.fn({key:k,value:g[k]})}}}return e});Hb.registerHelper("eachSelected",function(k,c,h){var d="",e,g,f;for(e=0,g=c.length;e<g;e++){f=c[e];f.selectedId=k;d+=h.fn(f)}return d});Hb.registerHelper("eachSelectedCountry",function(k,c,h){var d="",e,g,f;k=b(k);for(e=0,g=c.length;e<g;e++){f=c[e];f.selectedId=k;d+=h.fn(f)}return d});Hb.registerHelper("eachSelectedActive",function(l,c,k){var d="",e,h,g;function f(i){return(i==null||i.length===0)}for(e=0,h=c.length;e<h;e++){g=c[e];if((g.dd_active==true)||(!f(l)&&(g.dd_id.toString()===l.toString()))){g.selectedId=l;d+=k.fn(g)}}return d});Hb.registerHelper("eachSelectedDefault",function(k,c,h){var d="",e,g,f;if(k==null){if(c.length>0){if(_.has(c[0],"dd_default")){_.each(c,function(i){if(i.dd_default==true){k=i.dd_id}})}}}for(e=0,g=c.length;e<g;e++){f=c[e];f.selectedId=k;d+=h.fn(f)}return d});Hb.registerHelper("eachUnique",function(c,d,p){var e="",q=_.chain(c).map(function(i){return i.get(d)}).uniq().value(),f,m,n,o,g,h;for(f=0,m=q.length;f<m;f++){g=q[f];for(n=0,o=c.length;n<o;n++){h=c[n].get(d);if(g==h){e+=p.fn(c[n]);break}}}return e});Hb.registerHelper("eachUniqueToJson",function(c,d,p){var e="",q=_.chain(c).map(function(i){return i[d]}).uniq().value(),f,m,n,o,g,h;for(f=0,m=q.length;f<m;f++){g=q[f];for(n=0,o=c.length;n<o;n++){h=c[n][d];if(g==h){e+=p.fn(c[n]);break}}}return e});Hb.registerHelper("ifAccess",function(d,c,e){return($.inArray(d.toString(),c)>-1)?e.fn(this):e.inverse(this)});Hb.registerHelper("ifValue",function(d,c){return($.trim(d).length===0)?c.inverse(this):c.fn(this)});Hb.registerHelper("ifEmpty",function(d,c){return($.trim(d).length===0)?c.fn(this):c.inverse(this)});Hb.registerHelper("ifContent",function(d,c){return d?c.fn(this):c.inverse(this)});Hb.registerHelper("ifContentAccess",function(d,f,c,e){return(f&&$.inArray(d,c)>-1)?e.fn(this):e.inverse(this)});Hb.registerHelper("ifContains",function(c,f,d){if(f&&c){var e=c;if(!_.isArray(e)){e=e.split(",")}e=e.map(function(g){return g.toString()});return(_.contains(e,f.toString()))?d.fn(this):d.inverse(this)}return d.inverse(this)});Hb.registerHelper("unlessContains",function(c,f,d){if(f&&c){var e=c.split(",");return(_.contains(e,f.toString()))?d.inverse(this):d.fn(this)}return d.fn(this)});Hb.registerHelper("compare",function(c,h,f){if(arguments.length<3){throw new Error("Hb Helper 'compare' needs 2 parameters")}var d=f.hash.operator||"==",e={"==":function(i,j){return i==j},"===":function(i,j){return i===j},"!=":function(i,j){return i!=j},"<":function(i,j){return i<j},">":function(i,j){return i>j},"<=":function(i,j){return i<=j},">=":function(i,j){return i>=j}},g;if(!e[d]){throw new Error("Hb Helper 'compare' doesn't know the operator "+d)}g=e[d](c,h);if(g){return f.fn(this)}return f.inverse(this)});Hb.registerHelper("comparator",function(c,d,g,f){var e={"==":function(h,i){return h==i},"===":function(h,i){return h===i},"!=":function(h,i){return h!=i},"<":function(h,i){return h<i},">":function(h,i){return h>i},"<=":function(h,i){return h<=i},">=":function(h,i){return h>=i},"||":function(h,i){return h||i},"&&":function(h,i){return h&&i},"%":function(h,i){return h%i}};if(arguments.length<4){throw new Error("Hb Helper 'comparator' needs 3 parameters")}if(!e[d]){throw new Error("Hb Helper 'comparator' doesn't know the operator "+d)}return(e[d](c,g))?f.fn(this):f.inverse(this)});Hb.registerHelper("ifAny",function(e){var c=false,f,d=e.hash;for(f in d){if(d.hasOwnProperty(f)&&d[f]){c=true}}return c?e.fn(this):e.inverse(this)});Hb.registerHelper("ifAll",function(e){var c=true,f,d=e.hash;for(f in d){if(d.hasOwnProperty(f)&&!d[f]){c=false}}return c?e.fn(this):e.inverse(this)});Hb.registerHelper("ifAnyValues",function(f){var d=false,e=function(i){var h=$.trim(i);return(h==null||h.length===0)},g,c=f.hash;for(g in c){if(c.hasOwnProperty(g)&&!e(c[g])){d=true}}return d?f.fn(this):f.inverse(this)});Hb.registerHelper("forWithIndex",function(k,d,h){var c="",e,g,f;for(e=k,g=d;e<=g;e++){f={};f.index=e;c+=h.fn(f)}return c});Hb.registerHelper("ifFileType",function(c,d,e){return(c&&p3.Us.FileTools.isValidFile(p3.Us.Enum.UploadType[d],c))?e.fn(this):e.inverse(this)});Hb.registerHelper("unlessFileType",function(c,d,e){return(c&&!p3.Us.FileTools.isValidFile(p3.Us.Enum.UploadType[d],c))?e.fn(this):e.inverse(this)});Hb.registerHelper("eachWithHeader",function(c,f,l){var d="",e,g,k,h;if(_.isArray(c)){e=null;for(g=0,k=c.length;g<k;g++){h=c[g];if(e==h[f]){h._header=null}else{h._header=h[f];e=h[f]}d+=l.fn(h)}}return d});Hb.registerHelper("eachSelectedWithOptgroup",function(m,c,e,l){var d="",g,k,h,f="";if(!_.isArray(c)){c=[c]}if(c.length){_.each(c,function(n,j){n._optGroupEnd=undefined;if(n[e]!==f){f=n[e];if(j>0){c[j-1]._optGroupEnd=true}n._optGroup=f}else{n._optGroup=undefined}});_.last(c)._optGroupEnd=true}for(g=0,k=c.length;g<k;g++){h=c[g];h.selectedId=m;d+=l.fn(h)}return d});Hb.registerHelper("ifStringIncludes",function(f,d,c){var e=c.hash.start||0;if(_.isString(f)&&_.isString(d)&&f.includes(d,e)){return c.fn(this)}return c.inverse(this)});Hb.registerHelper("booleanYesNo",function(d){var c;if(d===null){c=""}else{if(d.toString().toLowerCase()==="true"){c="Yes"}else{if(d.toString().toLowerCase()==="false"){c="No"}else{c=d?"Yes":"No"}}}return c});Hb.registerHelper("dateTimeFormat",function(c,d,e){if(e.hash){e=false}if((c!=null)&&(c.indexOf("00:00:00")>-1)&&e){var g=new RegExp("[hHmtTslL]","g"),f=new RegExp("[hHmtTslL](?!.*[hHmtTslL])","g");if(p3.Us.DateTime.masks[d]){d=String(p3.Us.DateTime.masks[d])}d=d.replace(d.slice(d.search(g),d.search(f)+1),"")}return((c!=null)&&(c!=="")&&(d!==""))?p3.Us.DateTime.format(c,d):null});Hb.registerHelper("dateFormatWithCulture",function(c,d){if(typeof d!=="string"){d="shortDate"}return p3.Us.Culture.displayDate(c,d)});Hb.registerHelper("timeFormatWithCulture",function(c,e,d){if(typeof d!=="string"){d="shortTime"}return p3.Us.Culture.displayTime(c,e,d)});Hb.registerHelper("datetimeSplitDate",function(d){var c;if(d){c=d.split(" ");c=c[0]}else{c=null}return c});Hb.registerHelper("dateDisplay",function(c){return p3.Us.Culture.todayAt(c,true)});Hb.registerHelper("streamDateDisplay",function(c){return p3.Us.Culture.todayAt(c)});Hb.registerHelper("dateDisplayTwoLine",function(c){return p3.Us.Culture.todayAt(c).replace(" at ","<br>at ")});Hb.registerHelper("formatDateAt",function(d,c,e){return p3.Us.Culture.formatDateAt(d,c,e)});Hb.registerHelper("timeDisplay",function(c){if(c){return p3.Us.Culture.displayTime(c,true)}});Hb.registerHelper("monthDateDisplay",function(c){return p3.Us.Culture.monthDay(c)});Hb.registerHelper("shortDateDisplayNoTime",function(c){return p3.Us.Culture.displayDate(c)});Hb.registerHelper("isSameDay",function(c,d,e){return p3.Us.Culture.isSameDay(c,d)?e.fn(this):e.inverse(this)});Hb.registerHelper("isSelected",function(d,e){function c(f){return(f==null||f.length===0)}return new Hb.SafeString((!c(d)&&!c(e)&&d.toString()===e.toString())?' selected="selected"':"")});Hb.registerHelper("isChecked",function(c){return new Hb.SafeString(c?' checked="checked"':"")});Hb.registerHelper("isDisabled",function(c){return new Hb.SafeString(c?' disabled="disabled"':"")});Hb.registerHelper("isActive",function(d,e){function c(f){return(f==null||f.length===0)}return new Hb.SafeString((!c(d)&&d.toString()===e.toString())?" active":"")});Hb.registerHelper("outputDictionary",function(k,c,e,g){var f,h=(e&&!_.isObject(e))?e:"dd_id",j=(g&&!_.isObject(g))?g:"dd_description",d;for(d=0;d<c.length;d++){if(k==c[d][h]){f=c[d][j];break}}return f});Hb.registerHelper("outputDictionaryPlus",function(f,c){var e=f,d;for(d=0;d<c.length;d++){if(f==c[d].dd_id||f==c[d].dd_description){e=c[d].dd_description;break}}return e});Hb.registerHelper("outputDictionaryDataCheck",function(h,c,d,f){var g=false,e;for(e=0;e<d.length;e++){if(h==d[e].dd_id){if(c==d[e].dd_data){g=true;break}}}return g?f.fn(this):f.inverse(this)});Hb.registerHelper("schoolId",function(){return p3.Config.SchoolId});Hb.registerHelper("gradYear",function(c){if(c){return"'"+c.substring(2,4)}});Hb.registerHelper("displayFixedDecimal",function(d,c){return parseFloat(d).toFixed(c)});Hb.registerHelper("replace",function(e,d,c){if(e){return e.replace(d,c)}});Hb.registerHelper("requiredIndicator",function(){return new Hb.SafeString(p3.Us.Validate.requiredIndicator())});Hb.registerHelper("sharedIndicator",function(c){return'<a class="sharedIcon" rel="tooltip" data-content="" data-original-title="This is shared with:'+c+'"><i class="p3icon-share"></i></a>'});Hb.registerHelper("config",function(c){return p3.Config[c]});Hb.registerHelper("configLabel",function(d,c){var f,e=d;if(d!==null&&d!==undefined){f=_.findWhere(p3.Config.LabelDictionary,{Key:d.toLowerCase().replace(" ","")});if(f!==undefined){e=f.Value;if(c===true){e=e.toLowerCase()}}}return e});Hb.registerHelper("HideForSmallCollege",function(c){var d=c.fn(this);if(p3.Config.IsSmallCollege){d=new Hb.SafeString('<div class="hide">'+c.fn(this)+"</div>")}return d});Hb.registerHelper("location",function(c){return location[c]});Hb.registerHelper("ordinate",function(e,c){var d;c=c||{};d=(c.suffix===undefined?" Grade":c.suffix);if(!isNaN(e)){return p3.Us.Tools.formatRank(e)+d}return e});Hb.registerHelper("formatRank",function(c){return p3.Us.Tools.formatRank(c)});Hb.registerHelper("formatCurrency",function(c){return p3.Us.Tools.formatCurrency(c)});Hb.registerHelper("formatCurrencyOutput",function(c){return p3.Us.Tools.formatCurrencyOutput(c)});Hb.registerHelper("formatCurrencySupCents",function(c){return new Hb.SafeString(p3.Us.Tools.formatCurrencySupCents(c))});Hb.registerHelper("currencySymbol",function(c){return p3.Data.SchoolContext.attributes.Culture.NumberFormat.CurrencySymbol});Hb.registerHelper("dateDiff",function(c,d){if(c!=null&&d!=null){if(c=="now"){c=new Date()}else{c=new Date(c)}if(d=="now"){d=new Date()}else{d=new Date(d)}return c-d}return""});Hb.registerHelper("ifPastDue",function(d,f,e){var c;if(d!=null&&f!=null){if(d=="now"){d=new Date()}else{d=new Date(d)}if(f=="now"){f=new Date()}else{f=new Date(f)}c=d-f}return(c<=0)?e.fn(this):e.inverse(this)});var a={};Hb.registerHelper("recursive",function(c,d,e){var f="";if(e.fn!==undefined){a[d]=e.fn}c.forEach(function(g){f=f+a[d](g)});return f});Hb.registerHelper("stringMult",function(g,f){var c="",d,e;for(d=1,e=f;d<e;d++){c+=g}return c});Hb.registerHelper("noCache",function(){return new Date().getTime()});Hb.registerHelper("getSessionState",function(c){return p3.getSessionState(c)});Hb.registerHelper("outputNewLines",function(d){if(d){var c=(d.toString()).replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br>$2");return new Hb.SafeString(c)}});Hb.registerHelper("splitString",function(c){if(c){var d=(c.toString()).replace(/,/g,"<br>");return new Hb.SafeString(d)}});Hb.registerHelper("toZeroBased",function(c){return new Hb.SafeString(c-1)});Hb.registerHelper("toOneBased",function(c){return new Hb.SafeString(c+1)});Hb.registerHelper("valueIfFalse",function(d,e,c){return d||e});Hb.registerHelper("escapeLimited",function(c){c=Hb.Utils.escapeExpression(c);return new Hb.SafeString(c.replace(/&lt;BR&gt;/ig,"<br>"))});Hb.registerHelper("createList",function(c,d){if(c!=null){return c.join(d)}});Hb.registerHelper("nameFormat",function(i,c,h,g,e,f,j,d){return p3.Us.Tools.nameFormat(i,c,h,g,e,f,j,d)});Hb.registerHelper("stripWhiteSpace",function(c){return new Hb.SafeString(c.replace(/ /g,""))});Hb.registerHelper("commalist",function(d,f){var g="",c,e;if(d){for(c=0,e=d.length;c<e;c++){g=g+f.fn(d[c])+(c!==(e-1)?", ":"")}}return g});Hb.registerHelper("mediaIcon",function(c){switch(c){case (31):return"p3icon-topicPhoto";case (165):return"p3icon-topicAudio";case (167):return"p3icon-topicVideo"}});Hb.registerHelper("mediaLabel",function(c){switch(c){case (31):return"Photos";case (165):return"Clips";case (167):return"Videos"}});Hb.registerHelper("mediaCount",function(c,e,f,g){var d=e;switch(c){case (31):return e;case (165):return e;case (167):if(g){d=f}return d}});Hb.registerHelper("mediaCountLabel",function(c,d){switch(c){case (31):return(d!=1)?"photos":"photo";case (165):return(d!=1)?"clips":"clip";case (167):return(d!=1)?"videos":"video"}});Hb.registerHelper("phoneNumberLink",function(d){var c="";d=d.replace(/[() \-]/g,"");if(d.length===10){c="1"+d}else{c=d}return c});Hb.registerHelper("isVideoProcessing",function(c,f,d,e){var g=false;if(d){if(!f){g=true;if(parseInt(c,10)===0){g=false}}}else{if(parseInt(c,10)>0){g=true}}return g?e.fn():e.inverse()});Hb.registerHelper("loadingIcon",function(c){var d=(_.isString(c))?c:"";return new Hb.SafeString('<div class="textcenter"><img src="'+p3.Config.CssImagePath+'spinner.gif" > '+d+"</div>")});Hb.registerHelper("skyLoadingIcon",function(d,c){var f=(_.isString(d))?d:"",e=(_.isString(c))?" "+c:"";return new Hb.SafeString('<div style="position:relative; min-height:100px; min-width:100px"><div class="sky-wait-mask text-align-center'+e+'"><div class="sky-wait">'+f+"</div></div></div>")});Hb.registerHelper("trimString",function(d,c){if(d&&d.length>c){d=d.substring(0,c)+"..."}else{if(d===null||d===undefined){d=""}}return d});Hb.registerHelper("captchaContainer",function(){return new Hb.SafeString(p3.Us.Captcha.GetContainer())});Hb.registerHelper("stringEncodeURIComponent",function(c){return encodeURIComponent(c)});Hb.registerHelper("stringtToLowerCase",function(c){return c.toLowerCase()});Hb.registerHelper("filenameToId",function(c){return p3.Us.Tools.filenameToId(c)});Hb.registerHelper("photonForAvatar",function(c){return p3.Us.Tools.photonForAvatar(c)});Hb.registerHelper("photonForAvatarMedium",function(c){return p3.Us.Tools.photonForAvatarMedium(c)});Hb.registerHelper("photonForThumbnail",function(c){return p3.Us.Tools.photonForThumbnail(c)});Hb.registerHelper("stripHTML",function(c){return new Hb.SafeString(c.replace(/<br(.|\n)*?>/g,"").replace(/<(.|\n)*?>/gi,""))})}());(function(a){p3.Us.InfoMessage=a;a.ErrorBox=function(d,b,c){var e='<div id="infomessage-error" class="alert alert-error alert-danger">';e=e+d;e=e+"</div>";$(b).prepend(e);if(c){setTimeout(function(){$(".alert-error").fadeOut("slow",function(){$(this).remove()})},2000)}};a.SuccessBox=function(d,b,c){var e='<div class="alert alert-success">';e=e+d;e=e+"</div>";$(b).prepend(e);if(c){setTimeout(function(){$(".alert-success").fadeOut("slow",function(){$(this).remove()})},2000)}};a.InformationBox=function(d,b,c){var e='<div class="alert alert-info">';e=e+d;e=e+"</div>";$(b).prepend(e);if(c){setTimeout(function(){$(".alert-info").fadeOut("slow",function(){$(this).remove()})},2000)}}}(p3.module("utilities/infomessage")));(function(a){a.InfoMessageLibrary={P3:{SaveSuccess:"Your save was successful.",SaveError:"There was an error saving.",ErrorTryAgain:"There was an error. Please try again.",RequiredInfoNotEntered:"Please enter all required information.",NotNumeric:"Invalid value, must be numeric.",MaxLengthExceeded:"The value entered exceeds the maximum allowed characters.",DateError:"Date is not valid. Please enter as mm/dd/yyyy.",TimeError:"Time is not valid.",CCTypeError:"Invalid credit card number for card type selected.",InvalidPwd:"Invalid Password.",FileNameDuplicate:"The file name you entered already exists.  Please enter a different file name.",FileNameInvalidChars:"The file name you entered contains invalid characters. Please enter a different file name.",FileNameToLong:"The file name you selected is too long. Please enter a file name of 200 characters or less.",FileTypeUnsupported:"The file you selected is a restricted file type. Please contact your content manager if you need to upload a file type which is not restricted.",EmailError:"This email is invalid. Please try again.",UrlError:"This url is invalid. Please try again.",DigitError:"Please enter numbers only."},Grading:{RemovingGrade:'<h4 class="alert-heading">Hold your horses!</h4><p>Did you really want to mark that grade for deletion? Please click "Confirm" to proceed or "Cancel" to prevent saving changes.</p>',NumbersOnly:"Whoops! Please only enter numbers (decimals are okay, but not negatives) in this numeric field.",DigitsOnly:"Whoops! Please only enter numbers (not decimals or negatives) in this numeric field.",ValidateDelete:'The comment has been marked for deletion. Click "Save & Next Student" or "Save & Close" to confirm. Click "Next Student" or close the window to cancel the change.',ValidateDeleteAssessment:'The comment has been marked for deletion. Click "Save & Close" to confirm, or close the window to cancel the change.',RequiredGradeNotEntered:'<h4 class="alert-heading">Oh boy... This is awkward.</h4><p>In order to mark those students as Ready for Review, you first need to record the required Grade(s) and/or Comment(s) for them.</p>',SaveDisabled:"You must correct the error on the screen prior to saving",ValidateDeleteBulkAssessment:"One or more grades and/or comments have been selected, but with no value entered. This will result in previously recorded grades/comments for the selected student(s) being deleted. Click 'Save & Close' to confirm, or close the window to cancel the change.",MissingRequiredGradeInFormula:'<h4 class="alert-heading">An incomplete formula has been applied.</h4><p>The highlighted students do not display a grade because they are missing a required grade that is being included in the calculation.</p>',UnableToTranslateGrade:'<h4 class="alert-heading">A grade could not be saved.</h4><p>The highlighted students have a calculated grade that could not be translated using the associated translation table.</p>',NoTextEntered:"No text was entered, therefore no comment has been saved for this student",MissingGradeInFormula:'<h4 class="alert-heading">Hmmm.Something is just not right.</h4><p>The highlighted students are missing a grade that is being included in the calculation, but since it is not required, the calculation has been completed without it.</p>',NoActiveGradePlans:"There are no active grade plans at this time."},Assignment:{AssignmentDeleteConfirmation:"<p>Wait a minute! Are you sure you want to delete this assignment forever? Once you hit confirm there is no undo button.</p><p>To delete this assignment leave Remove checked for all class sections listed and click Confirm.</p><p>To only remove this assignment from specific class sections, uncheck Remove in list below for the sections that should keep this assignment and click Confirm.</p>",AssignmentDeleteBlockedForGradesEntered:"Whoops! We can't let you delete this assignment! Grades have been recorded for the following course sections.",AssignmentDeleteAssociatedSubmissions:"<p>Wait a minute! Are you sure you want to delete this assignment along with all the student drop box submissions forever? </p><p>Once you hit confirm there is no undo button.</p><p>To delete this assignment and the drop box submissions leave Remove checked for all class sections listed and click Confirm.</p><p>To only remove this assignment and submissions from specific class sections, uncheck Remove in list below for the sections that should keep this assignment and click Confirm.</p>",GradeBookRequiredFields:"If the assignment is set to be included in gradebook, you must enter an assignment type, abbreviation, max points and factor.",TitleLengthError:"You have gone over the character limit. Please edit the title field.",FileRequiresDescription:"Please enter a Description for your download.",LinkRequiresDescription:"Please enter a Description for your link.",SectionRequired:"Please select at least one section.",DueDateMustBeInMarkingPeriod:"Due date must fall within a marking period.",GradeBookSetupIsRequired:"Marking periods have not been set up for this Gradebook.",GradedLTIRequiresGradebook:"The selected learning tool returns grades, so this assignment must be included in the gradebook.",AssignmentDetailAllowResubmit:"You are about to allow this student to resubmit the assignment. Click 'OK' to allow resubmit or 'Cancel' to continue to show the assignment as submitted.",AssignmentDetailRemoveConfirm:"Are you sure you wish to remove this file?",AssignmentDetailDropBoxSubmit:"<p>Are you sure that this is ready to be submitted? Once submitted no further edits can be made.</p>",LtiProviderRequired:"<p>There is no third party submission tool selected.</p>",LtiProviderRequiresGradebook:"<p>The third party submission tool requires that this assignment be included in the gradebook.</p>",FileTypeUnsupported:"The file you selected is a restricted file type."},Attendance:{ChangedRecord:"Uh-Oh! Someone has already recorded attendance for the student(s) listed below. All you have to do now is click Confirm to continue."},Broadcast:{FileTypeUnsupported:"The file you selected is not a valid file type."},Account:{CurrentPasswordError:"Invalid current password. Please try again.",NewPasswordMatch:"New passwords do not match. Please try again.",NewPasswordInvalid:"The new password entered does not meet the password requirements. Please try again."},Profile:{NonUniqueUsername:"Username is already in use.",NonUniqueEmail:"Email is already in use.",NoPasswordMatch:"The passwords do not match.",PostalCodeError:"Postal code is incorrect."},Login:{FutureDate:"Date can not be in the future.",MaxDateOfBirth:"Date of birth cannot be greater than one year from today."},PageManagement:{LayoutNameDuplicate:"The layout name you entered already exists.  Please enter a different layout name.",StyleNameDuplicate:"The style name you entered already exists.  Please enter a different style name.",MinImageCount:"There must be at least one background image.  Leave the field blank to include all images.",RedirectPageRequired:"Please select a redirect destination.",RedirectUrlInvalid:"Please enter a valid Url.",RedirectUrlMatch:"From Url cannot match To Url.",RedirectDuplicateFrom:"You have entered a duplicate From / Known As URL.",InvalidFromURl:"Please enter valid url that does not contain myschoolapp.com"},Admissions:{MinuteRange:"Please enter a value between 0 and 59.",MonthRange:"Please enter a value between 0 and 11.",UniqueSchool:"School Name Other or Sending School has to be unique per school year."},CourseRequest:{NoCourseRequests:"No Course Requests open at this time.",MustEnterDateBeforeTime:"Select Signup date before choosing a time."},Offerings:{CreditsNotEqual:"Entered values must equal total credit for course."},Calendar:{UniqueCalendar:"Calendar name must be unique."}}}(p3.Us));(function(a){a.Tools={leadingZero:function(b){return b<10?"0"+b:b},parseDate:function(b){if(_.isString(b)&&b.substring(0,1)==="/"){return new Date(parseInt(b.substr(6),10))}return new Date(b)},dateDisplay:function(b){var d=new Date(),c;b=this.parseDate(b);if(d.getFullYear()===b.getFullYear()&&d.getMonth()===b.getMonth()&&d.getDate()===b.getDate()){c="Today at "}else{c=p3.Us.DataLibrary.MonthNames[b.getMonth()]+" "+b.getDate()+", "+b.getFullYear()+" at "}c+=this.timeDisplay(b);return c},streamDateDisplay:function(b){var e=new Date(),c,d;b=this.parseDate(b);d=a.Tools.timeDisplay(b);if(e.getFullYear()===b.getFullYear()&&e.getMonth()===b.getMonth()&&e.getDate()===b.getDate()){c="Today"}else{c=p3.Us.DataLibrary.MonthNames[b.getMonth()]+" "+b.getDate()+", "+b.getFullYear()}if(d!=="12:00 AM"){c+=" at "+d}return c},timeDisplay:function(c){var b,d,e;c=this.parseDate(c);b=c.getHours();if(b>12){b=b-12;e="PM"}else{if(b===12){e="PM"}else{if(b===0){b=12;e="AM"}else{e="AM"}}}d=this.leadingZero(c.getMinutes());return b+":"+d+" "+e},timeDisplay2:function(c){var b,d,e,g,f;if(c){g=c.split(":");b=g[0];if(b>12){b=b-12;e="PM"}else{if(b===12){e="PM"}else{if(b===0){b=12;e="AM"}else{e="AM"}}}d=g[1];f=b+":"+d+" "+e}else{f=null}return f},to24Hour:function(b){return new Date("01/01/2000 "+b).toTimeString().slice(0,8)},shortDateDisplay:function(b){var c;b=this.parseDate(b);c=b.getMonth()+1+"/"+b.getDate()+"/"+b.getFullYear();c+=" "+this.timeDisplay(b);return c},shortDateDisplayNoTime:function(b){var c;b=this.parseDate(b);c=b.getMonth()+1+"/"+b.getDate()+"/"+b.getFullYear();return c},monthDateDisplay:function(b){b=this.parseDate(b);return b.getMonth()+1+"/"+b.getDate()},monthShort:function(d,b){var c,g,e,f;if(d){c=new Date(d);e=p3.Us.DataLibrary.MonthNames[c.getMonth()];f=e.substring(0,3);if(b===2){g=f.toUpperCase()}else{g=f}}else{g=null}return g},convertFromScientificNotation:function(c){var b;if(c!==null){if(Math.abs(c)<1){b=parseInt(c.toString().split("e-")[1],10);if(b){c*=Math.pow(10,b-1);c="0."+new Array(b).join("0")+c.toString().substring(2)}}else{b=parseInt(c.toString().split("+")[1],10);if(b>20){b-=20;c/=Math.pow(10,b);c+=new Array(b+1).join("0")}}}return c},speechCapable:function(){return window.SpeechRecognition?true:window.webkitSpeechRecognition||window.mozSpeechRecognition||window.oSpeechRecognition||window.msSpeechRecognition?true:false},getQuerystringValue:function(b){b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var d="[\\?&]"+b+"=([^&#]*)",c=new RegExp(d),e=c.exec(window.location.search);if(e===null){return""}return decodeURIComponent(e[1].replace(/\+/g," "))},setMaxBoxHeight:function(c,d){c=$(c);var b,f='<div><a href="#"><i class="p3icon-moreInfo"></i> Show Full Text</a></div>',e='<div><a href="#"><i class="p3icon-moreInfo"></i> Hide Full Text</a></div>';c.css({"max-height":d+"px",overflow:"hidden"});if(c[0].scrollHeight>c[0].clientHeight){b=$(f);c.after(b);b.on("click",function(){if(c.hasClass("box-full")){c.removeClass("box-full").css({"max-height":d+"px"});b.html(f)}else{c.addClass("box-full").css({"max-height":"none"});b.html(e)}return false})}},setItemValue:function(b,e){var d=b.get(0),c=b.data("datatype");if(c&&e){switch(c){case"integer":e=parseInt(e,10);break}}if(b.data("toggle")==="buttons-radio"||b.data("toggle")==="buttons"){b.children(".btn-form").removeClass("active");b.find('.btn-form[data-val="'+e+'"]').addClass("active").click()}else{if(b.hasClass("btn-check")){if(e&&e===b.data("val")){b.addClass("active")}else{b.removeClass("active")}}else{if(b.hasClass("data-value")){b.data("val",e)}else{switch(d.type){case ("checkbox"):if(e===undefined){b.prop("checked",false)}else{if(typeof e==="boolean"){b.prop("checked",e)}else{if(e.toString().indexOf(b.attr("data-id"))>=0){b.prop("checked",true)}}}break;case ("radio"):if(b.val()===e){b.prop("checked",true)}break;default:b.val(e);break}}}}},getItemValue:function(c){var e=c.attr("id"),d=c.get(0),g,f=true,b,h="";if(c.data("toggle")==="buttons-radio"||c.data("toggle")==="buttons"){b=c.find(".active");if(b.length>0){g=b.data("val")}}else{if(c.hasClass("btn-check")){if(c.hasClass("active")){g=c.data("val")}else{g=""}}else{if(c.hasClass("data-value")){g=c.data("val")}else{switch(d.type){case ("checkbox"):g=c.is(":checked");break;case ("radio"):if(c.is(":checked")){e=c.attr("Name");g=c.val()}else{f=false}break;default:g=c.val();break}}}}if(c.data("suffix")&&g&&(g.indexOf("suffix")===-1)){g+=c.data("suffix")}if(c.attr("data-id")>0){$("."+c.attr("name")).each(function(j,i){if($(this).is(":checked")||$(this).hasClass("active")){h=h===""?$(this).attr("data-id"):h+","+$(this).attr("data-id")}});return{Prop:c.attr("name"),Val:h}}if(f){return{Prop:e,Val:g}}},trim:function(b){return b?b.replace(/^\s+|\s+$/g,""):b},eventReport:function(g,f){var b={},c=0,d,e;$(g||"*",f).andSelf().each(function(){var h=$._data(this,"events"),i;if(!h){return}d=$(this).text();e=c+": "+this.tagName+" "+(this.id?"#"+this.id:"")+(d?d.substring(0,20):"");i={TagName:this.tagName,Id:this.id,ClassName:this.className,Text:d,Events:h};b[e]=i;c++});return b},formatRank:function(c){var b=["th","st","nd","rd"],d=parseInt(c,10);return(d?(c+b[d%10>3?0:(d%100-d%10!==10)*d%10]):"")},formatDecimal:function(c,b){var d=parseFloat(c);if(!isNaN(d)){switch(b){case 4:d=(Math.floor((d*10000)+1e-07)/10000).toFixed(4);break;default:d=(Math.floor((d*100)+1e-05)/100).toFixed(2)}return d}return c},formatCurrency:function(b){if(b&&typeof b==="string"){b=b.replace(",","")}return this.formatDecimal(b)},formatCurrencyOutput:function(b){var c=parseFloat(b),d;if(!isNaN(c)){c=(Math.floor((c*100)+1e-05)/100).toFixed(2);d=c.toString().split(".");d[0]=d[0].replace(/\B(?=(\d{3})+(?!\d))/g,",");return p3.Data.SchoolContext.attributes.Culture.NumberFormat.CurrencySymbol+d.join(".")}return b},formatCurrencySupCents:function(b){var c=parseFloat(b),d;if(!isNaN(c)){c=(Math.floor((c*100)+1e-05)/100).toFixed(2);d=c.toString().split(".");d[0]=d[0].replace(/\B(?=(\d{3})+(?!\d))/g,",");return p3.Data.SchoolContext.attributes.Culture.NumberFormat.CurrencySymbol+d[0]+"<sup class='sup-cents'>"+d[1]+"</sup>"}return b},nameFormat:function(i,b,h,f,d,e,j,c){var g="";if(p3.Data.SchoolContext.get("SchoolInfo").NameFormat&&p3.Data.SchoolContext.get("SchoolInfo").NameFormat.length>0){g=p3.Data.SchoolContext.get("SchoolInfo").NameFormat}else{g='{prefix} {firstname} "{nickname}" {middlename} ({maidenname}) {lastname} {suffix} {gradabbr}'}if(i&&i.length>0){g=g.replace("{prefix}",i)}else{g=g.replace("{prefix}","")}if(b&&b.length>0){g=g.replace("{firstname}",b)}else{g=g.replace("{firstname}","")}if(h&&h.length>0){g=g.replace("{nickname}",h)}else{g=g.replace("{nickname}","")}if(f&&f.length>0){g=g.replace("{middlename}",f)}else{g=g.replace("{middlename}","")}if(e&&e.length>0){g=g.replace("{maidenname}",e)}else{g=g.replace("{maidenname}","")}if(d&&d.length>0){g=g.replace("{lastname}",d)}else{g=g.replace("{lastname}","")}if(j&&j.length>0){g=g.replace("{suffix}",j)}else{g=g.replace("{suffix}","")}if(c&&c.length>0){g=g.replace("{gradyear}",c);g=g.replace("{gradabbr}","'"+c.substring(2))}else{g=g.replace("{gradyear}","");g=g.replace("{gradabbr}","")}if(g.indexOf("{nickname|firstname}")>-1){if(h&&h.length>0){g=g.replace("{nickname|firstname}",h)}else{if(b&&b.length>0){g=g.replace("{nickname|firstname}",b)}else{g=g.replace("{nickname|firstname}","")}}}g=g.replace("()","");g=g.replace("()","");g=g.replace('""',"");g=g.replace("  "," ");return g},removeDiacritics:function(d){var c,b;if(!d||d.trim().length<1||d.search(/[^a-z0-9\s\"\'\(\)\-\_\.]/gmi)===-1){return d}b=[{base:"A",letters:/[\u0041\u24B6\uFF21\u00C0\u00C1\u00C2\u1EA6\u1EA4\u1EAA\u1EA8\u00C3\u0100\u0102\u1EB0\u1EAE\u1EB4\u1EB2\u0226\u01E0\u00C4\u01DE\u1EA2\u00C5\u01FA\u01CD\u0200\u0202\u1EA0\u1EAC\u1EB6\u1E00\u0104\u023A\u2C6F]/g},{base:"AA",letters:/[\uA732]/g},{base:"AE",letters:/[\u00C6\u01FC\u01E2]/g},{base:"AO",letters:/[\uA734]/g},{base:"AU",letters:/[\uA736]/g},{base:"AV",letters:/[\uA738\uA73A]/g},{base:"AY",letters:/[\uA73C]/g},{base:"B",letters:/[\u0042\u24B7\uFF22\u1E02\u1E04\u1E06\u0243\u0182\u0181]/g},{base:"C",letters:/[\u0043\u24B8\uFF23\u0106\u0108\u010A\u010C\u00C7\u1E08\u0187\u023B\uA73E]/g},{base:"D",letters:/[\u0044\u24B9\uFF24\u1E0A\u010E\u1E0C\u1E10\u1E12\u1E0E\u0110\u018B\u018A\u0189\uA779]/g},{base:"DZ",letters:/[\u01F1\u01C4]/g},{base:"Dz",letters:/[\u01F2\u01C5]/g},{base:"E",letters:/[\u0045\u24BA\uFF25\u00C8\u00C9\u00CA\u1EC0\u1EBE\u1EC4\u1EC2\u1EBC\u0112\u1E14\u1E16\u0114\u0116\u00CB\u1EBA\u011A\u0204\u0206\u1EB8\u1EC6\u0228\u1E1C\u0118\u1E18\u1E1A\u0190\u018E]/g},{base:"F",letters:/[\u0046\u24BB\uFF26\u1E1E\u0191\uA77B]/g},{base:"G",letters:/[\u0047\u24BC\uFF27\u01F4\u011C\u1E20\u011E\u0120\u01E6\u0122\u01E4\u0193\uA7A0\uA77D\uA77E]/g},{base:"H",letters:/[\u0048\u24BD\uFF28\u0124\u1E22\u1E26\u021E\u1E24\u1E28\u1E2A\u0126\u2C67\u2C75\uA78D]/g},{base:"I",letters:/[\u0049\u24BE\uFF29\u00CC\u00CD\u00CE\u0128\u012A\u012C\u0130\u00CF\u1E2E\u1EC8\u01CF\u0208\u020A\u1ECA\u012E\u1E2C\u0197]/g},{base:"J",letters:/[\u004A\u24BF\uFF2A\u0134\u0248]/g},{base:"K",letters:/[\u004B\u24C0\uFF2B\u1E30\u01E8\u1E32\u0136\u1E34\u0198\u2C69\uA740\uA742\uA744\uA7A2]/g},{base:"L",letters:/[\u004C\u24C1\uFF2C\u013F\u0139\u013D\u1E36\u1E38\u013B\u1E3C\u1E3A\u0141\u023D\u2C62\u2C60\uA748\uA746\uA780]/g},{base:"LJ",letters:/[\u01C7]/g},{base:"Lj",letters:/[\u01C8]/g},{base:"M",letters:/[\u004D\u24C2\uFF2D\u1E3E\u1E40\u1E42\u2C6E\u019C]/g},{base:"N",letters:/[\u004E\u24C3\uFF2E\u01F8\u0143\u00D1\u1E44\u0147\u1E46\u0145\u1E4A\u1E48\u0220\u019D\uA790\uA7A4]/g},{base:"NJ",letters:/[\u01CA]/g},{base:"Nj",letters:/[\u01CB]/g},{base:"O",letters:/[\u004F\u24C4\uFF2F\u00D2\u00D3\u00D4\u1ED2\u1ED0\u1ED6\u1ED4\u00D5\u1E4C\u022C\u1E4E\u014C\u1E50\u1E52\u014E\u022E\u0230\u00D6\u022A\u1ECE\u0150\u01D1\u020C\u020E\u01A0\u1EDC\u1EDA\u1EE0\u1EDE\u1EE2\u1ECC\u1ED8\u01EA\u01EC\u00D8\u01FE\u0186\u019F\uA74A\uA74C]/g},{base:"OI",letters:/[\u01A2]/g},{base:"OO",letters:/[\uA74E]/g},{base:"OU",letters:/[\u0222]/g},{base:"P",letters:/[\u0050\u24C5\uFF30\u1E54\u1E56\u01A4\u2C63\uA750\uA752\uA754]/g},{base:"Q",letters:/[\u0051\u24C6\uFF31\uA756\uA758\u024A]/g},{base:"R",letters:/[\u0052\u24C7\uFF32\u0154\u1E58\u0158\u0210\u0212\u1E5A\u1E5C\u0156\u1E5E\u024C\u2C64\uA75A\uA7A6\uA782]/g},{base:"S",letters:/[\u0053\u24C8\uFF33\u1E9E\u015A\u1E64\u015C\u1E60\u0160\u1E66\u1E62\u1E68\u0218\u015E\u2C7E\uA7A8\uA784]/g},{base:"T",letters:/[\u0054\u24C9\uFF34\u1E6A\u0164\u1E6C\u021A\u0162\u1E70\u1E6E\u0166\u01AC\u01AE\u023E\uA786]/g},{base:"TZ",letters:/[\uA728]/g},{base:"U",letters:/[\u0055\u24CA\uFF35\u00D9\u00DA\u00DB\u0168\u1E78\u016A\u1E7A\u016C\u00DC\u01DB\u01D7\u01D5\u01D9\u1EE6\u016E\u0170\u01D3\u0214\u0216\u01AF\u1EEA\u1EE8\u1EEE\u1EEC\u1EF0\u1EE4\u1E72\u0172\u1E76\u1E74\u0244]/g},{base:"V",letters:/[\u0056\u24CB\uFF36\u1E7C\u1E7E\u01B2\uA75E\u0245]/g},{base:"VY",letters:/[\uA760]/g},{base:"W",letters:/[\u0057\u24CC\uFF37\u1E80\u1E82\u0174\u1E86\u1E84\u1E88\u2C72]/g},{base:"X",letters:/[\u0058\u24CD\uFF38\u1E8A\u1E8C]/g},{base:"Y",letters:/[\u0059\u24CE\uFF39\u1EF2\u00DD\u0176\u1EF8\u0232\u1E8E\u0178\u1EF6\u1EF4\u01B3\u024E\u1EFE]/g},{base:"Z",letters:/[\u005A\u24CF\uFF3A\u0179\u1E90\u017B\u017D\u1E92\u1E94\u01B5\u0224\u2C7F\u2C6B\uA762]/g},{base:"a",letters:/[\u0061\u24D0\uFF41\u1E9A\u00E0\u00E1\u00E2\u1EA7\u1EA5\u1EAB\u1EA9\u00E3\u0101\u0103\u1EB1\u1EAF\u1EB5\u1EB3\u0227\u01E1\u00E4\u01DF\u1EA3\u00E5\u01FB\u01CE\u0201\u0203\u1EA1\u1EAD\u1EB7\u1E01\u0105\u2C65\u0250]/g},{base:"aa",letters:/[\uA733]/g},{base:"ae",letters:/[\u00E6\u01FD\u01E3]/g},{base:"ao",letters:/[\uA735]/g},{base:"au",letters:/[\uA737]/g},{base:"av",letters:/[\uA739\uA73B]/g},{base:"ay",letters:/[\uA73D]/g},{base:"b",letters:/[\u0062\u24D1\uFF42\u1E03\u1E05\u1E07\u0180\u0183\u0253]/g},{base:"c",letters:/[\u0063\u24D2\uFF43\u0107\u0109\u010B\u010D\u00E7\u1E09\u0188\u023C\uA73F\u2184]/g},{base:"d",letters:/[\u0064\u24D3\uFF44\u1E0B\u010F\u1E0D\u1E11\u1E13\u1E0F\u0111\u018C\u0256\u0257\uA77A]/g},{base:"dz",letters:/[\u01F3\u01C6]/g},{base:"e",letters:/[\u0065\u24D4\uFF45\u00E8\u00E9\u00EA\u1EC1\u1EBF\u1EC5\u1EC3\u1EBD\u0113\u1E15\u1E17\u0115\u0117\u00EB\u1EBB\u011B\u0205\u0207\u1EB9\u1EC7\u0229\u1E1D\u0119\u1E19\u1E1B\u0247\u025B\u01DD]/g},{base:"f",letters:/[\u0066\u24D5\uFF46\u1E1F\u0192\uA77C]/g},{base:"g",letters:/[\u0067\u24D6\uFF47\u01F5\u011D\u1E21\u011F\u0121\u01E7\u0123\u01E5\u0260\uA7A1\u1D79\uA77F]/g},{base:"h",letters:/[\u0068\u24D7\uFF48\u0125\u1E23\u1E27\u021F\u1E25\u1E29\u1E2B\u1E96\u0127\u2C68\u2C76\u0265]/g},{base:"hv",letters:/[\u0195]/g},{base:"i",letters:/[\u0069\u24D8\uFF49\u00EC\u00ED\u00EE\u0129\u012B\u012D\u00EF\u1E2F\u1EC9\u01D0\u0209\u020B\u1ECB\u012F\u1E2D\u0268\u0131]/g},{base:"j",letters:/[\u006A\u24D9\uFF4A\u0135\u01F0\u0249]/g},{base:"k",letters:/[\u006B\u24DA\uFF4B\u1E31\u01E9\u1E33\u0137\u1E35\u0199\u2C6A\uA741\uA743\uA745\uA7A3]/g},{base:"l",letters:/[\u006C\u24DB\uFF4C\u0140\u013A\u013E\u1E37\u1E39\u013C\u1E3D\u1E3B\u017F\u0142\u019A\u026B\u2C61\uA749\uA781\uA747]/g},{base:"lj",letters:/[\u01C9]/g},{base:"m",letters:/[\u006D\u24DC\uFF4D\u1E3F\u1E41\u1E43\u0271\u026F]/g},{base:"n",letters:/[\u006E\u24DD\uFF4E\u01F9\u0144\u00F1\u1E45\u0148\u1E47\u0146\u1E4B\u1E49\u019E\u0272\u0149\uA791\uA7A5]/g},{base:"nj",letters:/[\u01CC]/g},{base:"o",letters:/[\u006F\u24DE\uFF4F\u00F2\u00F3\u00F4\u1ED3\u1ED1\u1ED7\u1ED5\u00F5\u1E4D\u022D\u1E4F\u014D\u1E51\u1E53\u014F\u022F\u0231\u00F6\u022B\u1ECF\u0151\u01D2\u020D\u020F\u01A1\u1EDD\u1EDB\u1EE1\u1EDF\u1EE3\u1ECD\u1ED9\u01EB\u01ED\u00F8\u01FF\u0254\uA74B\uA74D\u0275]/g},{base:"oi",letters:/[\u01A3]/g},{base:"ou",letters:/[\u0223]/g},{base:"oo",letters:/[\uA74F]/g},{base:"p",letters:/[\u0070\u24DF\uFF50\u1E55\u1E57\u01A5\u1D7D\uA751\uA753\uA755]/g},{base:"q",letters:/[\u0071\u24E0\uFF51\u024B\uA757\uA759]/g},{base:"r",letters:/[\u0072\u24E1\uFF52\u0155\u1E59\u0159\u0211\u0213\u1E5B\u1E5D\u0157\u1E5F\u024D\u027D\uA75B\uA7A7\uA783]/g},{base:"s",letters:/[\u0073\u24E2\uFF53\u00DF\u015B\u1E65\u015D\u1E61\u0161\u1E67\u1E63\u1E69\u0219\u015F\u023F\uA7A9\uA785\u1E9B]/g},{base:"t",letters:/[\u0074\u24E3\uFF54\u1E6B\u1E97\u0165\u1E6D\u021B\u0163\u1E71\u1E6F\u0167\u01AD\u0288\u2C66\uA787]/g},{base:"tz",letters:/[\uA729]/g},{base:"u",letters:/[\u0075\u24E4\uFF55\u00F9\u00FA\u00FB\u0169\u1E79\u016B\u1E7B\u016D\u00FC\u01DC\u01D8\u01D6\u01DA\u1EE7\u016F\u0171\u01D4\u0215\u0217\u01B0\u1EEB\u1EE9\u1EEF\u1EED\u1EF1\u1EE5\u1E73\u0173\u1E77\u1E75\u0289]/g},{base:"v",letters:/[\u0076\u24E5\uFF56\u1E7D\u1E7F\u028B\uA75F\u028C]/g},{base:"vy",letters:/[\uA761]/g},{base:"w",letters:/[\u0077\u24E6\uFF57\u1E81\u1E83\u0175\u1E87\u1E85\u1E98\u1E89\u2C73]/g},{base:"x",letters:/[\u0078\u24E7\uFF58\u1E8B\u1E8D]/g},{base:"y",letters:/[\u0079\u24E8\uFF59\u1EF3\u00FD\u0177\u1EF9\u0233\u1E8F\u00FF\u1EF7\u1E99\u1EF5\u01B4\u024F\u1EFF]/g},{base:"z",letters:/[\u007A\u24E9\uFF5A\u017A\u1E91\u017C\u017E\u1E93\u1E95\u01B6\u0225\u0240\u2C6C\uA763]/g}];
for(c=0;c<b.length;c++){d=d.replace(b[c].letters,b[c].base)}return d},stringToBoolean:function(c){if(_.isString(c)){var b=$.trim(c.toLowerCase());if(b==="true"){return true}if(b==="false"){return false}}return c},stringToInt:function(c){if(_.isString(c)){var b=parseInt(c,10);if(isNaN(b)){return c}return b}return c},stringToFloat:function(c){if(_.isString(c)){var b=parseFloat(c,10);if(isNaN(b)){return c}return b}return c},createEmbed:function(b,e){e=e||{};b=b||"#";var d="",h=(!window.location.origin)?window.location.protocol+"//"+window.location.host:window.location.origin,g=h+p3.Config.RootPath+"embed"+b,i=e.width||"100%",c=e.height||"500px",f=e.height||"yes";d+='<iframe src="'+g+'" frameborder="0" scrolling="'+f+'" width="'+i+'" height="'+c+'"></iframe>';return d},resizeIFrame:function(b){setInterval(function(){var c=b||"iframe";$(c,window.parent.document).attr("height",$("#site-main").outerHeight()+"px")},1000)},userNameFormat:function(b,c){var e="",d={P:b.Prefix||"",F:b.FirstName||"",N:b.NickName||"",M:b.MiddleName||"",L:b.LastName||"",S:b.Suffix||""};if(!b){return""}e=a.Tools.stringReplaceAll(c,d);e=e.replace(/ {2,}/g," ");return e},addressFormat:function(b,d){var c="";d=d||false;if(!b){return""}if(d){if(b.AddressLine1){c+=b.AddressLine1}if(b.AddressLine2){c+=", "+b.AddressLine2}if(b.AddressLine3){c+=", "+b.AddressLine3}if(b.City){c+=", "+b.City}if(b.State){c+=", "+b.State}else{if(b.Province){c+=", "+b.Province}}if(this.trim(b.Zip)){c+=", "+this.trim(b.Zip)}if(b.Country&&b.Country!=="United States"){c+=", "+b.Country}}else{if(b.AddressLine1){c+=b.AddressLine1}if(b.AddressLine2){c+="<br />"+b.AddressLine2}if(b.AddressLine3){c+="<br />"+b.AddressLine3}if(b.City||b.State||b.Province||b.Zip){c+="<br />"}if(b.City){c+=b.City}if(b.State){c+=", "+b.State}else{if(b.Province){c+=", "+b.Province}}if(this.trim(b.Zip)){c+=" "+this.trim(b.Zip)}if(b.Country&&b.Country!=="United States"){c+="<br />"+b.Country}}if(c.substring(0,2)===", "){c=c.slice(2)}if(c.substring(0,6)==="<br />"){c=c.slice(6)}return c},getUrlParams:function(){var k=window.location.href,b=k.split("?")[0],f=k.split("?")[1],d={},h="",e,c,j,g;if(f===undefined){return{base:b}}if(f.length>0){e=f.split("&");for(c=0;c<e.length;c++){j=e[c].split("=");d[j[0]]=j[1]}}for(g in d){if(d.hasOwnProperty(g)){h+="&"+g+"="+d[g]}}return{base:b,querystring:h,params:d}},getUrlParam:function(c){var b=a.Tools.getUrlParams();return(b&&b.params)?b.params[c]:undefined},ticksToDate:function(b){return new Date((b-6.21355968e+17)/10000)},arrayMove:function(b,e,d){while(e<0){e+=b.length}while(d<0){d+=b.length}if(d>=b.length){var c=d-b.length;while((c--)+1){b.push(undefined)}}b.splice(d,0,b.splice(e,1)[0]);return b},stringReplaceAll:function(d,b){var c=new RegExp(Object.keys(b).join("|"),"gi");return d.replace(c,function(e){return b[e]})},filenameToId:function(b){return b.replace(" ","")},photonForAvatar:function(b){var c="resize=200,200";if(b){c=b+"&resize=200,200"}return c},photonForAvatarMedium:function(b){var c="resize=100,100";if(b){c=b+"&resize=100,100"}return c},photonForThumbnail:function(b){var c="resize=75,75";if(b){c=b+"&resize=75,75"}return c}};a.FileTools={_fileTypes:null,getFileTypes:function(){if(a.FileTools._fileTypes){return a.FileTools._fileTypes}var b,c;b=Bbc.extend({model:Bbm,url:function(){return aP+"datadirect/GetValidFileTypes/?format=json"}});c=new b();c.fetch({async:false,success:function(){a.FileTools._fileTypes=c.toJSON()},error:function(){p3.displayError("Error loading filetypes")}});return a.FileTools._fileTypes},getFileType:function(c){var b=a.FileTools.getFileExtension(c),d=a.FileTools.getFileTypes();return _.find(d,function(e){return e.Extension.toLowerCase()==="."+b.toLowerCase()})},getFileExtension:function(b){return b.split(".").pop()},isValidFile:function(e,c){var f=false,b,d;e=e||p3.Us.Enum.UploadType.All;if(e.ValidExtensions){f=e.ValidExtensions.test(c.toLowerCase())}if(f){b=a.FileTools.getFileExtension(c);d=a.FileTools.getFileTypes();f=_.any(d,function(g){return g.Extension.toLowerCase()==="."+b.toLowerCase()})}return f},validateFiles:function(e,b){var d=[],c,f;for(c=0;c<b.files.length;c++){f=p3.Us.FileTools.isValidFile(e,b.files[c].name);if(!f){d.push(b.files[c].name)}}if(d.length>0){return(p3.Us.FileTools.invalidFilesMessage(d))}return null},invalidFilesMessage:function(c){if(!c){return null}var d,b;if(c.length===1){d="The file "+c[0]+" is not a supported type and was not uploaded."}else{d="The files ";for(b=0;b<c.length;b++){if(b===c.length-1){d+="and "+c[b]}else{d+=c[b]+", "}}d+=" are not supported types and were not uploaded."}return'<div class="alert alert-error"><button type="button" class="close btn" data-dismiss="alert">x</button>'+d+"</div>"}}}(p3.Us));$.fn.fitText=function(b,c){var a=b||1,d=$.extend({minFontSize:Number.NEGATIVE_INFINITY,maxFontSize:Number.POSITIVE_INFINITY},c);return this.each(function(){var e=$(this),f;f=function(){e.css("font-size","");e.css("font-size",Math.max(Math.min(e.width()/(a*10),parseFloat(d.maxFontSize)),parseFloat(d.minFontSize)))};f();$(window).on("resize.fittext orientationchange.fittext",f)})};(function(b){p3.Us.Validate=b;var a=p3.Us.Culture;b.isEmpty=function(c){return(!c||0===c.length)};b.isEmptier=function(c){return($.trim(c).length===0)};b.requiredIndicator=function(){return'<span class="required-indicator" rel="tooltip" data-content="" data-original-title="Required">*</span>'};b.CustomPatterns={Numeric:"^(\\d|-)?(\\d|,)*\\.?\\d*$",NumericPositive:"^(\\d|,)*\\.?\\d*$",Integer:"^[0-9][0-9]{0,9}$",URL:/^\/|(^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$)/i};b.isDate=function(c){return a.isDate(c)}}(p3.module("utilities/validate")));(function(a){a._streamExtension={fetchCount:0,lastFetchDate:null,_streamOptions:{},_paused:false,stream:function(c){if(!c){c={}}if(!c.globalStream){c.routeRestrictValue=Bb.history.getFragment()}this._streamOptions=c;this.unstream();if(!c.globalStream){$(document).on("idle.idleTimer",$.proxy(this.pause,this)).on("active.idleTimer",$.proxy(this.unpause,this))}var b=_.bind(function(){var d=true;if(!c.globalStream){if(c.routeRestrictValue!==Bb.history.getFragment()){d=false;this.unstream()}}if(c.delay){d=false;this._intervalFetch=window.setTimeout(b,c.delay);c.delay=null}if(d){if(!this._paused){this.fetchCount++;this.fetch(c);this.lastFetchDate=new Date()}this._intervalFetch=window.setTimeout(b,c.interval||1000)}},this);b()},restart:function(b){this._streamOptions.delay=b;this.stream(this._streamOptions)},unstream:function(){window.clearTimeout(this._intervalFetch);delete this._intervalFetch;$(document).off("idle.idleTimer",$.proxy(this.pause,this)).off("active.idleTimer",$.proxy(this.unpause,this))},pause:function(){this._paused=true},unpause:function(){this._paused=false},isStreaming:function(){return _.isUndefined(this._intervalFetch)}};a.Ms.Stream=Bbm.extend(a._streamExtension);a.Cs.Stream=Bbc.extend(a._streamExtension);a.DataParamSync=function(b,c,d){if(b.toLowerCase()!=="read"){d.url=c.url();if(!_.isEmpty(d.dataParam)){var e=(d.url.indexOf("?")>-1)?"&":"?";d.url+=e+$.param(d.dataParam)}}Bb.sync(b,c,d)}}(p3.module("shared/base")));(function(a){var b=p3.Us;a.Ms.SchoolLogo=Bbm.extend({idAttribute:"LogoId",urlRoot:"Logo/edit",validation:{ShortDescription:[{required:true,msg:p3.Us.InfoMessageLibrary.P3.RequiredInfoNotEntered,fn:function(){$(".modal-footer BUTTON").button("reset")}}]}});a.Cs.SchoolLogos=Bbc.extend({model:a.Ms.SchoolLogo,url:function(){return aP+"logo/list/"}});a.Ms.SchoolStyle=Bbm.extend({validation:{LogoNavUrl:[{required:false,pattern:"url",msg:p3.Us.InfoMessageLibrary.P3.UrlError}],IosLogoShortName:[{required:false,maxLength:12,msg:p3.Us.InfoMessageLibrary.P3.MaxLengthExceeded}],"Options.0.Value":[{required:false,msg:"Entered value is not a valid hex color.",fn:"validColor"}],"Options.1.Value":[{required:false,msg:"Entered value is not a valid hex color.",fn:"validColor"}]},url:function(){return aP+"style/webappset?format=json"},validColor:function(c){if(!b.Validate.isEmptier(c)){if(!/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(c)){return"Entered value is not a valid hex color."}}}});a.Ms.SchoolStyleGet=Bbm.extend({url:function(){return aP+"style/webappget"}});a.Ms.SchoolColorsGet=Bbm.extend({url:function(){return aP+"webapp/getschoolcolors"}});a.Ms.SchoolCss=Bbm.extend({url:function(){return""},getSaveOptions:function(){var d=[],c=this.get("Colors");if(c){_.each(c,function(e){if(e.Key==="pri-100"||e.Key==="sec-100"){d=d.concat(e)}})}return d}});a.Vs.Layout=Bb.View.extend({template:"style/style.webapp.template.html",events:{"click .addLogo":"addLogo","mouseover .inline-edit":"inlineEditOver","mouseout .inline-edit":"inlineEditOut","click .inline-edit":"toggleInlineEdit","blur .inline-edit .schoolUrl input":"updateUrl","keyup .inline-edit .schoolUrl input":"updateCharCount",renderdata:"renderData"},dispose:function(){p3.Data.SchoolCss.initColors(p3.Data.SchoolContext.get("Style"))},initialize:function(){var c=this;c.styleModel=new a.Ms.SchoolStyleGet();c.model=new a.Ms.SchoolStyle();Bb.Validation.bind(this,{forceUpdate:true,selector:"name"})},render:function(c){var d=this;d.on("renderdata",function(){d.renderData()});p3.setTitle("Web App Style");$(c).append(d.el);d.renderData()},renderData:function(){var c=this;c.styleModel.fetch({success:function(){p3.fT(c.template,function(d){c.$el.html(d({model:c.styleModel.toJSON(),css:p3.Data.SchoolCss.toJSON(),imagePath:p3.Config.FtpImagePath+"logo/"}));_.each(c.styleModel.attributes.Options,function(e,f){p3.rV(new a.Vs.ColorBlock({styleOptionsModel:e,layoutView:c,index:f}),c.$("#color-holder"),false)})})}})},addLogo:function(d){var g=this,f=new a.Cs.SchoolLogos(),e=new a.Ms.SchoolLogo(),c=$(d.currentTarget).data("addtype");d.preventDefault();d.stopPropagation();e.bind("sync",g.renderData,g);f.fetch({cache:true,success:function(h){p3.showModal(p3.Layout.Containers.Modal,{backOnHide:false});p3.rV(new a.Vs.Modal({template:"style/style.logo.edit.template.html",addType:c,model:e,collection:h,styleModel:g.styleModel,layoutView:g}),p3.Layout.Containers.Modal,true)}})},inlineEditOver:function(c){c.stopPropagation();c.preventDefault();$(c.currentTarget).find("i").show()},inlineEditOut:function(c){c.stopPropagation();c.preventDefault();$(c.currentTarget).find("i").hide()},toggleInlineEdit:function(c){var d=$(c.currentTarget);c.stopPropagation();c.preventDefault();if(!d.find(".schoolUrl").hasClass("hide")){d.find(".schoolUrl input").blur()}else{d.find(".display").hide();d.find(".schoolUrl").show().attr("style","display: block !important");d.find(".schoolUrl input").focus();d.find(".schoolUrl input").siblings("p").find(".characterCounter").html(d.find(".schoolUrl input").val().length)}},updateCharCount:function(c){var d=this;c.stopPropagation();c.preventDefault();if(c.which===13){d.updateUrl(c)}else{d.$(c.currentTarget).siblings("p").find(".characterCounter").html($(c.currentTarget).val().length);if($(c.currentTarget).val().length>12){d.$(c.currentTarget).siblings("p").find(".characterCounter").addClass("badge-important")}else{d.$(c.currentTarget).siblings("p").find(".characterCounter").removeClass("badge-important")}}},closeInlineEdit:function(c){var d=$(c.currentTarget);c.stopPropagation();c.preventDefault();d.parentsUntil("inline-edit").find(".display").show();d.parentsUntil("inline-edit").find(".schoolUrl").hide()},updateUrl:function(e){var i=this,g=$(e.currentTarget).val(),c=$(e.currentTarget),d='<i class="p3icon-edit pull-right hide"></i>',f,h;if(c.hasClass("navurl")){f="Logo URL";h="LogoNavUrl"}else{if(c.hasClass("shortname")){f="Homescreen Icon Short Name";h="IosLogoShortName"}}i.model.set(i.styleModel.attributes);if((h==="LogoNavUrl"&&i.styleModel.attributes.LogoNavUrl!==g)||(h==="IosLogoShortName"&&i.styleModel.attributes.IosLogoShortName!==g)){if(g===""){p3.showConfirmCancel("Delete "+f,"Are you sure you want to delete the "+f,null,function(){i.model.set(h,g);i.model.save({},{success:function(){p3.displaySiteMessage(f+" has been updated.","alert-success");$(e.currentTarget).parent().siblings(".display").html(g+d);i.closeInlineEdit(e);p3.Data.SchoolContext.fetch();i.styleModel.set(h,g)},error:function(){p3.displayError("Error saving "+f)}})},function(){$(e.currentTarget).val($(e.currentTarget).parent().siblings(".display").text());i.closeInlineEdit(e)})}else{i.model.set(h,g);if(i.model.isValid(true)){i.model.save({},{success:function(){p3.displaySiteMessage(f+" has been updated.","alert-success");$(e.currentTarget).parent().siblings(".display").html(g+d);i.closeInlineEdit(e);p3.Data.SchoolContext.fetch();i.styleModel.set(h,g)},error:function(){p3.displayError("Error saving "+f)}})}else{$(e.currentTarget).focus()}}}else{i.closeInlineEdit(e)}}});a.Vs.ColorBlock=Bb.View.extend({template:"style/style.app.color.template.html",className:"span4 col-md-4",events:{"keyup .color-picker":"changeColors","input .color-picker":"changeColors","blur .color-picker":"hideColorbox","change .color-picker":"showSaveCancel","paste .color-picker":"showSaveCancel","click .cancel":"cancelChanges","click .save":"saveChanges"},dispose:function(){$(".colorpicker").remove()},initialize:function(){var c=this;c.styleOptionsModel=c.options.styleOptionsModel;c.model=new a.Ms.SchoolStyle(c.options.layoutView.styleModel.attributes);_.bindAll(this,"initializeColorPicker");c.model.defaults=$.extend(true,{},c.model.attributes);Bb.Validation.bind(c,{forceUpdate:true,selector:"name"});this.updateColors=_.debounce(function(){var d=c.model.get("Options"),e=_.findWhere(d,{Key:"pri-100"}),f=_.findWhere(d,{Key:"sec-100"});new a.Ms.SchoolColorsGet().fetch({data:{primaryColor:e?e.Value:null,secondaryColor:f?f.Value:null}}).done(function(g){p3.Data.SchoolCss.set({Colors:g},{silent:true});p3.Data.SchoolCss.trigger("reset")})},1000)},render:function(c){var d=this;$(c).append(d.el);d.renderData()},renderData:function(){var c=this;if(c.styleOptionsModel.Value===null){if(c.styleOptionsModel.Key==="pri-100"){c.styleOptionsModel.Value=p3.Data.SchoolCss.get("Colors")[0].Value}else{if(c.styleOptionsModel.Key==="sec-100"){c.styleOptionsModel.Value=p3.Data.SchoolCss.get("Colors")[5].Value}}}p3.fT(c.template,function(d){c.$el.html(d({model:c.styleOptionsModel,index:c.options.index}));p3.Us.PluginManager.Load(p3.Us.PluginManager.Plugins.ColorPicker,c.initializeColorPicker)})},changeColors:function(){var h=this,e,f,c=$('[name="Options.'+h.options.index+'.Value"]').val(),g=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(c),d=h.model.get("Options");if(g){if(h.options.index===0){e=c;f=p3.Data.SchoolCss.attributes.Colors[5].Value}else{if(h.options.index===1){e=p3.Data.SchoolCss.attributes.Colors[0].Value;f=c}}this.setOption(d,"pri-100",e);this.setOption(d,"sec-100",f);this.updateColors()}},setOption:function(e,c,f){var d=_.findWhere(e,{Key:c});if(d){d.Value=f}else{e.push({Key:c,Value:f})}},updateForm:function(){var c=p3.Data.SchoolCss.get("Colors");if(c){_.each(c,function(d){$("#"+d.Key).val(d.Value)})}},saveChanges:function(c){var d=this;if(d.model.isValid(true)){d.model.save({},{success:function(){p3.displaySiteMessage("Changes saved successfully.","alert-success");p3.Data.SchoolContext.fetch();d.$(".save-cancel").hide()},error:function(){p3.displayError("Error saving color.");d.$(".save-cancel").hide()}})}},cancelChanges:function(){var f=this,c=f.model.get("Options"),d,e;if(f.options.index===0){d=p3.Data.SchoolContext.attributes.Colors[0].Value;c[0].Value=d;f.model.set("Options",c);$('[name="Options.'+f.options.index+'.Value"]').val(d)}else{if(f.options.index===1){e=p3.Data.SchoolContext.attributes.Colors[5].Value;c[1].Value=e;f.model.set("Options",c);$('[name="Options.'+f.options.index+'.Value"]').val(e)}}this.updateColors();f.model.isValid(true);f.$(".save-cancel").hide()},showSaveCancel:function(){this.$(".color-picker").ColorPickerShow();this.$(".save-cancel").show();this.changeColors()},hideColorbox:function(){this.$(".color-picker").ColorPickerHide()},initializeColorPicker:function(){var d=this,c=d.$(".color-picker");d.$(".color-picker").ColorPicker({onChange:function(f,e,g){c.val("#"+e);d.changeColors();d.showSaveCancel()},onBeforeShow:function(){c.ColorPickerSetColor(c.val())}})}});a.Vs.Modal=Bb.View.extend({initialize:function(){var c=this;c.model.defaults=$.extend(true,{},c.model.attributes);c.selector=(c.options.selector)||"name";Bb.Validation.bind(c,{forceUpdate:true,selector:c.selector})},events:{"click button.cancel":"cancelModel","click button.save":"savePath","click .logoGroup .btn":"selectLogo"},render:function(c){var d=this;$(c).append(d.el);p3.Us.PluginManager.Load(p3.Us.PluginManager.Plugins.jQueryUI,function(){p3.Us.PluginManager.Load(p3.Us.PluginManager.Plugins.FileUpload,d.initializeFileUpload,d)});d.renderData()},renderData:function(){var c=this;p3.fT(c.options.template,function(e){var d={};d.addType=c.options.addType;d.model=c.model.toJSON();d.collection=c.options.collection.toJSON();d.layoutView=c.options.layoutView;d.dictionaries=c.options.dictionaries;d.variables=c.options.variables;d.options=c.options;d.imagePath=p3.Config.FtpImagePath+"logo/";d.canDrag=!window.head.browser.ie;d.editMode=false;c.$el.html(e(d));c.setFocus();$(".required-indicator").tooltip()})},initializeFileUpload:function(d){var c;window.setTimeout(function(){if(d.options.addType==="Favicon"){c=p3.Us.Enum.UploadType.FAVICON}else{c=p3.Us.Enum.UploadType.JPGPNG}$("#fileupload").fileupload({url:p3.Config.RootPath+"utilities/FileTransferHandler.ashx",autoUpload:true,acceptFileTypes:c.ValidExtensions,dropZone:".dragRegion",add:function(g,f){var h=p3.Us.FileTools.isValidFile(c,f.files[0].name);if(h){f.submit()}else{d.$el.find("#invalid_filetype").append(p3.Us.FileTools.validateFiles(c,f))}}}).bind("fileuploaddone",function(g,f){d.showUploadedFile(f)})},100)},showUploadedFile:function(c){if(this.$el.find(".alert-error").length>0){this.$el.find(".alert-error").remove()}this.$el.find(".uploaded-file-region img").attr("src","/ftpimages/pdTemp/"+c.result[0].name);this.$el.find("#UploadedFile").attr("data-img-val",c.result[0].name);this.$el.find(".uploaded-file-region").show();this.$el.find("#UploadedFile").val(c.files[0].name);$(".logoGroup .btn").removeClass("active");this.uploadFile=true;window.setTimeout(function(){p3.setModalHeight(p3.Layout.Containers.Modal)},100)},savePath:function(){var e=this,d,c;if(e.uploadFile){e.saveUpload()}else{d=new a.Ms.SchoolStyle(e.options.styleModel.attributes);c=$(".logo-select.active").data("id");e.updateStyle(d,c)}},saveUpload:function(){var g=this,c,f=this.$el.find("#UploadedFile").attr("data-img-val"),e,d;g.model.set({ShortDescription:g.$el.find("#ShortDescription").val(),Type:"image/pjpe",FileName:g.$el.find("#UploadedFile").val(),DefaultLogo:false,DefaultSeal:false,BannerInd:1,UploadedFile:f});if(g.options.addType==="Banner Logo"){g.model.set({BannerInd:1,Type:"image/pjpe"})}else{if(g.options.addType==="Favicon"){g.model.set({Type:"image/x-icon",FaviconInd:1})}else{g.model.set({Type:"image/pjpe",IosLogoInd:1})}}if(f===undefined){if($(".modal-body").find(".alert-error").length===0){p3.Us.InfoMessage.ErrorBox("Please select a file.",".modal-body",false);p3.setModalHeight(p3.Layout.Containers.Modal)}g.$(".save").button("reset")}else{if(g.$el.find("#UploadedFile").val()===""){if($(".modal-body").find(".alert-error").length===0){c=g.$el.find("#UploadedFile");c.closest("div.control-group").addClass("error");c.addClass("box-validate");p3.Us.InfoMessage.ErrorBox("Please enter a file name.",".modal-body",false);p3.setModalHeight(p3.Layout.Containers.Modal)}g.$(".save").button("reset")}else{if(g.model.isValid(true)){g.model.save({},{success:function(h){if(h.get("LogoId")===0){if(!g.options.editMode){g.model.clear({silent:true})}if($(".modal-body").find(".alert-error").length===0){p3.Us.InfoMessage.ErrorBox("The file name for this image has already be used for one previously uploaded. Change the file name in order to upload this image.",".modal-body",false);p3.setModalHeight(p3.Layout.Containers.Modal);g.$(".save").button("reset")}}else{e=new a.Ms.SchoolStyle(g.options.styleModel.attributes);d=h.get("LogoId");g.updateStyle(e,d)}},error:function(){p3.displayError("Error saving logo.");g.$(".save").button("reset")}})}else{g.$(".save").button("reset")}}}},selectLogo:function(c){c.preventDefault();$(".logoGroup .btn").removeClass("active");$(c.currentTarget).addClass("active")},cancelModel:function(){this.model.set(this.model.defaults)},updateStyle:function(d,c){var e=this;if(e.options.addType==="Banner Logo"){d.set("LogoId",c)}else{if(e.options.addType==="Homescreen Icon"){d.set("IosLogoId",c)}else{if(e.options.addType==="Favicon"){d.set("FaviconId",c)}}}d.save({},{success:function(){$("#site-modal").modal("hide");p3.displaySiteMessage("Changes saved successfully.","alert-success");p3.Data.SchoolContext.fetch();e.options.layoutView.trigger("renderdata")},error:function(){p3.displayError("Error saving logos.");e.$(".save").button("reset")}})},setFocus:function(){$("form:first *:input[type!=hidden]:first").focus()}});a.Vs.SchoolCss=Bb.View.extend({template:"style/style.schoolcss.template.html",render:function(c){var d=this;p3.fT(d.template,function(f){var e={};_.each(p3.Data.SchoolCss.get("Colors"),function(g){e[g.Key]=g.Value});d.$el.html(f({css:p3.Data.SchoolCss.toJSON(),colorData:e}));$(c).append(d.el)})}});p3.router().route("style","style",function(){p3.renderMainPage(new a.Vs.Layout())})}(p3.module("system/shared/style")));(function(a){var k=p3.module("shared/task"),d=p3.Us.Enum,b=p3.module("shared/base"),g=p3.module("officialNote"),j=p3.module("system/shared/style"),e=p3.module("LMS/shared/GroupFinder"),h=p3.module("shared/peoplefinder"),i=p3.module("cms/site"),c=p3.module("cms/shared/content"),f=p3.module("shared/npi/npi"),l=p3.Us.Tools;a.Ms.SchoolContext=Bbm.extend({url:"webapp/schoolcontext/",getSchoolId:function(){var m=this.get("SchoolInfo");if(m){return m.SchoolId}return 0},getPhotonUrl:function(){var o=this.get("CdnUrls"),m,n="";m=_.findWhere(o,{DefaultInd:true});if(m!==undefined){n=m.Url}return n},getLibrariesUrl:function(){var o=this.get("CdnUrls"),m,n="";m=_.findWhere(o,{FilePathTypeId:13});if(m!==undefined){n=m.Url}return n},getLabelDictionary:function(){return this.get("LabelDictionary")},getSmallCollegeIndicator:function(){var m=this.get("SchoolInfo");return m.IsSmallCollege},hasAppCategory:function(n){var m=this.get("AppCategories");if(m){return _.any(m,function(o){return o.CategoryId===n.Value})}return false}});a.Ms.LoginLocation=Bbm.extend({url:function(){return aP+"LoginLocation?format=json"}});a.Ms.Context=Bbm.extend({url:"webapp/context/",forceRefresh:function(m){m=m||{};p3.Data.Context.fetch({data:{forceRefresh:true},success:function(n){if(_.isFunction(m.success)){return m.success(n)}},complete:function(n){if(_.isFunction(m.complete)){return m.complete(n)}},error:function(n){if(_.isFunction(m.error)){return m.error(n)}}})},getAllPortals:function(){var n,o=false,p,q,m;n=this.get("Tasks");p=_.filter(n,function(r){return(r.TaskTypeId===3&&r.UserId===0)});q=_.filter(n,function(r){return(r.TaskTypeId===3&&r.UserId!==0)});if(p3.Data.SchoolContext.get("SchoolInfo")){o=p3.Data.SchoolContext.get("SchoolInfo").PortalMyBeforeSchool}if(o){m=_.union(q,p)}else{m=_.union(p,q)}return m},getMasterPages:function(){var m,n;m=this.get("Tasks");n=_.filter(m,function(o){return(o.NavLocation===3&&o.TaskTypeId!==3)});return n},getAccountTasks:function(){var n,m,o,p;n=this.get("Tasks");o=new k.Ms.Task({TaskId:-2,Description:"Sign Out",Url:p3.Config.RootPath+"SignOut"});n.push(o.toJSON());if(this.get("IsImpersonating")){p=new k.Ms.Task({TaskId:-3,Description:'<i class="p3icon-delete"></i> Stop Impersonating',Url:"#"});n.push(p.toJSON())}this.set("Tasks",n,false);m=_.filter(n,function(q){return(q.TaskId===226||q.TaskId===53017||q.TaskId===52656||q.TaskId===-2||q.TaskId===-3||q.TaskId===37||q.TaskId===53206||q.TaskId===53066)});_.each(m,function(q){if(q.TaskId===52656){q.Target="_blank"}if(q.TaskId===226){q.Args=p3.Data.Context.get("UserInfo").UserId+"/contactcard"}q.IsGlobal=true});return m},getActivityStreamTasks:function(){var m=[],r,n,o,p,q;r=this.findByTaskId(53179);if(r){m.push(r)}n=this.findByTaskId(53174);if(n&&p3.Data.SchoolContext.hasAppCategory(p3.Us.Enum.AppCategories.ATHLETICGROUPS)){n.Description="Athletics";m.push(n)}o=this.findByTaskRef("Calendar:View:0");if(o){o.Description="Calendar";m.push(o)}p=this.findByTaskRef("MediaPage:View:0");if(p){p.Description="Galleries";m.push(p)}q=this.findByTaskId(52302);if(q){m.push(q)}return m},getTasksForRole:function(o){var m,n=[];m=this.get("Tasks");n=_.filter(m,function(p){if(p.Roles!=null&&p.Roles.length>0&&p.Roles.indexOf(o.toString())>-1){var q=p.Roles.toString().split(",");return($.inArray(o.toString(),q)>-1)}return false});return n},getTasksForPersona:function(o){var m,n=[];if(o){m=this.get("Tasks");n=_.filter(m,function(p){if(p.Personas!=null&&p.Personas.length>0){var q=p.Personas.toString().split(",");return($.inArray(o.toString(),q)>-1)}return false})}return n},getManagerNavForPersona:function(n){var o=this.getTasksForPersona(n),m=[];if(o){m=_.filter(o,function(p){return((p.NavLocation===1||p.NavLocation===3)&&p.L1GroupId!=null&&(!p.L1PersonaId||p.L1PersonaId===n))})}return m},getPrivatePages:function(){var m=this.get("Tasks"),o=[],p,n;if(m){o=_.filter(m,function(q){return(q.TaskTypeId===2&&q.Personas!=="99")})}n=this.findByTaskRef("Groups:View:0");if(n){n.Description="Group Finder";o.unshift(n)}p=this.findByTaskRef("MediaPage:View:0");if(p){o.unshift(p)}return o},getSelectedPersona:function(){var m=this.get("Personas"),n;n=_.find(m,function(o){return o.Selected==true});if(!n){n=_.first(m)}return n},isWhUser:function(){var m=this.get("Personas");return _.any(m,function(n){return n.Id===10})},getCurrentTask:function(){var r=this.get("Tasks"),m,n,o,p,q;if(location.hash){n=location.hash;p=_.filter(r,function(s){return s.HashString&&s.HashString.length>0});n=n.replace("#/","#");m=_.find(p,function(s){return s.HashString==n});if(!m){o=n.split("/")[0].split(":")[0].split("(")[0];m=_.find(p,function(s){if(s.HashString.indexOf(":")>-1){return n.indexOf(s.HashString.split(":")[0].split("(")[0])===0&&s.HashString.indexOf(o)===0}})}}else{q=p3.Us.Tools.getQuerystringValue("t");m=_.find(r,function(s){return s.TaskId==q})}return m},getCurrentNavTask:function(){var o,n,m;if(p3.Config.TopTaskId&&p3.Config.TopTaskId>0){o=_.filter(this.get("Tasks"),function(p){return p.TaskId===p3.Config.TopTaskId});if(o.length>1){m=p3.Data.Context.getSelectedPersona().Id;n=_.find(o,function(p){return p.L1PersonaId===m})}else{if(o.length===1){n=o[0]}}return n}return this.getCurrentTask()},findByTaskRef:function(m){var n=this.get("Tasks");return _.find(n,function(o){return o.TaskRef===m})},findByTaskId:function(m){var n=this.get("Tasks");return _.find(n,function(o){return o.TaskId===m})},findByHashString:function(m){var n=this.get("Tasks");return _.find(n,function(o){return o.HashString===m})}});a.Ms.UserStatus=b.Ms.Stream.extend({url:"webapp/userstatus/"});a.Ms.Persona=Bbm.extend({idAttribute:"Id",url:function(){return""},toJSON:function(){var m=Bbm.prototype.toJSON.call(this);m.HasImage=this.HasImage();m.ImageUrl=this.ImageUrl();return m},HasImage:function(){return(this.get("Image")!=null&&this.get("Image")!="")},ImageUrl:function(){if(this.HasImage()){return p3.Config.CssImagePath+this.get("Image")}return""}});a.Ms.NavItem=Bbm.extend({url:function(){return""},defaults:{SubNav:null,LongDescription:"",Image:"",Args:"",Icon:"",ShowBadge:false,BadgeCount:0},toJSON:function(){var m=Bbm.prototype.toJSON.call(this);m.Label=this.Label();m.ItemCssClass=this.ItemCssClass();m.LinkCssClass=this.LinkCssClass();m.HasImage=this.HasImage();return m},Label:function(){var m=p3.Data.SchoolContext.get("SchoolInfo").PortalDisplayLabel;if(this.get("TaskTypeId")==3&&m){return m}return this.get("Description")},HasSubNav:function(){return(this.get("SubNav")!=null&&this.get("SubNav")!="")},HasSubNavView:function(){return(this.get("SubNavView")!==undefined&&this.get("SubNavView")!=null&&this.get("SubNavView")!="")},HasImage:function(){return(this.get("Image")!=null&&this.get("Image")!="")},ItemCssClass:function(){var m="";if(this.get("LongDescription")!=null&&this.get("LongDescription")!=""){m+="twoline"}else{m+="oneline"}if(this.HasSubNav()||this.HasSubNavView()){if(m.length>0){m+=" "}m+="parentitem"}return m},LinkCssClass:function(){var m="";if(this.get("LinkCssClass")!=null&&this.get("LinkCssClass")!=""){m=this.get("LinkCssClass")}if(this.HasSubNav()){m+="subnavtrigger"}if(this.get("IsSearch")){m+="subnavtrigger"}return m}});a.Ms.StopImpersonate=Bbm.extend({url:function(){return aP+"/Security/ImpersonateStop?format=json"}});a.Cs.UserDirectories=Bbc.extend({url:"/Directory/List/"});a.Cs.Personas=Bbc.extend({model:a.Ms.Persona,url:function(){return""}});a.Cs.NavItems=Bbc.extend({model:a.Ms.NavItem,url:function(){return""}});a.Vs.Layout=Bb.View.extend({template:"app/app.layout.template.html",initialize:function(){this.Containers={};p3.Data.SchoolContext=new a.Ms.SchoolContext();p3.Data.SchoolContext.bind("reset change",this.renderSchoolContext,this);p3.Data.Context=new a.Ms.Context();p3.Data.Context.bind("reset change",this.renderContext,this)},render:function(m){var n=this;$(m).html(n.el);p3.fT(n.template,function(o){n.$el.html(o({model:p3.Data.Context}));n.setContainers();n.loadSchoolContext();$("html").on("click",function(p){a.Us.closeAllNav()})})},setContainers:function(){var m=this;m.Containers.Message=$("#site-message");m.Containers.PageHeader=$("#site-main-header");m.Containers.PageSubHeader=$("#site-main-subheader");m.Containers.MainPage=$("#site-main");m.Containers.MainPageHeader=$("#app-page-header");m.Containers.MainPageMenu=$("#app-page-menu");m.Containers.Header=$("#site-header");m.Containers.Logo=$("#site-logo");m.Containers.UserNav=$("#site-user-nav");m.Containers.Switcher=$("#site-switcher");m.Containers.TopNav=$("#site-nav");m.Containers.LowerNav=$("#site-nav-lower");m.Containers.Footer=$("#site-footer");m.Containers.FooterNav=$("#site-footer-nav");m.Containers.FooterInfo=$("#site-footer-info");m.Containers.Modal=$("#site-modal");m.Containers.SiteTopSpacer=$("#site-top-spacer");m.Containers.HeaderContainer=$("#site-header-container");m.Containers.TopNavContainer=$("#site-nav-container");m.Containers.SidebarFixed=$("#site-sidebar-fixed");m.Containers.FooterFixed=$("#site-footer-fixed");m.Containers.EmergencyBulletin=$("#emergency-bulletin");m.Containers.MainBulletin=$("#main-bulletin");m.Containers.SidebarTabLeft=$("#site-sidebar-tab-left");m.Containers.MobileMenu=$("#site-mobile-menu");m.Containers.MobileMenuSwitcher=$("#site-mobile-switcher");m.Containers.MobileMenuUserNav=$("#site-mobile-usernav");m.Containers.MobileMenuSiteNav=$("#site-mobile-sitenav")},loadSchoolContext:function(){var m=this;p3.Data.SchoolContext.fetch({cache:false,success:function(){p3.trigger("schoolContextLoaded");p3.setConfigPlaceholders();m.loadStyle();m.loadContext()},error:function(n){p3.displayError("Error loading context.")}})},renderSchoolContext:function(){var n=this,q=p3.Data.SchoolContext.get("SchoolInfo"),r=p3.Data.SchoolContext.get("Style"),o,m=true;function p(t){if(!t&&r&&r.Logo&&r.Logo.length>0){n.Containers.Logo.addClass("logoimg");o='<img src="'+r.Logo+'"/>';m=false}else{if(q){o=q.SchoolName}}if(r.LogoNavUrl){n.Containers.Logo.html('<a href="'+r.LogoNavUrl+'" class="white-fgc">'+o+"</a>")}else{n.Containers.Logo.html(o)}}function s(){if(m){n.Containers.Logo.fitText(1.5,{minFontSize:"12px",maxFontSize:"28px"})}}p(false);s();$(".logoimg a img").error(function(){m=true;p(true);s()})},loadContext:function(){p3.Data.Context.fetch({cache:false,success:function(m){p3.trigger("contextLoaded");if(p3.Config.AppMode!==p3.Us.Enum.AppModes.PODIUM){Bb.history.start()}p3.trigger("initComplete")},error:function(m){p3.displayError("Error loading context.")}})},renderContext:function(){p3.rV(new a.Vs.PersonaSwitcher(),this.Containers.Switcher,true);p3.rV(new a.Vs.UserNav(),this.Containers.UserNav,true);p3.rV(new a.Vs.SiteNav(),this.Containers.TopNav,true);a.Us.renderPageHeader()},loadStyle:function(){p3.Data.SchoolCss=new j.Ms.SchoolCss({Colors:p3.Data.SchoolContext.get("Colors")});p3.Data.SchoolCss.bind("reset",this.renderStyle,this);this.renderStyle()},renderStyle:function(){p3.rV(new j.Vs.SchoolCss(),"#app-style",true)}});a.Vs.LayoutEmbed=Bb.View.extend({template:"app/app.layout.embed.template.html",initialize:function(){this.Containers={};p3.Data.SchoolContext=new a.Ms.SchoolContext();p3.Data.Context=new a.Ms.Context()},render:function(m){var n=this;$(m).html(n.el);p3.fT(n.template,function(o){n.$el.html(o({model:p3.Data.Context}));n.setContainers();n.loadSchoolContext()})},setContainers:function(){var m=this;m.Containers.Message=$("#site-message");m.Containers.PageHeader=$("#site-main-header");m.Containers.MainPage=$("#site-main");m.Containers.MainPageHeader=$("#app-page-header");m.Containers.MainPageMenu=$("#app-page-menu");m.Containers.Header=$("#site-header");m.Containers.Logo=$("#site-logo");m.Containers.UserNav=$("#site-user-nav");m.Containers.Switcher=$("#site-switcher");m.Containers.TopNav=$("#site-nav");m.Containers.LowerNav=$("#site-nav-lower");m.Containers.Footer=$("#site-footer");m.Containers.FooterNav=$("#site-footer-nav");m.Containers.FooterInfo=$("#site-footer-info");m.Containers.Modal=$("#site-modal");m.Containers.SiteTopSpacer=$("#site-top-spacer");m.Containers.HeaderContainer=$("#site-header-container");m.Containers.TopNavContainer=$("#site-nav-container");m.Containers.SidebarFixed=$("#site-sidebar-fixed");m.Containers.FooterFixed=$("#site-footer-fixed");m.Containers.EmergencyBulletin=$("#emergency-bulletin");m.Containers.MainBulletin=$("#main-bulletin");m.Containers.SidebarTabLeft=$("#site-sidebar-tab-left");m.Containers.MobileMenu=$("#site-mobile-menu");m.Containers.MobileMenuSwitcher=$("#site-mobile-switcher");m.Containers.MobileMenuUserNav=$("#site-mobile-usernav");m.Containers.MobileMenuSiteNav=$("#site-mobile-sitenav")},loadSchoolContext:function(){var m=this;p3.Data.SchoolContext.fetch({cache:false,success:function(){p3.trigger("schoolContextLoaded");p3.setConfigPlaceholders();m.loadStyle();m.loadContext()},error:function(n){p3.displayError("Error loading context.")}})},loadContext:function(){p3.Data.Context.fetch({cache:false,success:function(m){p3.trigger("contextLoaded");Bb.history.start();p3.trigger("initComplete")},error:function(m){p3.displayError("Error loading context.")}})},loadStyle:function(){p3.Data.SchoolCss=new j.Ms.SchoolCss({Colors:p3.Data.SchoolContext.get("Colors")});p3.Data.SchoolCss.bind("reset",this.renderStyle,this);this.renderStyle()},renderStyle:function(){p3.rV(new j.Vs.SchoolCss(),"#app-style",true)}});a.Vs.PersonaSwitcher=Bb.View.extend({template:"app/app.switcher.template.html",id:"site-switcher-container",mobileTemplate:"app/app.switcher.mobile.template.html",events:{"click #site-switcher-button":"showMenu",renderPersona:"renderData"},initialize:function(){_.bindAll(this,"showMenu")},render:function(m){var n=this;$(m).append(n.el);n.renderData()},renderData:function(m){var p=this,o=new a.Cs.Personas(p3.Data.Context.get("Personas")).toJSON(),n=(o.length>1);n=true;p3.fT(p.template,function(s){p.$el.html(s({personas:o,multiPersona:n,rootPath:p3.Config.RootPath}));p.$el.find("ul li:first-child").addClass("first");p.$el.find("ul li:last-child").addClass("last");var r=p.$el.find("A[data-type=1]"),q=p.$el.find("A[data-type=2]");r.addClass("persona");q.addClass("app");if(r.length>0&&q.length>0){r.filter(":last").parent().after('<li class="sep gray-bgc-ultradark"><!-- --></li>')}p3.Layout.Containers.SwitcherLabel=$(".site-switcher-label");p.selectPersona()});p3.fT(p.mobileTemplate,function(q){p3.Layout.Containers.MobileMenuSwitcher.html(q({personas:o,multiPersona:n,rootPath:p3.Config.RootPath}));p3.Layout.Containers.SwitcherLabel=$(".site-switcher-label");p.selectPersona();a.Us.renderUserInfo()});if(o.length<=1){p3.Layout.Containers.Switcher.hide()}},showMenu:function(){var n=p3.Layout.Containers.Switcher.find("LI"),m;if(n.length>1){m=p3.Layout.Containers.Switcher.find("DIV");a.Us.closeAllNav();m.show().addClass("nav-visible")}return false},hideMenu:function(){var m=p3.Layout.Containers.Switcher.find("UL");m.hide().removeClass("nav-visible");return false},selectPersona:function(){var m=p3.Data.Context.getSelectedPersona();if(m){p3.Layout.Containers.SwitcherLabel.text(m.LongDescription);p3.Layout.Containers.Switcher.find("A.selected").removeClass("selected");p3.Layout.Containers.Switcher.find("A[data-id="+m.Id+"]").addClass("selected");p3.trigger("personaSelected",_.clone(m))}}});a.Vs.UserNav=Bb.View.extend({template:"app/app.nav.template.html",mobileTemplate:"app/app.nav.mobile.template.html",events:{"click A.subnavtrigger":"showSubNav"},render:function(m){var q=this,o=q.getNavData().toJSON(),p=p3.Data.Context.get("UserParam"),n=p?p.HasHelpAccess:false;$(m).append(q.el);p3.fT(q.template,function(t){q.$el.html(t({items:o,linkCssClass:"white-fgc-hover",subNavCssClass:"pri-75-bordercolor white-bgc gray-nav-boxshadow",subNavLinkCssClass:"pri-75-bgc-hover black-fgc white-fgc-hover",hasHelpAccess:n}));q.$el.find("ul li:first-child").addClass("first");q.$el.find("ul li:last-child").addClass("last");q.$el.find('a[href*="SignOut"]').attr("data-bypass","1");p3.fT(q.mobileTemplate,function(u){if(o.length>0&&o[0].IsSearch){o.push(o.shift())}p3.Layout.Containers.MobileMenuUserNav.html(u({items:o,hasHelpAccess:n}));q.initSearch();a.trigger("contextRendered")});var r=p3.Data.Context.findByTaskId(53048),s=p3.Data.Context.findByTaskId(53181);if(r||s){g.Us.updateInboxCount()}})},getNavData:function(){var p=p3.Data.Context,v=p.get("InboxSettings"),y=new a.Cs.NavItems(),n=p.getAccountTasks(),A=p.findByTaskId(52830),z,o,x,m,t,B,q,w,r,u,s;if(A){A.Description="Search";A.Icon="p3icon-search";A.IsSearch=true;y.add(new a.Ms.NavItem(A))}if(v&&v.GoogleAccessGranted&&p3.Data.Context.findByTaskId(52981)){s={Args:"gmail",Description:v.GoogleLabel||"Gmail",ShowBadge:false,BadgeClass:"badge-important site-badge-off p3icon-mail",DividerBefore:true,Target:"__new",ExternalHref:v.GoogleUrl};y.add(new a.Ms.NavItem(s))}z=p.findByTaskId(53048);o=p.findByTaskId(53181);if(z){z.Args="officialnotes";z.Description="Official Notes";z.ShowBadge=true;z.BadgeClass="badge-important site-badge-off site-badge-official-notes";z.IsGlobal=true;y.add(new a.Ms.NavItem(z))}else{if(o){o.Args="admofficialnotes";o.Description="Official Notes";o.ShowBadge=true;o.BadgeClass="badge-important site-badge-off site-badge-official-notes";o.IsGlobal=true;y.add(new a.Ms.NavItem(o))}}x=p.findByTaskId(52981);if(x&&p3.Data.SchoolContext.get("SchoolInfo").IndividualMessageEnabled){x.Args="inbox";x.Description="Messages";x.ShowBadge=true;x.BadgeClass="badge-important site-badge-message site-badge-off";x.HtmlId="inbox-link";x.IsGlobal=true;y.add(new a.Ms.NavItem(x))}m=new a.Ms.NavItem({TaskId:-1,Description:"Account",Image:p3.Config.CssImagePath+"userprofile25x25.png",IsUserPhoto:true,HtmlId:"account-nav"});y.add(m);t=p.findByTaskId(10130);if(t){B={ApplicationId:23,CustomAction:0,Description:"Training Resources",DividerBefore:false,DividerGroup:3,Target:"_blank",TaskId:-100,ExternalHref:"https://www.blackbaud.com/files/support/helpfiles/education/k12/full-help/Content/Home.html",IsHelp:true};n.push(B)}if(n&&n.length>0){q=n;w=1;_.each(q,function(C){switch(C.TaskId){case (226):C.HtmlId="profile-link";C.DividerGroup=1;C.SortValue=10;C.Description="Profile";break;case (53206):C.DividerGroup=1;C.SortValue=11;C.Description="Files & Forms";break;case (53017):C.HtmlId="settings-link";C.DividerGroup=1;C.SortValue=12;C.Args="login";C.Description="Settings";break;case (53066):C.HtmlId="tour-link";C.DividerGroup=3;C.SortValue=10;C.HiddenMobile=true;break;case (-2):C.DividerGroup=4;C.SortValue=90;break;case (37):C.DividerGroup=2;C.SortValue=40;break;case (-3):C.DividerGroup=2;C.SortValue=50;C.ClassName="site-impersonate-stop";break;case (-100):C.TaskId=false;C.DividerGroup=3;C.SortValue=50;break;default:C.DividerGroup=3;C.SortValue=80;break}});r=new a.Cs.NavItems(q);r.comparator=function(C){return(C.get("DividerGroup")*100)+C.get("SortValue")};r.sort();u=0;r.each(function(C){if(C.get("DividerGroup")!==w){if(u>0){C.set("DividerBefore",true)}w=C.get("DividerGroup")}u++});m.set("SubNav",r.toJSON())}return y},showSubNav:function(n){var m=$(n.currentTarget);a.Us.closeAllNav();m.addClass("clicked");m.next().show().addClass("nav-visible");m.next().next().show().addClass("nav-visible");return false},hideSubNav:function(m){a.Us.closeAllNav();return false},initSearch:function(){var n=this,m=$(".site-search-input");m.off();m.on("click",function(o){n.searchInputClick(o)});m.on("keyup",function(o){n.searchInputKeyUp(o)});m.on("keydown",function(o){n.searchInputKeyDown(o)})},searchInputClick:function(m){m.preventDefault();m.stopPropagation();return false},searchInputKeyDown:function(n){var m=n.which;if(m===13){n.preventDefault();n.stopPropagation();return false}},searchInputKeyUp:function(o){o.preventDefault();var n=o.which,m=$(o.currentTarget),p=m.val();if(n===13&&p&&p.length>0){if(p3.Config.AppMode!==p3.Us.Enum.AppModes.WEBAPP){window.location.href=k.Us.getPersonaAppPath()+"#searchresults/summary/"+encodeURIComponent(p)+"/true"}else{p3.router().navigate("#searchresults/summary/"+encodeURIComponent(p)+"/true",true)}}return false},hideSearch:function(o){var n=$(o),m=$("#site-search-input");m.off("keyup");m.fadeOut("fast",function(){n.show()});return false}});a.Vs.HeaderTextOnly=Bb.View.extend({template:"page/sky/header-text.template.html",render:function(m){var n=this;$(m).append(n.el);p3.fT(n.template,function(p){var o=n.options;n.$el.html(p({Title:o.title,SubTitle:o.subTitle}))})}});a.Vs.SiteNav=Bb.View.extend({template:"app/app.nav.template.html",id:"topnav-containter",mobileTemplate:"app/app.nav.mobile.template.html",events:{"mouseover A.subnavtrigger":"showSubNav","click A.subnavtrigger":"showSubNav","mouseleave li.parentitem":"hideSubNav",renderSiteNav:"renderData"},render:function(m){var n=this;$(m).append(n.el);n.renderData()},renderData:function(){var r=this,q=p3.Data.Context.getSelectedPersona(),p,m=new Date(),o=p3.Us.DataLibrary.MonthNames[m.getMonth()].substring(0,3).toUpperCase(),n=m.getDate().toString();if(q){if(q&&q.IsApp){p=a.Us.getManagerNavData(q.Id)}else{p=a.Us.getPersonaNavData(q.Id)}}else{p=new a.Cs.NavItems()}if(p3.Data.SchoolContext.getSmallCollegeIndicator()){a.Us.alterNavigationForSmallCollege(p)}p3.fT(r.template,function(s){r.$el.html(s({items:p,linkCssClass:"black-fgc",titleCssClass:"pri-100-fgc",subNavCssClass:"sec-75-bordercolor white-bgc",subNavLinkCssClass:"sec-25-bgc-hover",subNavTitleCssClass:"black-fgc",month:o,day:n}));a.Us.setActiveNav();r.$el.find("ul li:first-child").addClass("first");r.$el.find("ul li:last-child").addClass("last");$(".topnav li a img").error(function(){var t=$(this);if(!t.hasClass("imgerr")){t.attr("src",p3.Config.CssImagePath+"userprofile.png").addClass("imgerr")}});$(window).on("resize.sitenav",function(){$("DIV.nav-offset").removeClass("nav-offset").css({left:""})});p3.fT(r.mobileTemplate,function(t){p3.Layout.Containers.MobileMenuSiteNav.html(t({items:_.filter(p,function(u){return !u.HiddenMobile}),month:o,day:n}));a.trigger("siteNavRendered")})})},showSubNav:function(p){var o=$(p.currentTarget),n=o.next(),m=o.next().next(),q;n.show().addClass("nav-visible");m.show().addClass("nav-visible");if(!m.hasClass("nav-offset")){q=$("body").width()-(m.offset().left+m.outerWidth());if(q<0){m.css({left:(q-5)+"px"}).addClass("nav-offset")}}o.next().show().addClass("nav-visible");o.next().next().show().addClass("nav-visible");m.trigger("show");return false},hideSubNav:function(n){var m=$(n.currentTarget),o=$(n.target).attr("id");if(m.find(".group-finder-ch").length>0&&o&&o!=="GroupFinderContainer"){return false}if(m.find(".people-finder-ch").length>0&&o&&o!=="PeopleFinderContainer"){return false}a.Us.closeAllNav();return false}});a.Vs.PageHeader=Bb.View.extend({template:"app/app.pageheader.template.html",render:function(m){var n=this;$(m).append(n.el);n.renderTemplate()},renderTemplate:function(){var m=this;p3.fT(m.template,function(o){var n=m.getViewData();if(n){m.$el.html(o(m.getViewData()));if(m.$el.find("div.subnavbar li").length===1){m.$el.find("div.subnavbar").hide()}}else{$("HTML.site-mode-podium #app").css({height:"auto","min-height":"auto"});m.$el.empty()}a.Us.setActiveNav()})},getViewData:function(){var q,n=p3.Data.Context,o=n.getSelectedPersona(),p=n.getCurrentNavTask(),m=o?n.getManagerNavForPersona(o.Id):[];if(o&&o.IsApp&&p){q={};q.Title=p.L2Group;q.SubNav=_.unique(_.filter(m,function(r){return r.L1GroupId==p.L1GroupId&&r.L2GroupId==p.L2GroupId}),false,function(r){return r.Description});if(q.SubNav.length<=1){q=null}}return q}});a.Vs.Error=Bb.View.extend({className:"alert",render:function(m){this.$el.html(this.options.message).addClass(this.options.messageClass);$(m).append(this.el).fadeIn(1000).delay(3000).fadeOut(1000)}});a.Vs.Confirm=Bb.View.extend({template:"app/app.confirm.template.html",events:{"click #btnConfirm":"doConfirm","click #btnCancel":"doCancel"},render:function(m){var n=this;$(m).append(this.el);p3.fT(n.template,function(o){n.$el.html(o({confirmationTitle:n.options.ConfirmationTitle,confirmationText:n.options.ConfirmationText,confirmLoadingText:n.options.ConfirmLoadingText||"Working...",confirmButtonText:n.options.ConfirmButtonText||"Confirm"}));n.trigger("render")})},doConfirm:function(m){var n=this;n.closeModal(m,n.options.ConfirmCallback)},doCancel:function(m){var n=this;n.closeModal(m,n.options.CancelCallback)},closeModal:function(n,m){var o=this;n.preventDefault();if(!o.options.KeepOpen){if(o.options.ContainerToHide){o.options.ContainerToHide.modal("hide")}else{p3.Layout.Containers.Modal.modal("hide")}if(o.options.ContainerToHide!==p3.Layout.Containers.Modal){$(".modal-backdrop").css("z-index","1100")}}if(_.isFunction(m)){m.call()}}});a.Vs.Messagebox=Bb.View.extend({template:"app/app.messagebox.template.html",events:{"click #btnClose":"doClose"},render:function(m){var n=this;$(m).append(this.el);p3.fT(n.template,function(o){n.$el.html(o({messageTitle:n.options.MessageTitle,messageText:n.options.MessageText,alertClass:n.options.AlertClass,buttonText:n.options.ButtonText}));n.trigger("render")})},doClose:function(m){var n=this;m.preventDefault();if(!n.options.KeepOpen){if(n.options.ContainerToHide){n.options.ContainerToHide.modal("hide")}else{p3.Layout.Containers.Modal.modal("hide")}}if(_.isFunction(n.options.CloseCallback)){n.options.CloseCallback.call()}return false}});a.Us.closeAllNav=function(){$(".nav-visible").hide().removeClass("nav-visible").css({display:""});var m=$("#site-nav");if(!m.hasClass("active")){m.removeClass("box-inset-light")}$(".subnavtrigger").removeClass("clicked")};a.Us.setActiveNav=function(){if(p3.Data.Context){var s=$(".topnav"),r=p3.Layout.Containers.PageHeader,p=p3.Data.Context.getCurrentNavTask(),q,m,n,o;if(location.hash.indexOf("message/inbox")>-1){q=52981}else{if(location.hash.indexOf("message/officialnotes")>-1){q=53048}else{if(location.hash.toLowerCase().indexOf("#studentlists")>-1){if(location.pathname.toLowerCase().indexOf("/core")>-1){q=53531}else{if(location.pathname.toLowerCase().indexOf("/oncampus")>-1){q=53536}else{if(location.pathname.toLowerCase().indexOf("/onrecord")>-1){q=53537}}}}else{if(p){q=p.TaskId}else{if(location.hash.indexOf("academicclass")>-1){q=-1}else{q=-99}}}}}if(r&&r.find("UL").length>0){r.find("LI.active").removeClass("active");m=r.find('A[data-taskid="'+q+'"]');if(m.length>0){m.closest("LI").addClass("active")}q=r.find("A:first").data("taskid")}if(s){if(s.find("UL").length>0){a.Us.selectNavItem(s,q)}else{window.setTimeout(function(){if(s.find("UL").length>0){a.Us.selectNavItem(s,q)}},500)}}if(Bb.history.fragment){switch("#"+Bb.history.fragment.split("/")[0]){case k.Us.getUrlById(53211,""):case k.Us.getUrlById(53407,""):case k.Us.getUrlById(53424,""):case k.Us.getUrlById(12187,""):case k.Us.getUrlById(53103,""):case k.Us.getUrlById(23060,""):case k.Us.getUrlById(53101,""):case k.Us.getUrlById(23062,""):case k.Us.getUrlById(53603,""):case k.Us.getUrlById(12198,""):case k.Us.getUrlById(53459,""):case k.Us.getUrlById(53485,""):case k.Us.getUrlById(53519,""):case k.Us.getUrlById(53520,""):case k.Us.getUrlById(53622,""):case k.Us.getUrlById(53627,""):case k.Us.getUrlById(53628,""):break;default:p3.setSessionState("SMLoadMenu",false)}}n=p3.getSessionState("AdmWorkList");if(n&&n.length>0&&Bb.history.fragment){o=("#"+Bb.history.fragment.toString()).split("/")[0];if(!(o&&o==k.Us.getUrlById(52246,""))){if(!n[0]){n[0]=Date.parse(new Date().toString());p3.setSessionState("AdmWorkList",n)}}}}};a.Us.selectNavItem=function(p,r){var m=p.find('A[data-taskid="'+r+'"]'),o,n,q;if(m.length>0){o=$("UL.topnav");if(m.length===1){o.find("A.active").removeClass("active").removeClass("box-inset-light");m.addClass("active");n=m.closest("DIV.subnav");if(n.length>0){n.siblings("A.subnavtrigger").addClass("active")}}else{if(m.length>0&&(r==226)){o.find("A.active").removeClass("active");o.find('A[href="'+location.hash+'"]').addClass("active");n=m.closest("DIV.subnav");if(n.length>0){n.siblings("A.subnavtrigger").addClass("active")}}else{o.find("A.active").removeClass("active");m.closest("DIV.subnav").siblings("A.subnavtrigger").addClass("active");q=(window.location.hash.length>0)?window.location.hash:window.location.pathname+window.location.search;o.find('A[href="'+q+'"]').addClass("active")}}}};a.Us.renderPageHeader=function(){p3.rV(new a.Vs.PageHeader(),p3.Layout.Containers.PageHeader,true)};a.Us.renderUserInfo=function(){var q=p3.Data.Context.get("MasterUserInfo"),s=p3.Data.Context.get("UserInfo"),r,p,u,t,m,n;function o(w){try{return $("<div/>").text(w).html()}catch(v){return w}}if(q){r=o(q.FirstName)+"<sep>"+o(q.LastName);p=p3.Data.Context.get("IsImpersonating");if(p&&s){t=o(s.FirstName)+"<sep>"+o(s.LastName)}else{t=r}if(s.ProfilePhoto&&s.ProfilePhoto.LargeFilenameUrl){u=p3.Config.PhotonForUserPhotoUrl+s.ProfilePhoto.LargeFilename+"?"+l.photonForThumbnail(s.ProfilePhoto.PhotoEditSettings)}else{u=p3.Config.CssImagePath+"userprofile25x25.png"}m=$("#account-nav");if(m.length>0){$("#site-profile").removeClass("black-40alpha-bgc").addClass("black-30alpha-bgc");$("#site-switcher-change").removeClass("black-50alpha-bgc").addClass("black-30alpha-bgc");m.find(".title").html(t.replace("<sep>","<br>"));m.find("img:first").attr("src",u)}n=$("#mobile-account-nav");if(n.length>0){n.find(".title").html(t.replace("<sep>"," "));n.find("img:first").attr("src",u)}if(p){$("#site-mobile-impersonate").show();$("#site-mobile-impersonate-name").html(t.replace("<sep>"," "))}else{$("#site-mobile-impersonate").hide()}$(".site-impersonate-stop").click(function(v){a.Us.stopImpersonate(v)});$(".mobile-site-impersonate-stop").click(function(v){a.Us.stopImpersonate(v)})}};a.Us.loadDefaultRoute=function(){var q=p3.Layout.Containers.TopNav,n,o=p3.Data.Context.getSelectedPersona(),m,p;if(o){if(o.StartingPageId){m=q.find('A[data-spid="'+o.StartingPageId+'"]');if(m.length>0&&m.attr("href").length>1){n=m.attr("href");if(n){p3.router().navigate(n,true);return}}}if(o.Id==1||o.Id==11||o.Id==12){n="#activitystream"}else{q.find('A[href^="#"]').each(function(){var r=$(this).attr("href");if(r.length>1){n=r;return false}})}if(n){if(o.Id==3){if(n.indexOf("schedule-performance")==-1&&n.indexOf("candidateview")==-1){n="#activitystream"}}if(o.Id==2){p=false;if((p3.Data.SchoolContext.hasAppCategory(p3.Us.Enum.AppCategories.SCHEDULE))||(p3.Data.SchoolContext.hasAppCategory(p3.Us.Enum.AppCategories.GRADING))){p=true}if((!p)&&n.indexOf("candidateview")==-1){n="#activitystream"}}p3.router().navigate(n,true)}}};a.Us.stopImpersonate=function(m){m.preventDefault();var n=new a.Ms.StopImpersonate();n.fetch({success:function(o){p3.transferHome()},error:function(){p3.displayError("Error stopping impersonation.")}});if(f){f.logout()}};a.Us.initMobileMenu=function(){var q=$("#site-mobile-btn"),n=$("#site-mobile-menu"),p=$(".app-mobile-pusher"),o=n.find("a"),m=n.find(".app-mobile-back"),v,s,r,u,t;v=function(){var w=$(document).height();n.addClass("open").css({left:"0px",height:w+"px"});p.addClass("app-mobile-pushed");t()};s=function(){r();n.removeClass("open").css({left:"-300px"});p.removeClass("app-mobile-pushed")};r=function(){n.find(".app-mobile-level.open").css({left:"-300px"}).removeClass("open")};u=function(w){w.css({left:"0px"}).addClass("open");t()};t=function(){$("html, body").animate({scrollTop:n.offset().top},200)};q.on("click",function(w){v()});$("body").on("click touchstart",function(x){var w=$(x.target);if(!w.hasClass("app-mobile-menu")&&w.parents(".app-mobile-menu").length===0&&w.parents(".app-mobile-menu-btn").length===0){s()}});o.on("click",function(x){var w=$(this);if(w.next().hasClass("app-mobile-level")){x.preventDefault();x.stopPropagation();r();u(w.next());return false}s()});m.on("click",function(w){r()})};a.Us.setMultiColItems=function(n){if(n){var m=11;n.each(function(s){if(s.has("SubNav")){var q=false,r=s.get("SubNav"),o=1,p=1;_.each(r,function(t){var u=Math.ceil(p/m);t.Col=u;if(u!==o){t.NewCol=true;q=true;o=u}else{t.NewCol=false}p++;if(t.DividerLabel){p++}});s.set({SubNavMultiCol:q},{silent:true})}})}};a.Us.getPersonaNavData=function(u){var m=p3.Data.Context,r=new a.Cs.NavItems(),q,x,o,n,v,w,p,t,s,y=(p3.Config.useNavIcon);if(u){if(u==2||u==3){q=m.findByTaskRef("MyDay:View:"+u);if(q){x=(u==2)?a.Us.GetStudentMyDaySubNav():a.Us.GetFacultyMyDaySubNav();if(x&&x.length>0){o=x[0];n=(o.HashString)?o.HashString.split("/")[1]:null;if(x.length==1&&n=="resource-board"){q.Description=o.Label;if(y){q.Image=p3.Config.CssImagePath+"l1ResourceBoard.png"}}else{q.DayIcon=y;q.SubNav=x}q.Args=n;r.add(new a.Ms.NavItem(q))}}if(u==2&&p3.Data.SchoolContext.hasAppCategory(p3.Us.Enum.AppCategories.ADMISSIONS)){if(m.findByTaskId(53071)){r.add(new a.Ms.NavItem({TaskId:53071,Description:"My Application",LongDescription:"",Image:y?p3.Config.CssImagePath+"48x48/process.png":null,Args:p3.Data.Context.attributes.UserInfo.UserId+"/progress",HtmlId:"me-label",SubNav:null}))}}}if(u==1){(function(){var B=m.get("Children"),C=new a.Cs.NavItems(),D=m.findByTaskId(226),z=m.findByTaskId(53071),A;if(B.length>0){A=_.groupBy(B,function(E){return E.Id+E.FirstName});_.each(A,function(E){_.each(E,function(G){var F={Description:G.NickName||G.FirstName,LongDescription:"",Image:(y&&G.LargeFilename)?p3.Config.PhotonForUserPhotoUrl+G.LargeFilename:null,IsUserPhoto:true,Args:G.Id+"/progress",SubNav:null,HtmlId:"children-subnav"};switch(G.ParentRoleId){case"17":case"14":case"22":case"562":if(D){F.TaskId=D.TaskId;C.add(new a.Ms.NavItem(F))}break;case"554":if(z){F.TaskId=z.TaskId;C.add(new a.Ms.NavItem(F))}break;default:break}})});if(C.length>0){if(C.length==1){r.add(C.at(0))}else{r.add(new a.Ms.NavItem({TaskId:-4,Description:y?"Children":'Children <span class="black-fgc">'+C.length+"</span>",Image:y?p3.Config.CssImagePath+"48x48/children.png":null,SubNav:C.toJSON(),LongDescription:y?"<b>"+C.length+"</b> Children":null,HtmlId:"children-subnav"}))}}}}())}if((u===12)&&(p3.Data.Context.get("AlumHasRegistration"))){v=m.findByTaskId(53296);if(v){r.add(new a.Ms.NavItem({TaskId:v.TaskId,Description:"Progress",LongDescription:"",Image:y?p3.Config.CssImagePath+"l1Progress1.png":null,Args:"",SubNav:null,SPId:3}))}}if(u===1||u===2||u===3||u===11||u===12){(function(){var z=m.get("Groups"),A=[{Index:"1",Label:"Classes",Image:y?"48x48/classes_48.png":null,MyGroupsLabel:"<b>View Other Classes</b>",Associations:[{Id:1,Label:"Classes",DisplayLabel:false,CurrentOnly:true}],AssocCount:0,GroupCount:0},{Index:"2",Label:"Groups",Image:y?"48x48/groups.png":null,MyGroupsLabel:'<b><i class="p3icon-search"></i> Find More</b>',Associations:[{Id:2,Label:"Teams",DisplayLabel:true,CurrentOnly:false},{Id:9,Label:"Advisory",DisplayLabel:true,CurrentOnly:true},{Id:7,Label:"Dorms",DisplayLabel:true,CurrentOnly:true},{Id:0,Label:"Other",DisplayLabel:"multiOnly",CurrentOnly:true}],AssocCount:0,GroupCount:0}],B=m.findByTaskRef("MyGroups:View:0");_.each(A,function(D){var E=new a.Cs.NavItems(),C=null;_.each(D.Associations,function(F){var G=[];_.each(z,function(J){var H=false,L=false,K=m.findByTaskRef("Association:View:"+J.Association),I;if(K){J.Task=K;H=(J.Association===F.Id||(F.Id===0&&((J.Association===8||J.Association===3)||J.Association===5||J.Association===4||J.Association===10)));if(J.Association===8||J.Association===3||J.Association===5||J.Association===4||J.Association===10||J.Association===2){L=true}else{if(u===3){L=J.IsOwner}else{L=!J.IsOwner}}if(H&&L&&(!F.CurrentOnly||(F.CurrentOnly&&J.CurrentEnrollment))){I=_.find(G,function(M){return M.LeadSectionId===J.LeadSectionId});if(!I){G.push(J)}}}});if(G.length>0){D.AssocCount+=1;D.GroupCount+=G.length;G[0].DividerLabel=F.Label;_.each(G,function(I,K){var H="",J;if(I.Task.HashString){H=I.CurrentSectionId;switch(I.Association){case 1:H+="/0/bulletinboard";break;case 2:H+="/teampage";break;case 9:case 3:case 7:H+="/bulletinboard";break;case 8:H+="/bulletinboard";break}}else{H="glt=1&pk="+I.CurrentSectionId}J=I.GroupName;if(I.SectionBlock&&I.SectionBlock.length>0&&I.SectionBlock!="Random"){J+=" ("+I.SectionBlock+")"}E.add(new a.Ms.NavItem({TaskId:I.Task.TaskId,Description:J,Args:H,ClassName:"group-page-link-"+F.Id,DividerLabel:((F.DisplayLabel=="multiOnly"&&D.AssocCount>1)||F.DisplayLabel==true)?I.DividerLabel:null}))})}});if(B){C=new a.Ms.NavItem({TaskId:B.TaskId,Description:D.MyGroupsLabel})}if(E.length>0){r.add(new a.Ms.NavItem({TaskId:-D.Index,Description:y?D.Label:D.Label+' <span class="black-fgc">'+D.GroupCount+"</span>",LongDescription:y?"<b>"+D.GroupCount+"</b> "+D.Label:null,Image:y?p3.Config.CssImagePath+D.Image:null,SubNav:E?E.toJSON():null,SubNavFooter:C?C.toJSON():null,HtmlId:"group-header-"+D.Label}))}})}())}w=m.findByTaskId(53128);if(w){p=new a.Ms.NavItem({TaskId:w.TaskId,Description:"Resources",LongDescription:"",Image:y?p3.Config.CssImagePath+"48x48/resources.png":null,Args:"",SubNav:null,SPId:1,HtmlId:"group-header-Resources"});r.push(p)}t=a.Us.GetNewsSubNav();if(t&&t.length>0){s=new a.Ms.NavItem({TaskId:-5,Description:"News",LongDescription:"",Image:y?p3.Config.CssImagePath+"48x48/news.png":null,Args:"",SubNav:t,HtmlId:"group-header-News"});r.add(s)}(function(){var A,z;A=m.findByTaskId(53259);if(A){z=new a.Ms.NavItem({TaskId:A.TaskId,Description:"Calendar",LongDescription:"",Image:y?p3.Config.CssImagePath+"48x48/calendar.png":null,Args:"",SubNav:null,SPId:9,HtmlId:"calendar-subnav"});r.push(z)}}());(function(){var z=m.get("Directories"),B=m.findByTaskRef("Directory:View:1"),D=m.findByTaskRef("Directory:View:2"),A,C;if(z&&z.length>0&&B){A=new a.Cs.NavItems();_.each(z,function(F){var E={TaskId:B.TaskId,Description:F.DirectoryName,Args:(B.HashString)?F.DirectoryID:"did="+F.DirectoryID};A.add(new a.Ms.NavItem(E))});if(D){C={TaskId:D.TaskId,Description:D.Description,DividerBefore:true};A.add(new a.Ms.NavItem(C))}r.add(new a.Ms.NavItem({TaskId:-4,Description:y?"Directories":'Directories <span class="black-fgc">'+z.length+"</span>",Image:y?p3.Config.CssImagePath+"48x48/directory.png":null,SubNav:A.toJSON(),LongDescription:y?"<b>"+z.length+"</b> Directories":null,HtmlId:"directory-subnav"}))}}())}a.Us.setMultiColItems(r);return r.toJSON()};a.Us.getManagerNavData=function(w){var o=p3.Data.Context,p=o.getManagerNavForPersona(w),t,v,s,u,q,m,x,n,y,r,A,z=(p3.Config.useNavIcon);a._subView=[];t=_.groupBy(p,function(B){return B.L1Group});s=new a.Cs.NavItems();q=-1;m="";switch(w){case 7:q=53024;m="scheduling";break;case 5:q=53025;break;case 4:q=53026;break;case 6:q=53027;break;case 9:q=53108;break;case 10:q=53489;break;case 13:q=53397;break}x=new a.Ms.NavItem({TaskId:q,Description:"Dashboard",SubNav:null,L1GroupSort:-1,Args:m,Image:z?p3.Config.CssImagePath+"48x48/dashboard.png":null});if(w===13){u=new a.Cs.NavItems();u.comparator="Description";if(o.findByTaskId(q)){u.add(new a.Ms.NavItem({TaskId:q,Description:"Dashboard",Args:m}))}if(o.findByTaskId(53470)){u.add(new a.Ms.NavItem({TaskId:53470,Description:"Receivables",HashString:"#sb-receivables",Args:m}))}if(o.findByTaskId(53481)){u.add(new a.Ms.NavItem({TaskId:53481,Description:"Online payments",HashString:"#sb-online-payments-dashboard",Args:m}))}x.set("Description","Billing");x.set("SubNav",u.toJSON())}s.add(x);s.comparator=function(B){return B.get("L1GroupSort")};if(w===5&&o.findByTaskId(53192)){x=new a.Ms.NavItem({TaskId:-1,Description:"Group Finder",SubNav:null,L1GroupSort:-1,Args:m,Image:z?p3.Config.CssImagePath+"48x48/group pages.png":null,SubNavView:"GroupFinderContainer",LinkCssClass:"subnavtrigger",HiddenMobile:true});if(a._subView===undefined){a._subView=[]}a._subView.push({id:"GroupFinderContainer",view:e.Vs.Layout});s.add(x)}if(w===4){if(o.findByTaskId(53059)||o.findByTaskId(88)){x=new a.Ms.NavItem({TaskId:-1,Description:"Website",SubNav:null,L1GroupSort:-1,Args:m,Image:z?p3.Config.CssImagePath+"48x48/website.png":null,SubNavView:"WebsiteContainer",MobileSubNavView:"MobileWebsiteContainer",LinkCssClass:"subnavtrigger"});if(a._subView===undefined){a._subView=[]}a._subView.push({id:"WebsiteContainer",mobileId:"MobileWebsiteContainer",view:i.Vs.AppNav});s.add(x)}n=c.Us.getContentManageTasks(d.Associations.PAGECONTENT);y=_.filter(p3.Data.Context.get("Tasks"),function(B){return B.TaskId===53126});if((n&&n.length>0)||y.length>0){x=new a.Ms.NavItem({TaskId:-1,Description:"Content",SubNav:null,L1GroupSort:-1,Args:m,Image:z?p3.Config.CssImagePath+"48x48/content.png":null});u=new a.Cs.NavItems();_.each(n,function(B){var C=new a.Ms.NavItem({TaskId:B.TaskId,Description:B.Description,SubNav:null,Args:m});u.add(C)});if(y.length>0){r=y[0];u.add(new a.Ms.NavItem({TaskId:r.TaskId,Description:r.Description,SubNav:null,Args:"schedule/0/0",DividerBefore:true}))}x.set({SubNav:u.toJSON()});s.add(x)}}if((w===7&&o.findByTaskId(53254))||(w===6&&o.findByTaskId(53283))||(w===9&&o.findByTaskId(53414))||(w===13&&o.findByTaskId(53422))){x=new a.Ms.NavItem({TaskId:-1,Description:"People Finder",SubNav:null,L1GroupSort:-1,Args:m,Image:z?p3.Config.CssImagePath+"48x48/people.png":null,SubNavView:"PeopleFinderContainer",LinkCssClass:"subnavtrigger",HiddenMobile:true});if(a._subView===undefined){a._subView=[]}if(w===6){a._subView.push({id:"PeopleFinderContainer",view:h.Vs.Layout,viewOptions:{finderType:d.PeopleFinder.FinderType.ONRECORD,searchType:3}})}else{if(w===7){a._subView.push({id:"PeopleFinderContainer",view:h.Vs.Layout,viewOptions:{finderType:d.PeopleFinder.FinderType.ONBOARD,searchType:3,filterType:d.PeopleFinder.FilterType.ONBOARD}})}else{if(w===9){a._subView.push({id:"PeopleFinderContainer",view:h.Vs.Layout,viewOptions:{finderType:d.PeopleFinder.FinderType.SYSTEM,searchType:3}})}else{if(w===13){a._subView.push({id:"PeopleFinderContainer",view:h.Vs.Layout,viewOptions:{finderType:d.PeopleFinder.FinderType.ONACCOUNT,searchType:3}})}}}}s.add(x)}if(w===10){A=new a.Ms.NavItem({Description:"WH Console",SubNav:null,L1GroupSort:-1,Image:z?p3.Config.CssImagePath+"48x48/website.png":null,LinkCssClass:"black-fgc box-inset-light-hover",ExternalHref:"/podium/default.aspx?wh=1"});s.add(A);A=new a.Ms.NavItem({Description:"WH Demo Site",SubNav:null,L1GroupSort:-1,HashString:"#wh-demo-site-manager",Image:z?p3.Config.CssImagePath+"48x48/website.png":null,LinkCssClass:"black-fgc box-inset-light-hover"});s.add(A);A=new a.Ms.NavItem({Description:"Simple App EAP",SubNav:null,L1GroupSort:999,HashString:"#app-eap",Image:z?p3.Config.CssImagePath+"48x48/website.png":null,LinkCssClass:"black-fgc box-inset-light-hover"});s.add(A);A=new a.Ms.NavItem({Description:"Quicklogin (sky)",SubNav:null,L1GroupSort:999,ExternalHref:p3.Config.SkySPAUrl+"quicklogin",Image:z?p3.Config.CssImagePath+"48x48/website.png":null,LinkCssClass:"black-fgc box-inset-light-hover"});s.add(A)}_.each(t,function(J){var C=J[0].L1Group,F=false,G,K,H,B="",I,D,E,L;if(z){G="48x48/"+J[0].L1Group.toLowerCase().replace("users/","").replace("procedures","procedure")+".png"}else{G=null}K=new a.Ms.NavItem({TaskId:-1,Description:C,SubNav:null,L1GroupSort:J[0].L1GroupSort,Image:G?p3.Config.CssImagePath+G:null,HideDesktopText:F});v=_.groupBy(J,function(M){return M.L2Group});H=new a.Cs.NavItems();H.comparator=function(M){return M.get("L2GroupSort")};_.each(v,function(M){if((!(M[0].TaskId==52173&&p3.Data.SchoolContext.hasAppCategory(p3.Us.Enum.AppCategories.REENROLLMENT)))){switch(M[0].TaskId){case 53100:B="Events/today";break;default:B="";break}L=new a.Ms.NavItem({TaskId:M[0].TaskId,Description:M[0].L2Group,SubNav:null,L2GroupSort:M[0].L2GroupSort,Args:B,DividerBefore:M[0].DividerBefore});if(!(M[0].TaskId==23189&&M[0].L1GroupId>=27&&M[0].L1GroupId<=31)){H.add(L)}}});if(J[0].L1GroupId>=27&&J[0].L1GroupId<=31){I=p3.Data.Context.findByTaskId(53602);if(I!==undefined){D=(p3.Data.Context.findByTaskId(23189)!==undefined);E=((o.get("UserParam").ListPersonas||"").indexOf("|"+(w.toString()||"X")+"|"))>-1;if(D||E){L=new a.Ms.NavItem({TaskId:I.TaskId,Description:I.Description,SubNav:null,L2GroupSort:99999,Args:"",DividerBefore:false});H.add(L)}}}K.set({SubNav:H.toJSON()});s.add(K)});a.Us.setMultiColItems(s);return s.toJSON()};a.Us.GetStudentMyDaySubNav=function(m){var n=[];if(p3.Data.Context.findByTaskId(53212)){n.push({Label:"Progress",Icon:"p3icon-progress",Id:"progress-btn",HashString:"#studentmyday/progress",Active:m=="progress",SPId:3})}if(p3.Data.SchoolContext.hasAppCategory(p3.Us.Enum.AppCategories.SCHEDULE)){n.push({Label:"Schedule",Icon:"p3icon-schedule",Id:"schedule-btn",HashString:"#studentmyday/schedule",Active:m=="schedule",SPId:2})}if(p3.Data.SchoolContext.hasAppCategory(p3.Us.Enum.AppCategories.COURSEMANAGEMENT)){n.push({Label:"Assignment Center",Icon:"p3icon-assignments",Id:"assignment-center-btn",HashString:"#studentmyday/assignment-center",Active:m=="assignment-center",SPId:4})}if(p3.Data.Context.findByTaskId(23041)){n.push({Label:"Course Requests",Icon:"p3icon-courseRequest",Id:"course-requests-btn",HashString:"#studentmyday/course-requests",Active:m=="course-requests"})}if(p3.Data.Context.findByTaskId(53487)){n.push({Label:"Conduct",Icon:"p3icon-conduct",Id:"conduct-btn",HashString:(p3.Config.SkySPAUrl||"")+"/sis-conduct/student",Active:m=="conduct"})}return n};a.Us.GetFacultyMyDaySubNav=function(m){var n=[];if(p3.Data.Context.findByTaskId(53386)&&!p3.Data.Context.get("IsImpersonating")){n.push({Label:"Nurse's Office",Icon:"p3icon-medical",Id:"nurses-office-btn",HashString:"#myday/nurses-office",Active:m=="nurses-office",SPId:8})}if(p3.Data.SchoolContext.hasAppCategory(p3.Us.Enum.AppCategories.SCHEDULE)||p3.Data.SchoolContext.hasAppCategory(p3.Us.Enum.AppCategories.GRADING)){n.push({Label:"Schedule & Performance",Icon:"p3icon-schedule",Id:"schedule-btn",HashString:"#myday/schedule-performance",Active:m=="schedule-performance",SPId:7})}if((!p3.Data.SchoolContext.hasAppCategory(p3.Us.Enum.AppCategories.SCHEDULE)||!p3.Data.SchoolContext.hasAppCategory(p3.Us.Enum.AppCategories.GRADING))&&(p3.Data.SchoolContext.hasAppCategory(p3.Us.Enum.AppCategories.ATTENDANCELITE))&&p3.Data.SchoolContext.get("SchoolInfo").ShowAttendance===1){n.push({Label:"Schedule",Icon:"p3icon-schedule",Id:"schedule-btn",HashString:"#myday/schedule",Active:m=="schedule",SPId:2})}if(p3.Data.SchoolContext.hasAppCategory(p3.Us.Enum.AppCategories.COURSEMANAGEMENT)){n.push({Label:"Assignment Center",Icon:"p3icon-assignments",Id:"assignment-center-btn",HashString:"#myday/assignment-center",Active:m=="assignment-center",SPId:4})}if(p3.Data.Context.findByTaskId(53596)&&p3.Data.SchoolContext.hasAppCategory(p3.Us.Enum.AppCategories.ASSIGNMENTRUBRIC)){n.push({Label:"Rubrics",Icon:"rubic-my-day-icon",Id:"rubric-btn",HashString:"#myday/rubrics",Active:m=="rubrics",SPId:9})}return n};a.Us.GetNewsSubNav=function(o){var r=p3.Data.SchoolContext.get("SchoolInfo"),q=[],p,m,s,n;if(r.ShowFeaturedContent==1){p=p3.Data.Context.findByTaskId(53249);if(p){q.push({TaskId:p.TaskId,Label:"Featured Content",Icon:"p3icon-activity",Id:"featured-content",Active:o=="featured",SPId:6})}}if(r.ShowRecentActivity==1){m=p3.Data.Context.findByTaskId(53179);if(m){q.push({TaskId:m.TaskId,Label:"Recent Activity",Icon:"p3icon-timeline",Id:"recent-activity",Active:o=="activity",SPId:5})}}if(r.ShowScoreboard==1){s=p3.Data.Context.findByTaskId(53174);if(s){q.push({TaskId:s.TaskId,Label:"Scoreboard",Icon:"p3icon-scoreboard",Id:"scoreboard",Active:o=="scoreboard"})}}if(r.ShowArchivedContent==1){n=p3.Data.Context.findByTaskId(53250);if(n){q.push({TaskId:n.TaskId,Label:"Archived Content",Icon:"p3icon-files",Id:"archive-content",Args:"news",Active:o=="archive"})}}return q};a.Us.showMessageBox=function(r,q,m,n,o){var p=p3.Layout.Containers.Modal;m=(m||"alert-info");n=(n||"Cancel");p3.rV(new a.Vs.Messagebox({MessageTitle:r,MessageText:q,AlertClass:m,ButtonText:n,CloseCallback:o,ContainerToHide:p}),p,true);p3.showModal(p,null)};a.once("siteNavRendered",function(){if(p3.Config.AppMode===p3.Us.Enum.AppModes.WEBAPP&&(!location.hash||location.hash=="#login")){a.Us.loadDefaultRoute();if(p3.Data.Context.findByTaskId(53066)&&!$("#site-mobile-btn").is(":visible")&&p3.Data.Context.get("ShowGuidedTours")&&!p3.getSessionState("tourDisplayed")&&!p3.Data.Context.get("IsImpersonating")&&!p3.Data.Context.get("ShowUserHelpPanel")){p3.setSessionState("tourDisplayed",true);p3.router().navigate("#guidedtour",true)}}a.Us.renderSiteNavSubViews()});a.Us.renderSiteNavSubViews=function(){if(a._subView!==undefined&&a._subView.length>0){_.each(a._subView,function(m){if(typeof m.view==="function"){var n=_.extend({mobileId:m.mobileId},m.viewOptions);p3.rV(new m.view(n),$("#"+m.id),true)}})}window.setTimeout(function(){a.Us.initMobileMenu()},400)};a.Us.alterNavigationForSmallCollege=function(m){var o=null,n=null;o=_.findWhere(m,{Description:"School"});if(o!==undefined&&o.SubNav!==undefined&&o.SubNav!==undefined){n=_.findWhere(o.SubNav,{TaskId:718});if(n!==null){n.Label="Schools and Classifications"}}};a.once("contextRendered",function(){var m=parseInt(p3.Config.UserStatusInterval,10)||2;if(p3.Data.UserStatus){p3.Data.UserStatus.unstream()}p3.Data.UserStatus=new a.Ms.UserStatus();p3.Data.UserStatus.on("reset change",function(n){p3.trigger("userStatusUpdated",n)});p3.Data.UserStatus.fetch();p3.Data.UserStatus.stream({delay:60*1000*5,interval:60*1000*m,add:false,globalStream:true,cache:false});a.Us.renderUserInfo();p3.Us.HelpPanel.Load();p3.Us.TaskManagement.Load()});p3.on("route",function(){if(_.isFunction(a.Us.renderPageHeader)){a.Us.renderPageHeader()}else{if(_.isFunction(a.Us.setActiveNav)){a.Us.setActiveNav()}}})}(p3.module("app")));(function(g,b){var a=p3.module("app"),i=p3.module("system/shared/style"),e=p3.Us.InfoMessage,f=p3.Us.InfoMessageLibrary,j=p3.module("shared/task"),k=p3.module("utilities/validate"),c=p3.Us.Culture,d=p3.Us.Enum,h=$({});g.Data={BbidFlow:false,BbidSession:false,Linked:false,Linkable:false,RequiresBbid:false,BbidName:"",BbidEmailAddress:"",DomainList:"",AlternateDomainList:"",Disabled:false};g.Ms.BbidStatusById=Bbm.extend({url:function(){return aP+"Bbid/StatusById"}});g.Ms.BbidStatusByName=Bbm.extend({url:function(){return aP+"Bbid/StatusByName"}});g.Ms.Alert=Bbm.extend({});g.Ms.Authentication=Bbm.extend({url:function(){return aP+"SignIn"}});g.Ms.SignInRequest=Bbm.extend({url:function(){return aP+"SignInRequest"}});g.Ms.UpdatePasswordRequest=Bbm.extend({url:function(){return aP+"PasswordReset"}});g.Ms.SignInAction=Bbm.extend({url:function(){return aP+"SignInActionLog"}});g.Ms.UpdateExpPasswordRequest=Bbm.extend({url:function(){return aP+"PasswordExpUpdate"}});g.Ms.RememberRequest=Bbm.extend({url:function(){return aP+"RememberRequest"}});g.Ms.PasswordRules=Bbm.extend({url:function(){return aP+"Security/PasswordRules"},getRulesText:function(){if(_.isEmpty(this.toJSON())){return""}return"It must be at least "+this.get("p_length")+" characters long and include "+this.get("req_numbers")+" numbers.  Do not use a password the same as your "+this.get("reuse")+" previous passwords."}});g.Ms.CurrLoginInfo=Bbm.extend({});g.Ms.LoginLocation=Bbm.extend({url:function(){return aP+"LoginLocation"}});g.Ms.CustomMessage=Bbm.extend({defaults:{custMsgId:"0"},url:function(){return aP+"schoolinfo/GetCustomMessage/"+this.get("custMsgId")+"/"}});g.Ms.LoginSetup=Bbm.extend({url:function(){return aP+"OnlineApplication/CreateAcctSettings/"}});g.Ms.CreateAccount=Bbm.extend({validation:{CandidateFirstName:[{fn:"requiredCreateAccount"}],CandidateLastName:[{fn:"requiredCreateAccount"}],CandidateDOB:[{fn:function(q,m,n){var p=new Date(q),o=new Date(),l=$("#"+m).siblings(".p3Red");o.setFullYear(o.getFullYear()+1);if(k.isEmptier(q)){l.html(f.P3.RequiredInfoNotEntered).show();return f.P3.RequiredInfoNotEntered}if(!c.isDate(q)){l.html(f.P3.DateError.fixDateFormat()).show();return f.P3.DateError.fixDateFormat()}if(p>o){l.html(f.Login.MaxDateOfBirth).show();return f.Login.MaxDateOfBirth}l.html("").hide()}}],EnteringYear:[{fn:"requiredCreateAccount"}],EnteringGradeId:[{fn:"requiredCreateAccount"}],ParentFirstName:[{fn:"requiredCreateAccount"}],ParentLastName:[{fn:"requiredCreateAccount"}],ParentEmail:[{fn:function(o,m,n){var l=$("#"+m).siblings(".p3Red");if(k.isEmptier(o)){l.html(f.P3.RequiredInfoNotEntered).show();return f.P3.RequiredInfoNotEntered}if(!o.match(Bb.Validation.patterns.email)){l.html(f.P3.EmailError).show();return f.P3.EmailError}l.html("").hide()}}],RelId:[{fn:function(o,m,n){var l=$("#"+m).siblings(".p3Red");if(isNaN(o)){l.html(f.P3.RequiredInfoNotEntered).show();return f.P3.RequiredInfoNotEntered}l.html("").hide()}}],Username:[{fn:"requiredCreateAccount"}],Agree:[{fn:function(o,m,n){var l=$("#"+m).siblings(".p3Red");if(o===false){l.html(f.P3.RequiredInfoNotEntered).show();return f.P3.RequiredInfoNotEntered}l.html("").hide()}}]},requiredCreateAccount:function(o,m,n){var l=$("#"+m).siblings(".p3Red");if(k.isEmptier(o)){l.html(f.P3.RequiredInfoNotEntered).show();return f.P3.RequiredInfoNotEntered}l.html("").hide()},url:function(){return aP+"admissions/CreateCandidate/"}});g.Ms.HasOnlineApp=Bbm.extend({url:function(){return aP+"onlineapplication/hasonlineapp"}});g.Ms.HasActiveForm=Bbm.extend({url:function(){return aP+"onlineapplication/HasActiveForm"}});g.Ms.EnteringYear=Bbm.extend({});g.Ms.EnteringGrade=Bbm.extend({});g.Ms.NotificationMessageActive=Bbm.extend({url:function(){return aP+"Security/PasswordLinkType/"}});g.Ms.PasswordResetRules=Bbm.extend({url:function(){return aP+"Security/PasswordResetRules/"}});g.Ms.BrowserInfo=Bbm.extend({url:function(){return aP+"WebApp/BrowserLookup/"}});g.Ms.LdapTest=Bbm.extend({url:function(){return aP+"security/ldaptest"}});g.Cs.Alerts=Bbc.extend({model:g.Ms.Alert});g.Cs.SignInActions=Bbc.extend({model:g.Ms.SignInAction});g.Cs.CustomMessages=Bbc.extend({model:g.Ms.CustomMessage});g.Cs.EnteringYears=Bbc.extend({model:g.Ms.EnteringYear,url:function(){return aP+"admissions/EnteringAdmissionsYear/"}});g.Cs.EnteringGrades=Bbc.extend({model:g.Ms.EnteringGrade,url:function(){return aP+"admissions/EnteringGrade/"}});g.Vs.Layout=Bb.View.extend({template:"login/login.layout2.template.html",initialize:function(){this.Containers={};p3.Data.SchoolContext=new a.Ms.SchoolContext();p3.Data.SchoolContext.bind("reset change",this.renderSchoolContext,this);p3.Data.Alerts=new g.Cs.Alerts();$("HTML").addClass("skyui")},events:{"click #site-login-footer a":"footerLink"},render:function(l){var m=this;p3.fT(m.template,function(n){m.$el.html(n());m.$el.find("#site-login").fadeTo(0,0);$(l).html(m.el);g.Us.setContainers();$("BODY").addClass("sec-15-bgc");m.loadSchoolContext()})},queueView:function(l){h.queue("loadView",function(){g.Us.renderFade(p3.Layout.Containers.Footer,0,300)});h.queue("loadView",function(){g.Us.renderFade(p3.Layout.Containers.Main,0,700)});h.queue("loadView",function(){p3.rV(l,p3.Layout.Containers.Main,true)});h.queue("loadView",function(){g.Us.renderResize(700)});h.queue("loadView",function(){g.Us.renderFade(p3.Layout.Containers.Main,1,700)});h.queue("loadView",function(){g.Us.renderFade(p3.Layout.Containers.Footer,1,300)})},loadSchoolContext:function(){var l=this;p3.Data.SchoolContext.fetch({success:function(){p3.trigger("schoolContextLoaded");p3.trigger("contextLoaded");p3.setConfigPlaceholders();Bb.history.start();var q=location.protocol+"//"+location.host,p=p3.Us.Tools.getQuerystringValue("from"),n=Bb.history.fragment,m,r=false,o;if((n.substr(0,13)!="login/request")&&n!="login/apply"&&n!="login/bbid-beta-test"&&n!="login/reset"&&n!="login/reset/apply"&&n!="login/ldaptest"){if(p&&p.length>0){m=p}else{if(n!=="login"){m=location.toString().replace(q,"")}}if(m&&m.length>0&&m!=="/app/"&&m!=="/app"){r=true}if(r){o=new g.Ms.LoginLocation();o.save({from:m})}p3.router().navigate("login",true)}l.loadStyle()},error:function(m){p3.displayError("Error loading context.")}})},renderSchoolContext:function(){var l=this,n=p3.Data.SchoolContext.get("SchoolInfo"),o=p3.Data.SchoolContext.get("Style");function m(p){if(!p&&o&&o.Logo&&o.Logo.length>0){l.Containers.Logo.html('<img id="img-login-logo" src="'+o.Logo+'"/>')}else{if(n){l.Containers.Logo.html(n.SchoolName);l.Containers.Logo.fitText(1.5,{minFontSize:"12px",maxFontSize:"28px"})}}}m(false);$("#img-login-logo").error(function(){m(true)})},loadStyle:function(){p3.Data.SchoolCss=new i.Ms.SchoolCss({Colors:p3.Data.SchoolContext.get("Colors")});this.renderStyle()},renderStyle:function(){p3.rV(new i.Vs.SchoolCss(),"#app-style",true)},footerLink:function(l){l.preventDefault();if((Bb.history.getFragment()=="login")&&(l.currentTarget.hash=="#login")){window.location.reload(true)}}});g.Vs.Main=Bb.View.extend({template:"login/login.main3.template.html",events:{"click #site-login-btn :input[type=submit]":"loginAttempt","click #customhelp a":"loadCustomHelp"},render:function(l){var m=this;p3.fT(m.template,function(n){g.Us.loadBrowserInfo(function(o){var q=p3.Data.SchoolContext.get("SchoolInfo"),p=[];m.$el.html(n(m.options));m.$el.find("#site-login-main").fadeTo(0,0);$(l).html(m.el);g.Us.setContainers();if(o.Status==2){p.push(function(){p3.rV(new g.Vs.BrowserMessage({browserData:o}),p3.Layout.Containers.Browser,true)});h.queue("loadView",p.concat(h.queue("loadView")))}else{if(o.Status==1){p.push(function(){p3.rV(new g.Vs.BrowserMessage({browserData:o}),p3.Layout.Containers.Browser,true)})}p.push(function(){p3.rV(new g.Vs.TextBox({Label:"",InputId:"Username",Value:m.options.Email,PlaceHolder:"Username",AutoFocus:true}),p3.Layout.Containers.Input,false)});p.push(function(){p3.rV(new g.Vs.Password({Label:"",InputId:"Password",Value:m.options.Email,PlaceHolder:"Password"}),p3.Layout.Containers.Input,false)});p.push(function(){p3.rV(new g.Vs.CheckBox({className:"remember pull-right",Label:"Remember me",InputId:"remember",Checked:false}),p3.Layout.Containers.Input,false)});p.push(function(){p3.rV(new g.Vs.Submit({id:"site-login-btn",Value:"Login"}),p3.Layout.Containers.Input,false)});if(g.Us.ShowLoginHelpLink(q)){if(g.Us.UseLoginHelpLink(q)){p.push(function(){p3.rV(new g.Vs.Link({LinkName:q.HelplinkText,LinkRoute:"login/request?n"}),p3.Layout.Containers.Footer,true)})}else{p.push(function(){p3.rV(new g.Vs.Link({id:"customhelp",className:"pull-right topspace",LinkName:q.HelplinkText,LinkRoute:""}),p3.Layout.Containers.Footer,true)})}}p.push(function(){m.remember()});h.queue("loadView",p.concat(h.queue("loadView")));h.queue("loadView",function(){g.Us.setFocus()});p3.rV(new g.Vs.AlertsView({collection:p3.Data.Alerts}),p3.Layout.Containers.Alert,false)}if(q){p3.setTitle(q.SchoolName)}h.dequeue("loadView")})})},loginAttempt:function(o){o.preventDefault();var p=false,n=p3.Layout.Containers,m=$("#Username"),l=$("#Password");if(m.val()==""){p3.Data.Alerts.add({type:"error",message:"Please enter a username."});p=true}if(l.val()==""){p3.Data.Alerts.add({type:"error",message:"Please enter a password."});p=true}if(p===false){p3.Data.CurrLoginInfo=new g.Ms.CurrLoginInfo();p3.Data.CurrLoginInfo.set({Username:m.val(),Pwd:l.val(),Rem:$("#remember").prop("checked")});g.Us.LoginAttempt(n)}else{$("#loginBtn").button("reset");p3.rV(new g.Vs.AlertsView({collection:p3.Data.Alerts}),p3.Layout.Containers.Alert,false)}},remember:function(){var l=new g.Ms.RememberRequest();l.fetch({success:function(m){if(m.get("Username")){$("#Username").val(m.get("Username"));$("#remember").attr("checked","checked")}}});h.dequeue("loadView")},loadCustomHelp:function(l){l.stopImmediatePropagation();l.preventDefault();p3.Layout.queueView(new g.Vs.RequestComplete({Title:"Login Help",CustomMessageId:"1"}));h.dequeue("loadView")}});g.Vs.BbidMain=Bb.View.extend({template:"login/login.main3.template.html",events:{"click #loginBtn":"loginAttempt","click #nextBtn":"processNext","click #cancelBtn":"processCancel","click #customhelp a":"loadCustomHelp","keydown #Password":"passWordkeyPressEventHandler"},passWordkeyPressEventHandler:function(l){if(l.keyCode===13){this.$("#loginBtn").click()}},render:function(l){var m=this;p3.fT(m.template,function(n){g.Us.loadBrowserInfo(function(o){var q=p3.Data.SchoolContext.get("SchoolInfo"),p=[];m.$el.html(n(m.options));m.$el.find("#site-login-main").fadeTo(0,0);$(l).html(m.el);g.Us.setContainers();if(o.Status==2){p.push(function(){p3.rV(new g.Vs.BrowserMessage({browserData:o}),p3.Layout.Containers.Browser,true)});h.queue("loadView",p.concat(h.queue("loadView")))}else{if(o.Status==1){p.push(function(){p3.rV(new g.Vs.BrowserMessage({browserData:o}),p3.Layout.Containers.Browser,true)})}p.push(function(){p3.rV(new g.Vs.TextBox({Label:"",InputId:"Username",Value:m.options.Email,PlaceHolder:"Username",AutoFocus:true}),p3.Layout.Containers.Input,false)});p.push(function(){p3.rV(new g.Vs.PasswordHidden({Label:"",InputId:"Password",Value:m.options.Email,PlaceHolder:"Password"}),p3.Layout.Containers.Input,false)});p.push(function(){p3.rV(new g.Vs.SubmitHidden({}),p3.Layout.Containers.Input,false)});if(g.Us.ShowLoginHelpLink(q)){if(g.Us.UseLoginHelpLink(q)){p.push(function(){p3.rV(new g.Vs.Link({LinkName:q.HelplinkText,LinkRoute:"login/request?y"}),p3.Layout.Containers.Footer,false)})}else{p.push(function(){p3.rV(new g.Vs.Link({id:"customhelp",className:"pull-right topspace",LinkName:q.HelplinkText,LinkRoute:""}),p3.Layout.Containers.Footer,false)})}}p3.clearContainer(p3.Layout.Containers.Footer);h.queue("loadView",p.concat(h.queue("loadView")));h.queue("loadView",function(){g.Us.setFocus()});g.Us.RenderAlerts()}if(q){p3.setTitle(q.SchoolName)}h.dequeue("loadView")})})},processNext:function(n){n.preventDefault();var o=false,l=$("#Username"),p=l.val(),m;if(p===""){p3.Data.Alerts.add({type:"error",message:"Please enter a username."});o=true}if(o===false){g.Us.clearBbidStatus();m=new g.Ms.BbidStatusByName();m.fetch({data:{userName:p},success:function(q){var r=p3.Data.SchoolContext.get("SchoolInfo");g.Us.setBbidStatus(q);if(g.Data.Disabled){g.Us.LoginDisabled(false)}else{if(g.Data.Linked){g.Us.redirectToBBLogin(g.Data.Hint)}else{if(g.Data.MatchType===2&&g.Data.Match.length>0){g.Us.redirectToBBLogin(g.Data.Hint)}else{l.prop("disabled",true);$("#divPassword").show();$("#areaNext").hide();$("#areaLogin").show();$("#Password").focus();$("#areaCancel").show();p3.clearContainer(p3.Layout.Containers.Footer);if(g.Us.ShowLoginHelpLink(r)){if(g.Us.UseLoginHelpLink(r)){p3.rV(new g.Vs.Link({LinkName:r.HelplinkText,LinkRoute:"login/request?y"}),p3.Layout.Containers.Footer,true)}else{p3.rV(new g.Vs.Link({id:"customhelp",className:"pull-right topspace",LinkName:r.HelplinkText,LinkRoute:""}),p3.Layout.Containers.Footer,true)}}}}}},error:function(){p3.Data.Alerts.add({type:"error",message:"error looking up username."});g.Us.RenderAlerts()}})}else{g.Us.RenderAlerts()}},processCancel:function(m){var l=$("#Username");m.preventDefault();l.prop("disabled",false);$("#Password").val("");$("#divPassword").hide();$("#areaLogin").hide();$("#areaCancel").hide();$("#areaNext").show();l.focus();p3.clearContainer(p3.Layout.Containers.Alert);p3.clearContainer(p3.Layout.Containers.Footer)},loginAttempt:function(p){p.preventDefault();var q=false,n,o=p3.Layout.Containers,m=$("#Username"),l=$("#Password");$("#areaCancel").hide();if(m.val()==""){p3.Data.Alerts.add({type:"error",message:"Please enter a username."});q=true}if(l.val()==""){p3.Data.Alerts.add({type:"error",message:"Please enter a password."});q=true}if(q===false){g.Us.clearBbidStatus();n=new g.Ms.BbidStatusByName();n.fetch({data:{userName:m.val()},success:function(r){g.Us.setBbidStatus(r);p3.Data.CurrLoginInfo=new g.Ms.CurrLoginInfo();p3.Data.CurrLoginInfo.set({Username:m.val(),Pwd:l.val(),Rem:$("#remember").prop("checked")});g.Us.LoginAttempt(o)},error:function(){p3.Data.Alerts.add({type:"error",message:"error looking up username."});g.Us.ResetLoginScreen();g.Us.RenderAlerts()}})}else{g.Us.ResetLoginScreen();g.Us.RenderAlerts()}},remember:function(){var l=new g.Ms.RememberRequest();l.fetch({success:function(m){if(m.get("Username")){$("#Username").val(m.get("Username"));$("#remember").attr("checked","checked")}}});h.dequeue("loadView")},loadCustomHelp:function(l){l.stopImmediatePropagation();l.preventDefault();p3.Layout.queueView(new g.Vs.RequestComplete({Title:"Login Help",CustomMessageId:"1"}));h.dequeue("loadView")}});g.Vs.Request=Bb.View.extend({template:"login/login.main3.template.html",events:{"click :input[type=submit]":"sendReminder"},render:function(l){var n=this,m=new g.Ms.NotificationMessageActive();m.fetch({success:function(o,p){n.notificationResponse=(p.Message.toLowerCase()==="true")?true:false;p3.fT(n.template,function(r){n.$el.html(r(n.options));n.$el.find("#site-login-main").fadeTo(0,0);$(l).html(n.el);g.Us.setContainers();var q=[];if(n.options.namerequired){q.push(function(){p3.rV(new g.Vs.P({CustomMessageId:n.options.CustomMessageId,Text:n.options.Text}),p3.Layout.Containers.Input,false)});q.push(function(){p3.rV(new g.Vs.TextBox({Label:"First Name",InputId:"firstname",Value:n.options.firstname}),p3.Layout.Containers.Input,false)});q.push(function(){p3.rV(new g.Vs.TextBox({Label:"Last Name",InputId:"lastname",Value:n.options.lastname}),p3.Layout.Containers.Input,false)})}else{q.push(function(){p3.rV(new g.Vs.P({CustomMessageId:"1"}),p3.Layout.Containers.Input,false)})}q.push(function(){p3.rV(new g.Vs.TextBox({Label:"Email Address",InputId:"email",Value:n.options.Email}),p3.Layout.Containers.Input,false)});q.push(function(){p3.rV(new g.Vs.P({Text:"Use the checkboxes below to select what login information you would like to receive via e-mail."}),p3.Layout.Containers.Input,false)});q.push(function(){p3.rV(new g.Vs.P({Text:"The e-mail containing the selected information will be sent from <b>"+p3.Data.SchoolContext.get("SchoolInfo").MailboxName+"</b>. Please be sure to add this e-mail address to your address book/whitelist prior to submitting this request."}),p3.Layout.Containers.Input,false)});q.push(function(){p3.rV(new g.Vs.CheckBox({Label:"Username",InputId:"usernamerequest",Checked:n.options.usernamerequest}),p3.Layout.Containers.Input,false)});q.push(function(){p3.rV(new g.Vs.CheckBox({Label:"Password",InputId:"passwordrequest",Checked:n.options.passwordrequest}),p3.Layout.Containers.Input,false)});q.push(function(){p3.rV(new g.Vs.Submit({Value:"Send"}),p3.Layout.Containers.Input,false)});q.push(function(){p3.rV(new g.Vs.Link({LinkName:"Back to Login Screen",LinkRoute:g.Us.LinkRouteForLoginPage(),Reload:g.Us.ReloadLinkRouteForLoginPage()}),p3.Layout.Containers.Footer,true)});h.queue("loadView",q.concat(h.queue("loadView")));h.queue("loadView",function(){g.Us.setFocus()});h.dequeue("loadView")})}})},sendReminder:function(q){q.preventDefault();var s=this,r=false,p=p3.Layout.Containers,l=$("#email"),o=$("#usernamerequest"),n=$("#passwordrequest"),m=$("#loginBtn");p3.clearContainer(p.Alert);if(l.val()===""){p3.Data.Alerts.add({type:"error",message:"Please enter a valid email."});r=true}if(o.prop("checked")===false&&n.prop("checked")===false){p3.Data.Alerts.add({type:"error",message:"Please select at least one check box."});r=true}if(r===false){p3.Data.SignInRequest=new g.Ms.SignInRequest();p3.Data.SignInRequest.save({schoolname:p3.Data.SchoolContext.attributes.SchoolInfo.SchoolName,Email:l.val(),firstname:$("#firstname").val(),lastname:$("#lastname").val(),usernamerequest:o.prop("checked"),passwordrequest:n.prop("checked"),resetUrl:s.notificationResponse},{success:function(t,u){switch(u.message_type){case 0:if(s.notificationResponse){p3.Layout.queueView(new g.Vs.RequestComplete({Title:"Email Sent",CustomMessageId:"2",Email:t.get("Email")}))}else{if(t.get("passwordrequest")){p3.Layout.queueView(new g.Vs.UpdatePassword({Title:"Email Sent",Email:t.get("Email")}))}else{p3.Layout.queueView(new g.Vs.RequestComplete({Title:"Email Sent",CustomMessageId:"2",Email:t.get("Email")}))}}h.dequeue("loadView");break;case 3:p3.Layout.queueView(new g.Vs.RequestComplete({Title:"Login Disabled",CustomMessageId:"3"}));h.dequeue("loadView");break;case 4:if(s.options.namerequired){p3.Layout.queueView(new g.Vs.Request({Title:"Login Help",CustomMessageId:"4",firstname:t.get("firstname"),lastname:t.get("lastname"),Email:t.get("Email"),usernamerequest:t.get("usernamerequest"),passwordrequest:t.get("passwordrequest"),namerequired:true}))}else{p3.Layout.queueView(new g.Vs.Request({Title:"Login Help",Text:"Please confirm your first name and last name in order to receive the login information you requested.",firstname:t.get("firstname"),lastname:t.get("lastname"),Email:t.get("Email"),usernamerequest:t.get("usernamerequest"),passwordrequest:t.get("passwordrequest"),namerequired:true}))}h.dequeue("loadView");break;case 5:p3.Layout.queueView(new g.Vs.RequestComplete({Title:"Sign In Help",CustomMessageId:"5"}));h.dequeue("loadView");break;case 29:p3.Layout.queueView(new g.Vs.RequestComplete({Title:"Sign In Help",CustomMessageId:"29"}));h.dequeue("loadView");break;case 32:p3.Layout.queueView(new g.Vs.RequestComplete({Title:"Sign In Help",CustomMessageId:"32"}));h.dequeue("loadView");break;default:p3.Data.Alerts.add({type:"error",message:"Invalid request."})}m.button("reset");p3.rV(new g.Vs.AlertsView({collection:p3.Data.Alerts}),p3.Layout.Containers.Alert,false)},error:function(){p3.Data.Alerts.add({type:"error",message:"Invalid request."});m.button("reset");p3.rV(new g.Vs.AlertsView({collection:p3.Data.Alerts}),p3.Layout.Containers.Alert,false)}})}else{m.button("reset");p3.rV(new g.Vs.AlertsView({collection:p3.Data.Alerts}),p3.Layout.Containers.Alert,false)}}});g.Vs.Apply=Bb.View.extend({template:"login/login.apply.template.html",events:{"click #submitBtn":"loginAttempt","click #createaccount":"createAccount"},render:function(l){var m=this;m.loginSetup=new g.Ms.LoginSetup();m.loginSetup.fetch({cache:false,success:function(){var n=new g.Ms.HasActiveForm();n.fetch({success:function(){var o=false;if(n.get("Message")=="True"){o=true}p3.fT(m.template,function(p){g.Us.loadBrowserInfo(function(q){m.$el.html(p({loginSetup:m.loginSetup.toJSON(),hasApplicationForm:o}));m.$el.find("#site-login-link").fadeTo(0,0);$(l).html(m.el);g.Us.setContainers();var r=[],s,t;if(q.Status==2){r.push(function(){p3.rV(new g.Vs.BrowserMessage({browserData:q}),p3.Layout.Containers.Browser,true)});$("#site-login-form").remove();h.queue("loadView",r.concat(h.queue("loadView")))}else{switch(p3.Data.SchoolContext.attributes.SchoolInfo.SignInOption){case 0:s=false;t=false;break;case 1:s=true;t=false;break;case 2:s=false;t=true;break;case 3:s=true;t=true;break;default:s=true;t=true}if(q.Status==1){r.push(function(){p3.rV(new g.Vs.BrowserMessage({browserData:q,limitedView:true}),p3.Layout.Containers.Browser,true)})}if(s){if(t){r.push(function(){p3.rV(new g.Vs.Link({id:"login-apply-link",LinkName:p3.Data.SchoolContext.attributes.SchoolInfo.HelplinkText,LinkRoute:"login/apply",loginApplyReset:true}),p3.Layout.Containers.Footer,true)})}else{r.push(function(){p3.rV(new g.Vs.Link({id:"customhelp",className:"pull-right topspace",LinkName:p3.Data.SchoolContext.attributes.SchoolInfo.HelplinkText,LinkRoute:""}),p3.Layout.Containers.Footer,true)})}}h.queue("loadView",r.concat(h.queue("loadView")));h.queue("loadView",function(){g.Us.setFocus()})}h.dequeue("loadView")})})}})}})},loginAttempt:function(p){var q=false,o=p3.Layout.Containers,m=$("#submitBtn"),n=$("#Username"),l=$("#Password");m.button("loading");p.preventDefault();if(n.val()==""){p3.Data.Alerts.add({type:"error",message:"Please enter a username."});q=true}if(l.val()==""){p3.Data.Alerts.add({type:"error",message:"Please enter a password."});q=true}if(q===false){m.button("reset");p3.Data.CurrLoginInfo=new g.Ms.CurrLoginInfo();p3.Data.CurrLoginInfo.set({Username:n.val(),Pwd:l.val(),Rem:$("#remember").prop("checked")});g.Us.LoginAttempt(o)}else{m.button("reset");p3.rV(new g.Vs.AlertsView({collection:p3.Data.Alerts}),p3.Layout.Containers.Alert,false)}},remember:function(){var l=new g.Ms.RememberRequest();l.fetch({success:function(m){if(m.get("Username")){$("#Username").val(m.get("Username"));$("#remember").attr("checked","checked")}}});h.dequeue("loadView")},createAccount:function(){p3.Layout.queueView(new g.Vs.CreateAccount({Title:"Create an Account"}));h.dequeue("loadView");return false}});g.Vs.CreateAccount=Bb.View.extend({template:"login/login.createaccount.template.html",className:"create-account",events:{"click #submitBtn":"createAccount","click #forgotloginBtn":"forgotLogin",fieldvalid:"fieldValid",fieldinvalid:"fieldInvalid"},render:function(l){var m=this;m.loginSetup=new g.Ms.LoginSetup();m.enteringGrades=new g.Cs.EnteringGrades();m.loginSetup.fetch({cache:false,success:function(o,p){var n=_.filter(m.loginSetup.toJSON().CreateAccountSchoolYears,function(r){return r.SelectedInd==true}),q=true;if(n.length>1){q=false}m.enteringGrades.fetch({cache:false,success:function(r,s){p3.fT(m.template,function(w){m.guid=g.Us.guid();var v=[],u="",t=m.enteringGrades.toJSON();if(t&&t.length&&t[0].hasOwnProperty("LevelDescription")){_.each(t,function(y,x){if(y.LevelDescription!==u){u=y.LevelDescription;if(x>0){t[x-1].OptGroupEnd=true}y.OptGroup=u}});_.last(t).OptGroupEnd=true}m.$el.html(w({enteringYears:n,enteringGrades:t,singleEnteringYear:q,createAcctText:m.loginSetup.get("CreateAcctText"),forgotLoginText:m.loginSetup.get("ForgotLoginText")}));m.$el.find("#site-login-main").fadeTo(0,0);$(l).html(m.el);g.Us.setContainers();$(".required-indicator").tooltip();v.push(function(){p3.rV(new g.Vs.P({Text:""}),p3.Layout.Containers.Footer,true)});h.queue("loadView",v.concat(h.queue("loadView")));h.queue("loadView",function(){g.Us.setFocus()});h.dequeue("loadView");p3.Us.Captcha.Initialize({});window.setTimeout(function(){$("#site-login").height($("#site-login-box").height())},1000)})}})}})},createAccount:function(){var o=this,n,m=p3.Us.Captcha.GetResponse(),l=$("#submitBtn");l.button("loading");p3.Us.Captcha.HideError();if(!m){l.button("reset");p3.Us.Captcha.DisplayError();$("#site-login").height($("#site-login-box").height());return false}n=new g.Ms.CreateAccount({CandidateFirstName:o.$("#CandidateFirstName").prop("value"),CandidateLastName:o.$("#CandidateLastName").prop("value"),NickName:o.$("#NickName").prop("value"),CandidateDOB:o.$("#CandidateDOB").prop("value"),EnteringYear:o.$("#EnteringYear").prop("value"),EnteringGradeId:o.$("#EnteringGradeId").prop("value"),RelId:parseInt(o.$("#RelId").val(),10),ParentFirstName:o.$("#ParentFirstName").prop("value"),ParentLastName:o.$("#ParentLastName").prop("value"),ParentEmail:o.$("#ParentEmail").prop("value"),Username:o.$("#Username").prop("value"),Agree:o.$("#Agree").prop("checked"),CaptchaResponse:p3.Us.Captcha.GetResponse()});o.model=n;Bb.Validation.bind(o,{forceUpdate:true,selector:"id"});if(o.model.isValid(true)){o.model.save({},{success:function(p,q){p3.Data.SignInRequest=new g.Ms.SignInRequest();p3.Data.SignInRequest.save({schoolname:p3.Data.SchoolContext.attributes.SchoolInfo.SchoolName,Email:n.get("ParentEmail"),firstname:n.get("ParentFirstName"),lastname:n.get("ParentLastName"),usernamerequest:false,passwordrequest:true,loginFrom:"apply"},{success:function(r,t){var s=new g.Ms.NotificationMessageActive();s.fetch({success:function(u,v){o.notificationResponse=(v.Message.toLowerCase()==="true")?true:false;if(o.notificationResponse){p3.Layout.queueView(new g.Vs.RequestComplete({Title:"Email Sent",CustomMessageId:"2",Email:r.get("Email")}))}else{p3.Layout.queueView(new g.Vs.UpdatePassword({Title:"Email Sent",Email:r.get("Email")}))}h.dequeue("loadView")}})}})},error:function(p,q){if(q.responseText.indexOf("This User Name is currently unavailable")>-1){Bb.Validation.callbacks.invalid(o,"Username","Username is already in use. If you are an existing user, login or click Forgot Login? button below.","id");o.$("#Username").siblings(".p3Red").html("Username is already in use. If you are an existing user, login or click Forgot Login? button below.").show()}else{if(q.responseText.indexOf("Email has to be unique")>-1){Bb.Validation.callbacks.invalid(o,"ParentEmail","We seem to already have you in the system. If you are an existing user, login or click Forgot Login? button below.","id");o.$("#ParentEmail").siblings(".p3Red").html("We seem to already have you in the system. If you are an existing user, login or click Forgot Login? button below.").show()}else{if(q.responseText.indexOf("Captcha")>-1){p3.Us.Captcha.DisplayError()}}}$("#forgotloginBtn").show();l.button("reset");$("#create-error").show();$("#site-login").height($("#site-login-box").height());p3.Us.Captcha.Initialize({})}})}else{l.button("reset");$("#create-error").show();$("#site-login").height($("#site-login-box").height())}return false},forgotLogin:function(l){l.stopPropagation();l.preventDefault();p3.router().navigate("login/request",false);p3.Layout.queueView(new g.Vs.Request({Title:"Login Help"}));h.dequeue("loadView")},fieldValid:function(l,m,n){Bb.Validation.callbacks.valid(this,m,n)},fieldInvalid:function(l,m,n,o){Bb.Validation.callbacks.invalid(this,m,n,o)}});g.Vs.CreateAccountConfirmation=Bb.View.extend({template:"login/login.createaccountconfirmation.template.html",events:{},render:function(l){var m=this;p3.fT(m.template,function(o){m.$el.html(o({Email:m.options.Email,SchoolEmail:p3.Data.SchoolContext.get("SchoolInfo").MailboxName}));m.$el.find("#site-login-main").fadeTo(0,0);$(l).html(m.el);g.Us.setContainers();var n=[];n.push(function(){p3.rV(new g.Vs.P({Text:""}),p3.Layout.Containers.Footer,true)});h.queue("loadView",n.concat(h.queue("loadView")));h.queue("loadView",function(){g.Us.setFocus()});h.dequeue("loadView")})}});g.Vs.UpdatePassword=Bb.View.extend({template:"login/login.main3.template.html",events:{"click #site-login-btn :input[type=submit]":"setPassword","click #confirm a":"confirmation","click #confirm-ok :input[type=submit]":"ok","click #confirm-cancel :input[type=button]":"cancel"},render:function(l){var m=this;p3.fT(m.template,function(o){m.$el.html(o(m.options));m.$el.find("#site-login-main").fadeTo(0,0);$(l).html(m.el);g.Us.setContainers();var n=[];if(m.options.CancelUpdate){n.push(function(){p3.rV(new g.Vs.P({Text:"Navigating away from this screen will invalidate your current password request."}),p3.Layout.Containers.Input,false)
});n.push(function(){p3.rV(new g.Vs.Submit({id:"confirm-ok",Value:"OK"}),p3.Layout.Containers.Input,false)});n.push(function(){p3.rV(new g.Vs.Button({id:"confirm-cancel",className:"topspace",Value:"Cancel"}),p3.Layout.Containers.Input,false)})}else{n.push(function(){p3.rV(new g.Vs.P({CustomMessageId:"2",Email:m.options.Email,SchoolEmail:p3.Data.SchoolContext.get("SchoolInfo").MailboxName}),p3.Layout.Containers.Input,false)});n.push(function(){p3.rV(new g.Vs.P({Text:"Do not close this window or use the Back button in your browser. To successfully reset your password, enter the Confirmation Key contained in the e-mail into the Confirmation Key field below and enter a new password. The Confirmation Key you receive will be valid for 120 minutes."}),p3.Layout.Containers.Input,false)});n.push(function(){m.passwordRules()});n.push(function(){p3.rV(new g.Vs.Password({Label:"Confirmation Key",InputId:"pwordkey",Value:""}),p3.Layout.Containers.Input,false)});n.push(function(){p3.rV(new g.Vs.Password({Label:"New Password",InputId:"newpassword1",Value:""}),p3.Layout.Containers.Input,false)});n.push(function(){p3.rV(new g.Vs.Password({Label:"Re-Enter New Password",InputId:"newpassword2",Value:""}),p3.Layout.Containers.Input,false)});n.push(function(){p3.rV(new g.Vs.Submit({id:"site-login-btn",Value:"Set Password"}),p3.Layout.Containers.Input,false)});n.push(function(){p3.rV(new g.Vs.Link({id:"confirm",LinkName:"Back to Login Screen",LinkRoute:g.Us.LinkRouteForLoginPage(),Reload:g.Us.ReloadLinkRouteForLoginPage()}),p3.Layout.Containers.Footer,true)})}h.queue("loadView",n.concat(h.queue("loadView")));h.queue("loadView",function(){g.Us.setFocus()});h.dequeue("loadView")})},setPassword:function(q){q.preventDefault();var r=false,p=p3.Layout.Containers,s="",o=$("#pwordkey"),m=$("#newpassword1"),n=$("#newpassword2"),l=$("#loginBtn");p3.clearContainer(p.Alert);if(o.val()===""){p3.Data.Alerts.add({type:"error",message:"Please enter a confirmation key."});r=true}if(m.val()===""){p3.Data.Alerts.add({type:"error",message:"Please enter your new password."});r=true}if(n.val()===""){p3.Data.Alerts.add({type:"error",message:"Please re-enter your new password."});r=true}if((m.val()!=="")&&(n.val()!=="")&&(m.val()!==n.val())){p3.Data.Alerts.add({type:"error",message:"Passwords must match."});r=true}if(r===false){if(window.location.href.indexOf("/apply")>-1){s="applyonline"}p3.Data.UpdatePasswordRequest=new g.Ms.UpdatePasswordRequest();p3.Data.UpdatePasswordRequest.save({from:s,pwordkey:o.val(),newpassword1:m.val(),newpassword2:n.val(),remember:false,interfaceSource:"WebApp"},{success:function(t,u){g.Us.SignInSuccess(t,u)},error:function(u,v){var t;if(v.responseText.indexOf("Password requirements not met")>=0){t="The password requirements have not been met.  Please try again."}else{t="The confirmation key is invalid. Please try again."}o.val("");m.val("");n.val("");p3.Data.Alerts.add({type:"error",message:t});l.button("reset");p3.rV(new g.Vs.AlertsView({collection:p3.Data.Alerts}),p3.Layout.Containers.Alert,false)}})}else{l.button("reset");p3.rV(new g.Vs.AlertsView({collection:p3.Data.Alerts}),p3.Layout.Containers.Alert,false)}},passwordRules:function(){var l=new g.Ms.PasswordRules();l.fetch({success:function(m,n){if(n){p3.rV(new g.Vs.P({Text:l.getRulesText()}),p3.Layout.Containers.Input,false)}else{h.dequeue("loadView")}},error:function(){h.dequeue("loadView")}})},confirmation:function(l){var m=this;l.stopImmediatePropagation();l.preventDefault();p3.Layout.queueView(new g.Vs.UpdatePassword({Title:"Return to Login",Email:m.options.Email,CancelUpdate:true}));h.dequeue("loadView")},ok:function(l){l.preventDefault();window.location.reload(true)},cancel:function(l){l.preventDefault();var m=this;p3.Layout.queueView(new g.Vs.UpdatePassword({Title:"Email Sent",Email:m.options.Email}));h.dequeue("loadView")}});g.Vs.UpdatePasswordLink=Bb.View.extend({template:"login/login.request.template.html",events:{"click #submitBtn":"setPassword"},render:function(l){var n=this,m=new g.Ms.PasswordResetRules();m.fetch({data:{pwordkey:p3.Us.Tools.getQuerystringValue("pk")},success:function(p,q){var o=new g.Ms.NotificationMessageActive();o.fetch({success:function(r,s){n.notificationResponse=(s.Message.toLowerCase()==="true")?true:false;p3.fT(n.template,function(u){n.$el.html(u({rulesResponse:q}));n.$el.find("#site-login-main").fadeTo(0,0);$(l).html(n.el);g.Us.setContainers();$(".required-indicator").tooltip();var t=[];t.push(function(){p3.rV(new g.Vs.P({Text:""}),p3.Layout.Containers.Footer,true)});h.queue("loadView",t.concat(h.queue("loadView")));h.queue("loadView",function(){g.Us.setFocus()});h.dequeue("loadView")})}})}})},setPassword:function(o){o.preventDefault();var p=false,n=p3.Layout.Containers,q="",l=$("#newpassword1"),m=$("#newpassword2");p3.clearContainer(n.Alert);if(l.val()===""){p3.Data.Alerts.add({type:"error",message:"Please enter your new password."});p=true}if(m.val()===""){p3.Data.Alerts.add({type:"error",message:"Please re-enter your new password."});p=true}if((l.val()!=="")&&(m.val()!=="")&&(l.val()!==m.val())){p3.Data.Alerts.add({type:"error",message:"Passwords must match."});p=true}if(p===false){if(window.location.href.indexOf("/apply")>-1){q="applyonline"}p3.Data.UpdatePasswordRequest=new g.Ms.UpdatePasswordRequest();p3.Data.UpdatePasswordRequest.save({from:q,pwordkey:p3.Us.Tools.getQuerystringValue("pk"),newpassword1:l.val(),newpassword2:m.val(),remember:false,interfaceSource:"WebApp"},{success:function(r,s){g.Us.SignInSuccess(r,s)},error:function(r){p3.Layout.queueView(new g.Vs.UpdatePasswordLinkError({Title:"Update Password Error",Text:"We were unable to reset your password. Please click the button below to try again."}));h.dequeue("loadView")}})}else{$("#loginBtn").button("reset");p3.rV(new g.Vs.AlertsView({collection:p3.Data.Alerts}),p3.Layout.Containers.Alert,false)}},passwordRules:function(){var l=new g.Ms.PasswordRules();l.fetch({success:function(m,n){if(n){p3.rV(new g.Vs.P({Text:l.getRulesText()}),p3.Layout.Containers.Input,false)}else{h.dequeue("loadView")}},error:function(){h.dequeue("loadView")}})},confirmation:function(l){var m=this;l.stopImmediatePropagation();l.preventDefault();p3.Layout.queueView(new g.Vs.UpdatePassword({Title:"Return to Login",Email:m.options.Email,CancelUpdate:true}));h.dequeue("loadView")},ok:function(l){l.preventDefault();window.location.reload(true)},cancel:function(l){l.preventDefault();var m=this;p3.Layout.queueView(new g.Vs.UpdatePassword({Title:"Email Sent",Email:m.options.Email}));h.dequeue("loadView")}});g.Vs.UpdateExpPassword=Bb.View.extend({template:"login/login.main3.template.html",tagName:"div",events:{"click #site-login-btn :input[type=submit]":"updExpPassword"},render:function(l){var m=this;p3.fT(m.template,function(o){m.$el.html(o(m.options));m.$el.find("#site-login-main").fadeTo(0,0);$(l).html(m.el);g.Us.setContainers();var n=[];if(m.options.IsExp){n.push(function(){p3.rV(new g.Vs.P({Text:"Your password expired. Please enter a new password."}),p3.Layout.Containers.Input,false)})}else{n.push(function(){p3.rV(new g.Vs.P({Text:"Please enter a new password."}),p3.Layout.Containers.Input,false)})}if(m.options.PasswordRules!=undefined&&m.options.PasswordRules!=null&&m.options.PasswordRules.length>0){n.push(function(){p3.rV(new g.Vs.P({Text:m.options.PasswordRules}),p3.Layout.Containers.Input,false)})}n.push(function(){p3.rV(new g.Vs.Password({Label:"Current Password",InputId:"currpassword",Value:""}),p3.Layout.Containers.Input,false)});n.push(function(){p3.rV(new g.Vs.Password({Label:"New Password",InputId:"newpassword1",Value:""}),p3.Layout.Containers.Input,false)});n.push(function(){p3.rV(new g.Vs.Password({Label:"Re-Enter New Password",InputId:"newpassword2",Value:""}),p3.Layout.Containers.Input,false)});n.push(function(){p3.rV(new g.Vs.Submit({id:"site-login-btn",Value:"Set Password"}),p3.Layout.Containers.Input,false)});n.push(function(){p3.rV(new g.Vs.P({Text:""}),p3.Layout.Containers.Footer,true)});h.queue("loadView",n.concat(h.queue("loadView")));h.queue("loadView",function(){g.Us.setFocus()});h.dequeue("loadView")})},updExpPassword:function(q){q.preventDefault();var s=this,r=false,p=p3.Layout.Containers,l=$("#currpassword"),n=$("#newpassword1"),o=$("#newpassword2"),m=$("#loginBtn");p3.clearContainer(p.Alert);if(l.val()===null||l.val()===undefined||l.val()===""){p3.Data.Alerts.add({type:"error",message:"Please enter your current password."});r=true}if(n.val()===""){p3.Data.Alerts.add({type:"error",message:"Please enter your new password."});r=true}if(o.val()===""){p3.Data.Alerts.add({type:"error",message:"Please re-enter your new password."});r=true}if((n.val()!=="")&&(o.val()!=="")&&(n.val()!==o.val())){p3.Data.Alerts.add({type:"error",message:"New passwords must match."});r=true}if(r===false){p3.Data.UpdateExpPasswordRequest=new g.Ms.UpdateExpPasswordRequest();p3.Data.UpdateExpPasswordRequest.save({userid:s.options.userid,currentpassword:l.val(),newpassword1:n.val(),newpassword2:o.val(),username:s.options.Username},{success:function(t,u){switch(u){case 0:if(p3.Data.CurrLoginInfo===undefined||p3.Data.CurrLoginInfo===null){p3.rV(new g.Vs.AlertView({type:"error",message:"Login info could not be found."}),currContainer.Alert,false);return false}p3.Data.CurrLoginInfo.set("Pwd",n.val());p3.Layout.queueView(new g.Vs.UpdateExpPwdRequestComplete({Title:"Change Password",Text:"You successfully changed your password."}));h.dequeue("loadView");break;case 1:n.val("");o.val("");p3.Data.Alerts.add({type:"error",message:f.Account.CurrentPasswordError});break;case 2:case 3:case 4:n.val("");o.val("");p3.Data.Alerts.add({type:"warning",message:f.Account.NewPasswordInvalid});break}m.button("reset");p3.rV(new g.Vs.AlertsView({collection:p3.Data.Alerts}),p3.Layout.Containers.Alert,false)},error:function(){p3.Data.Alerts.add({type:"error",message:"Invalid request."});m.button("reset");p3.rV(new g.Vs.AlertsView({collection:p3.Data.Alerts}),p3.Layout.Containers.Alert,false)}})}else{m.button("reset");p3.rV(new g.Vs.AlertsView({collection:p3.Data.Alerts}),p3.Layout.Containers.Alert,false)}}});g.Vs.UpdateExpPwdRequestComplete=Bb.View.extend({template:"login/login.main3.template.html",tagName:"div",events:{"click #site-ok-relogin-btn :input[type=submit]":"reLogin"},render:function(l){var m=this;p3.fT(m.template,function(o){m.$el.html(o(m.options));m.$el.find("#site-login-main").fadeTo(0,0);$(l).html(m.el);g.Us.setContainers();var n=[];n.push(function(){p3.rV(new g.Vs.P({Text:m.options.Text}),p3.Layout.Containers.Input,false)});n.push(function(){p3.rV(new g.Vs.Submit({id:"site-ok-relogin-btn",Value:"Ok"}),p3.Layout.Containers.Input,false)});n.push(function(){p3.rV(new g.Vs.P({Text:""}),p3.Layout.Containers.Footer,true)});h.queue("loadView",n.concat(h.queue("loadView")));h.queue("loadView",function(){g.Us.setFocus()});h.dequeue("loadView")})},reLogin:function(m){m.preventDefault();var l=p3.Layout.Containers;g.Us.LoginAttempt(l)}});g.Vs.UpdatePasswordLinkError=Bb.View.extend({template:"login/login.main3.template.html",tagName:"div",events:{"click #submit :input[type=submit]":"loginRequest"},render:function(l){var m=this;p3.fT(m.template,function(o){m.$el.html(o(m.options));m.$el.find("#site-login-main").fadeTo(0,0);$(l).html(m.el);g.Us.setContainers();var n=[];n.push(function(){p3.rV(new g.Vs.P({Text:m.options.Text}),p3.Layout.Containers.Input,false)});n.push(function(){p3.rV(new g.Vs.Submit({id:"submit",Value:"Try Again"}),p3.Layout.Containers.Input,false)});n.push(function(){p3.rV(new g.Vs.P({Text:""}),p3.Layout.Containers.Footer,true)});h.queue("loadView",n.concat(h.queue("loadView")));h.queue("loadView",function(){g.Us.setFocus()});h.dequeue("loadView")})},loginRequest:function(l){l.preventDefault();p3.Layout.queueView(new g.Vs.Request({Title:"Login Help"}),500);h.dequeue("loadView")}});g.Vs.PasswordReminder=Bb.View.extend({template:"login/login.main3.template.html",tagName:"div",events:{"click #site-msg-read-btn":"changeNow","click #site-next-time-btn":"remindLater"},render:function(l){var m=this;p3.fT(m.template,function(o){m.$el.html(o(m.options));m.$el.find("#site-login-main").fadeTo(0,0);$(l).html(m.el);g.Us.setContainers();var n=[];n.push(function(){p3.rV(new g.Vs.P({Text:m.options.Text}),p3.Layout.Containers.Input,false)});n.push(function(){p3.rV(new g.Vs.Button({id:"site-next-time-btn",btnClass:"btn-primary",Value:"Remind Me Later"}),p3.Layout.Containers.Input,false)});n.push(function(){p3.rV(new g.Vs.Button({id:"site-msg-read-btn",btnClass:"btn-link",Value:"Change Now"}),p3.Layout.Containers.Input,false)});n.push(function(){p3.rV(new g.Vs.P({className:"clear"}),p3.Layout.Containers.Input,false)});n.push(function(){p3.rV(new g.Vs.P({Text:""}),p3.Layout.Containers.Footer,true)});h.queue("loadView",n.concat(h.queue("loadView")));h.queue("loadView",function(){g.Us.setFocus()});h.dequeue("loadView")})},changeNow:function(l){l.preventDefault();var m=this;p3.Layout.queueView(new g.Vs.UpdateExpPassword({Title:"Password Expiration",PasswordRules:m.options.Response.PasswordRulesStr,userid:m.options.Response.CurrentUserForExpired,Username:m.options.Response.Username,IsExp:false}));h.dequeue("loadView")},remindLater:function(m){m.preventDefault();var n=this,l=p3.Layout.Containers;g.Us.CheckSignInActions(n.options.Response,l)}});g.Vs.RequestComplete=Bb.View.extend({template:"login/login.main3.template.html",tagName:"div",render:function(l){var m=this;p3.fT(m.template,function(r){var o=null,n=[],p,q=false;m.$el.html(r(m.options));m.$el.find("#site-login-main").fadeTo(0,0);$(l).html(m.el);g.Us.setContainers();if(m.options.Email){o=m.options.Email}n.push(function(){p3.rV(new g.Vs.P({CustomMessageId:m.options.CustomMessageId,Email:o,SchoolEmail:p3.Data.SchoolContext.get("SchoolInfo").MailboxName,Text:m.options.Text}),p3.Layout.Containers.Input,false)});if(window.location.href.indexOf("/apply")>-1){p="login/apply";q=true}if(window.location.href.indexOf("/apply")>-1){p="login/apply";q=true}else{if(g.Data.BbidFlow){p="login";q=true}else{p="login"}}if(!m.options.SuppressLink){n.push(function(){p3.rV(new g.Vs.Link({id:"site-login-link",LinkName:"Back to Login Screen",LinkRoute:p,Reload:q}),p3.Layout.Containers.Footer,true)})}h.queue("loadView",n.concat(h.queue("loadView")));h.queue("loadView",function(){g.Us.setFocus()});h.dequeue("loadView")})}});g.Vs.Link=Bb.View.extend({template:"login/login.link.template.html",tagName:"div",events:{"click #login-apply-link":"loginApplyReset"},render:function(l){var m=this;p3.fT(m.template,function(n){m.$el.html(n(m.options));$(l).append(m.el);h.dequeue("loadView")})},loginApplyReset:function(l){var m=this;if(m.options.loginApplyReset){l.stopPropagation();l.preventDefault();p3.Layout.queueView(new g.Vs.Request({Title:"Login Help"}),500);h.dequeue("loadView")}}});g.Vs.Submit=Bb.View.extend({template:"login/login.submit.template.html",tagName:"div",events:{"click #loginBtn":"changeBtnState"},render:function(l){var m=this;p3.fT(m.template,function(n){m.$el.html(n(m.options));$(l).append(m.el);h.dequeue("loadView")})},changeBtnState:function(){$("#loginBtn").button("loading")}});g.Vs.SubmitHidden=Bb.View.extend({template:"login/login.bbid.submit.template.html",tagName:"div",events:{"click #loginBtn":"changeBtnState"},render:function(l){var m=this;p3.fT(m.template,function(n){m.$el.html(n(m.options));$(l).append(m.el);h.dequeue("loadView")})},changeBtnState:function(){$("#loginBtn").button("loading")}});g.Vs.Button=Bb.View.extend({template:"login/login.button.template.html",tagName:"span",render:function(l){var m=this;p3.fT(m.template,function(n){m.$el.html(n(m.options));$(l).append(m.el);h.dequeue("loadView")})}});g.Vs.P=Bb.View.extend({template:"login/login.P.template.html",tagName:"p",render:function(l){var n=this,m;if(n.options.CustomMessageId){m=new g.Ms.CustomMessage({custMsgId:n.options.CustomMessageId});m.fetch({success:function(o,p){p3.fT(n.template,function(q){if(p.Text==""){p.Text=p.DefaultText}if(n.options.Email){p.Text=p.Text.replace("[user e-mail]",n.options.Email)}if(n.options.SchoolEmail){p.Text=p.Text.replace("[school e-mail]",n.options.SchoolEmail)}n.$el.html(q(p));$(l).append(n.el);h.dequeue("loadView")})},error:function(){h.dequeue("loadView")}})}else{p3.fT(n.template,function(o){n.$el.html(o(n.options));$(l).append(n.el);h.dequeue("loadView")})}}});g.Vs.TextBox=Bb.View.extend({template:"login/login.textbox.template.html",tagName:"div",className:"textfield",render:function(l){var m=this;p3.fT(m.template,function(n){m.$el.html(n(m.options));$(l).append(m.el);if(m.options.AutoFocus){m.$el.find("input").attr("autofocus","autofocus")}h.dequeue("loadView")})}});g.Vs.Password=Bb.View.extend({template:"login/login.password.template.html",tagName:"div",className:"textfield",render:function(l){var m=this;p3.fT(m.template,function(n){m.$el.html(n(m.options));$(l).append(m.el);h.dequeue("loadView")})}});g.Vs.PasswordHidden=Bb.View.extend({template:"login/login.bbid.password.template.html",tagName:"div",className:"textfield",render:function(l){var m=this;p3.fT(m.template,function(n){m.$el.html(n(m.options));$(l).append(m.el);h.dequeue("loadView")})}});g.Vs.CheckBox=Bb.View.extend({template:"login/login.checkbox.template.html",tagName:"div",className:"checkbox",render:function(l){var m=this;p3.fT(m.template,function(n){m.$el.html(n(m.options));$(l).append(m.el);h.dequeue("loadView")})}});g.Vs.AlertView=Bb.View.extend({className:"message",render:function(l){this.$el.html(this.options.message);this.$el.addClass(this.options.type);$(l).append(this.el);if(p3.Layout.Containers.Login){p3.Layout.Containers.Login.height(p3.Layout.Containers.Box.height())}}});g.Vs.AlertViewNew=Bb.View.extend({tagName:"li",className:"message",render:function(l){this.$el.html(this.model.get("message"));this.$el.addClass(this.model.get("type"));$(l).append(this.el)}});g.Vs.AlertsView=Bb.View.extend({tagName:"ul",render:function(l){if(p3.Data.Alerts.length){var m=this;p3.clearContainer(p3.Layout.Containers.Alert);$(l).append(this.el);_.each(this.collection.models,function(n){p3.rV(new g.Vs.AlertViewNew({model:n}),m.$el,false)});p3.Data.Alerts.reset();p3.Layout.Containers.Login.height(p3.Layout.Containers.Box.height())}}});g.Vs.SignInActionMessages=Bb.View.extend({template:"login/login.main3.template.html",events:{"click #site-msg-read-btn":"LogMessage","click #site-next-time-btn":"ShowNextTime","click #site-msg-view-prof":"ViewProfile","click #site-msg-save-email":"LogMessage"},render:function(l){var m=this;p3.fT(m.template,function(y){var o=1,p,q,t,s,r,u,x,w,v,n;if(p3.Data.currSAMsg==null||p3.Data.currSAMsg.length==0||isNaN(p3.Data.currSAMsg)){p3.Data.currSAMsg=o}else{o=p3.Data.currSAMsg}p=o-1;q=m.collection.at(p);t=-1;switch(q.get("action_type")){case 1:t=10;break;case 2:t=11;break;case 3:t=12;break}if(t>-1){s=p3.Data.CustomProfileDataMessages.find(function(z){return z.get("MessageID")===t});if(s!=null&&s!=undefined){r=s.get("GetCustomMessage");u=s.get("DefaultText");q.set("action_text",(r!=null&&r.toString().length>0)?r:u)}}q.set({curr_msgnum:o,total_msgs:m.collection.length});x="Message: Action "+o+" of "+m.collection.length;m.$el.html(y({Title:x}));m.$el.find("#site-login-main").fadeTo(0,0);$(l).html(m.el);g.Us.setContainers();w=[];switch(q.get("action_type")){case 0:w.push(function(){p3.rV(new g.Vs.P({Text:q.get("action_text")}),p3.Layout.Containers.Input,false)});w.push(function(){p3.rV(new g.Vs.Button({id:"site-next-time-btn",btnClass:"btn-primary",Value:"Show Me Next Time"}),p3.Layout.Containers.Input,false)});w.push(function(){p3.rV(new g.Vs.Button({id:"site-msg-read-btn",btnClass:"btn-link",Value:"Message Read"}),p3.Layout.Containers.Input,false)});w.push(function(){p3.rV(new g.Vs.P({className:"clear"}),p3.Layout.Containers.Input,false)});break;case 1:case 2:w.push(function(){p3.rV(new g.Vs.P({Text:q.get("action_text")}),p3.Layout.Containers.Input,false)});v="E-mail Address";n="CC E-mail Address";if(String(q.get("EmailBad")).toLowerCase()=="yes"){v+=" [bad]"}if(String(q.get("CcEmailBad")).toLowerCase()=="yes"){n+=" [bad]"}if(q.get("edit_email")){w.push(function(){p3.rV(new g.Vs.TextBox({Label:v,InputId:"emailTxt",Value:q.get("Email")}),p3.Layout.Containers.Input,false)})}if(q.get("edit_cc_email")){w.push(function(){p3.rV(new g.Vs.TextBox({Label:n,InputId:"ccEmailTxt",Value:q.get("CcEmail")}),p3.Layout.Containers.Input,false)})}w.push(function(){p3.rV(new g.Vs.Button({id:"site-next-time-btn",btnClass:"btn-primary",Value:"Show Me Next Time"}),p3.Layout.Containers.Input,false)});w.push(function(){p3.rV(new g.Vs.Button({id:"site-msg-save-email",btnClass:"btn-link",Value:"Save E-mail Information"}),p3.Layout.Containers.Input,false)});w.push(function(){p3.rV(new g.Vs.P({className:"clear"}),p3.Layout.Containers.Input,false)});break;case 3:w.push(function(){p3.rV(new g.Vs.P({Text:q.get("action_text")}),p3.Layout.Containers.Input,false)});w.push(function(){p3.rV(new g.Vs.Button({id:"site-next-time-btn",btnClass:"btn-primary",Value:"Show Me Next Time"}),p3.Layout.Containers.Input,false)});w.push(function(){p3.rV(new g.Vs.Button({id:"site-msg-view-prof",btnClass:"btn-link",Value:"View Profile"}),p3.Layout.Containers.Input,false)});w.push(function(){p3.rV(new g.Vs.P({className:"clear"}),p3.Layout.Containers.Input,false)});break;default:p3.rV(new g.Vs.AlertView({type:"error",message:"Error: Unknown action type."}),p3.Layout.Containers.Alert,false)}w.push(function(){p3.rV(new g.Vs.P({Text:""}),p3.Layout.Containers.Footer,true)});h.queue("loadView",w.concat(h.queue("loadView")));h.queue("loadView",function(){g.Us.setFocus()});h.dequeue("loadView")})},ShowNextTime:function(n){n.preventDefault();var o=this,l=p3.Layout.Containers,m=p3.Data.currSAMsg;p3.clearContainer(l.Alert);if(m==null||isNaN(m)){m=1;p3.Data.currSAMsg=m}if(m<o.collection.length){m++;p3.Data.currSAMsg=m;p3.Layout.queueView(new g.Vs.SignInActionMessages({collection:p3.Data.SignInActions}));h.dequeue("loadView")}else{g.Us.transferHome()}},ViewProfile:function(l){l.stopPropagation();l.preventDefault();var m=new g.Ms.LoginLocation();m.save({from:"#profile/"+p3.Data.UserId+"/contactcard"},{success:function(){g.Us.transferHome()}})},LogMessage:function(r){r.preventDefault();var t=this,n=p3.Layout.Containers,o=p3.Data.currSAMsg,p,q,l,s,m;p3.clearContainer(n.Alert);if(o==null||isNaN(o)){p3.rV(new g.Vs.AlertView({type:"error",message:"Error getting current message."}),n.Alert,false);return false}p=o-1;q=t.collection.at(p);l=q.get("action_type");q.unset("__type");switch(l){case 0:q.save({},{success:function(u,v){if(o<t.collection.length){o++;p3.Data.currSAMsg=o;p3.Layout.queueView(new g.Vs.SignInActionMessages({collection:p3.Data.SignInActions}));h.dequeue("loadView")}else{g.Us.transferHome()}},error:function(){p3.rV(new g.Vs.AlertView({type:"error",message:"Error logging message read."}),n.Alert,false)}});break;case 1:case 2:s=$("#emailTxt").val();m=$("#ccEmailTxt").val();if(g.Us.ValidateEmail(s,m,n)){q.set({Email:s,CcEmail:m});q.save({},{success:function(u,v){if(o<t.collection.length){o++;p3.Data.currSAMsg=o;p3.Layout.queueView(new g.Vs.SignInActionMessages({collection:p3.Data.SignInActions}));h.dequeue("loadView")}else{g.Us.transferHome()}},error:function(v,u){p3.rV(new g.Vs.AlertView({type:"error",message:u}),n.Alert,false)}})}break;case 3:break;default:p3.rV(new g.Vs.AlertView({type:"error",message:"Error: Unknown action type."}),n.Alert,false)}}});g.Vs.Timeout=Bb.View.extend({template:"login/login.timeout.template.html",events:{"click #to-signin":"loginAttempt","keydown #to-pwd":"onKeyDown"},render:function(l){var m=this;$(l).append(this.el);p3.fT(m.template,function(n){m.$el.html(n())})},onKeyDown:function(l){var m=(l.which||l.keyCode);if(m===13){this.loginAttempt(l)}},loginAttempt:function(n){var l=$("#to-pwd"),o=p3.Us.Validate,m;n.preventDefault();$(".alert").hide();if(o.isEmpty(l.val())){e.ErrorBox(f.P3.ErrorTryAgain,".modal-body",false)}else{m=new g.Ms.Authentication();m.save({From:"",Password:l.val(),Quiet:true,InterfaceSource:"WebApp"},{success:function(p,q){if(q.LoginSuccessful===true){g.Us.hideTimeout()}else{if(q.AuthenticationResult==5){g.Us.transferHome()}else{e.ErrorBox(f.P3.InvalidPwd,".modal-body",false)}}},error:function(){e.ErrorBox(f.P3.ErrorTryAgain,".modal-body",false)}})}return false}});g.Vs.BrowserMessage=Bb.View.extend({template:"login/login.browser.template.html",render:function(l){var m=this;$(l).append(this.el);p3.fT(m.template,function(n){m.$el.html(n({browser:m.options.browserData,limitedView:m.options.limitedView}));h.dequeue("loadView")})}});g.Vs.LdapTest=Bb.View.extend({template:"login/login.ldaptest.template.html",events:{"click #ldap_btn_test":"doTest"},render:function(l){var m=this;$(l).append(this.el);p3.fT(m.template,function(n){m.$el.html(n({}));h.dequeue("loadView")})},doTest:function(n){var o=this,m=$("#ldap_btn_test"),l=$("#ldap_message");l.html("");m.button("loading");o.model=new g.Ms.LdapTest({ldap_path:o.$("#ldap_path").prop("value"),ldap_search_base:o.$("#ldap_search_base").prop("value"),ldap_user:o.$("#ldap_user").prop("value"),ldap_pwd:o.$("#ldap_pwd").prop("value"),ldap_secure:o.$("#ldap_secure").prop("value"),ldap_server:o.$("#ldap_server").prop("value")});o.model.save({},{success:function(p,q){l.append("<p><b>"+q.Result+"</b></p>");l.append("<p>"+q.Message+"</p");$("#site-login").height($("#site-login-box").height());m.button("reset")},error:function(p,q){l.html("Error authenticating.");$("#site-login").height($("#site-login-box").height());m.button("reset")}});return false}});g.Vs.BbidLinkContent=Bb.View.extend({template:"login/login.bbid.link.template.html",events:{"click #btnConfirm":"doConfirm","click #btnChangeBbidAccount":"doChangeBbidAccount"},doChangeBbidAccount:function(l){g.Us.redirectToBBLogin()},doConfirm:function(m){var n=this,l=n.$("#link-alert-container");b.BBAuth.getToken({disableRedirect:true}).then(function(o){$.ajax({url:"/api/bbid/link",data:{signout:true},headers:{Authorization:"Bearer "+o,"Content-Type":"application/json"},method:"GET",success:function(p){if(p.linked){window.location.reload(true)}else{p3.Data.Alerts=new g.Cs.Alerts();if(p.hasOwnProperty("UserNameInUse")&&p.UserNameInUse){p3.Data.Alerts.add({type:"error",message:"The user name is already in use."})}else{if(p.hasOwnProperty("IsImpersonating")&&p.IsImpersonating){p3.Data.Alerts.add({type:"error",message:"Cannot link while impersonating."})}else{p3.Data.Alerts.add({type:"error",message:"Error linking the user."})}}g.Us.RenderAlerts(l)}},error:function(){p3.Data.Alerts=new g.Cs.Alerts();p3.Data.Alerts.add({type:"error",message:"Error linking user."});g.Us.RenderAlerts(l)}})},function(o){p3.Data.Alerts=new g.Cs.Alerts();p3.Data.Alerts.add({type:"error",message:"Error getting token."});g.Us.RenderAlerts(l)})},render:function(l){var m=this;$(l).html(m.el);m.renderTemplate()},renderTemplate:function(){var r=this,n=(g.Data.DomainList?g.Data.DomainList.split("|"):""),l=(g.Data.AlternateDomainList?g.Data.AlternateDomainList.split("|"):""),o=r.buildDomainExamples(n),p=r.failsDomainMatch(n,l,g.Data.BbidEmailAddress),q=r.failsEmailMatch(g.Data.Match,g.Data.BbidEmailAddress),m=(!p&&!q);p3.fT(r.template,function(s){r.$el.html(s({onName:r.options.onName,onUsername:r.options.onUsername,bbName:g.Data.BbidName,bbUsername:g.Data.BbidEmailAddress,matchType:g.Data.MatchType,domainExamples:o,emailExample:g.Data.Hint,canLink:m}))})},failsDomainMatch:function(m,l,n){var p,o=false,q=n.toLowerCase();if(g.Data.MatchType===1){o=true;if(m&&m.length>0){for(p=0;p<m.length;p++){if(q.indexOf(m[p].toLowerCase())>0){o=false}}}if(o&&l&&l.length>0){for(p=0;p<l.length;p++){if(q.indexOf(l[p].toLowerCase())>0){o=false}}}}return o},failsEmailMatch:function(p,l){var m=false,n=l?l.toLowerCase():"",o=p?g.Data.Match.toLowerCase():"";if(g.Data.MatchType===2){m=true;if(n.length>0&&n===o){m=false}}return m},buildDomainExamples:function(l){var n,m=[];for(n=0;n<l.length;n++){m.push("example@"+l[n].toLowerCase())}return m}});g.Vs.BbidLinkModal=Bb.View.extend({template:"login/login.bbid.modal.template.html",dispose:function(){g.Us.HelpPanel(true)},render:function(l){var n=this,m=new g.Vs.BbidLinkContent({onName:n.options.onName,onUsername:n.options.onUsername});p3.Data.Context.set("ShowUserHelpPanel",false,{silent:true});g.Us.HelpPanel(false);n.$el.attr("id","bbid-fullscreen-messages");$(l).append(n.el);p3.fT(n.template,function(o){n.$el.html(o());n.renderSchoolContext();p3.rV(m,n.$(".modal-body"),true);p3.setModalHeight(p3.Layout.Containers.Modal)})},renderSchoolContext:function(){var n=p3.Data.SchoolContext.get("SchoolInfo"),o=p3.Data.SchoolContext.get("Style"),l=$("#site-login-logo");function m(p){if(!p&&o&&o.Logo&&o.Logo.length>0){l.html('<img id="img-login-logo" src="'+o.Logo+'"/>')}else{if(n){l.html(n.SchoolName);l.fitText(1.5,{minFontSize:"12px",maxFontSize:"24px"})}}}m(false);$("#img-login-logo").error(function(){m(true)})}});g.Vs.BbidLoginInstructionsContent=Bb.View.extend({template:"login/login.bbid.instructions.template.html",events:{"click #btnContinue":"doContinue"},render:function(l){var m=this;$(l).html(m.el);m.renderTemplate()},renderTemplate:function(){var n=this,l=(g.Data.DomainList?g.Data.DomainList.split("|"):""),m=n.buildExamples(l);p3.fT(n.template,function(o){n.$el.html(o({matchType:g.Data.MatchType,domainExamples:m,emailExample:g.Data.Hint}))})},buildExamples:function(l){var m;for(m=0;m<l.length;m++){l[m]="example@"+l[m].toLowerCase()}return l},doContinue:function(l){g.Us.redirectToBBLogin(g.Data.Hint)}});g.Vs.BbidLoginInstructionsModal=Bb.View.extend({template:"login/login.bbid.modal.template.html",dispose:function(){g.Us.HelpPanel(true)},render:function(l){var m=this;p3.Data.Context.set("ShowUserHelpPanel",false,{silent:true});g.Us.HelpPanel(false);m.$el.attr("id","bbid-fullscreen-messages");$(l).append(m.el);p3.fT(m.template,function(n){m.$el.html(n());m.renderSchoolContext();p3.rV(new g.Vs.BbidLoginInstructionsContent(),m.$(".modal-body"),true)})},renderSchoolContext:function(){var n=p3.Data.SchoolContext.get("SchoolInfo"),o=p3.Data.SchoolContext.get("Style"),l=$("#site-login-logo");function m(p){if(!p&&o&&o.Logo&&o.Logo.length>0){l.html('<img id="img-login-logo" src="'+o.Logo+'"/>')}else{if(n){l.html(n.SchoolName);l.fitText(1.5,{minFontSize:"12px",maxFontSize:"28px"})}}}m(false);$("#img-login-logo").error(function(){m(true)})}});g.Vs.InactivityWarningModal=Bb.View.extend({template:"login/login.inactivitywarning.template.html",events:{"click #btnConfirm":"keepAlive"},render:function(l){var m=this;m.renderTemplate();$(l).append(m.el)},renderTemplate:function(){var l=this;p3.fT(l.template,function(m){l.$el.html(m({}))})},keepAlive:function(l){g.Us.bbidKeepAlive();g.Us.OnSessionKeepAlive();p3.showModal(p3.Layout.Containers.Modal,"hide")}});g.Us.transferHome=function(){var l=new g.Ms.LoginLocation(),m=true;l.fetch({data:{clear:true},success:function(p,q){var r=p.get("sso"),n=p.get("from"),o=false;if(window.location.href.indexOf("/apply")>-1){o=true}if(r&&r.length>0){m=false;window.location.hash="";window.location.href=r}else{if(n&&n.length>0){m=false;window.location.hash="";if(n.indexOf("/podium")==0){window.location.href=location.protocol+"//"+window.location.hostname+n}else{if(n.indexOf("#")==0&&(window.location.pathname=="/app/"||window.location.pathname=="/app")){window.location.assign("/app?fromHash="+n.replace("#",""))}else{if(navigator.userAgent.indexOf("Safari")>-1&&n.indexOf("#")>-1&&window.location.pathname.indexOf("/app")>-1){window.location.assign("/app?fromHash="+n.split("#")[1])}else{if(n.indexOf("FileDownload")>-1){window.open(location.protocol+"//"+window.location.hostname+n,"","");m=true}else{window.location.href=n;if(!o){window.location.reload(true)}}}}}}}},complete:function(){if(m){p3.transferHome()}}})};g.Us.ValidateEmail=function(n,l,m){var p=/^([\w\.\-\'\+]+@[^\.@\'\+][\w\.\-]*\.\w{2,})$/gi,o=true;p.lastIndex=0;if(n!==null&&n!==undefined&&n.length>0){if(!p.test(n)){p3.rV(new g.Vs.AlertView({type:"error",message:"Invalid E-mail address.  Please try again."}),m.Alert,false);o=false}}p.lastIndex=0;if(l!=null&&l!=undefined&&l.length>0){if(!p.test(l)){p3.rV(new g.Vs.AlertView({type:"error",message:"Invalid CC E-mail address.  Please try again."}),m.Alert,false);o=false}}return o};g.Us.renderResize=function(n){var l=p3.Layout.Containers,m;if(l.Box&&l.Box.length>0){m=l.Box.height();l.Login.animate({height:m+"px"},n,function(){h.dequeue("loadView")})}};g.Us.renderFade=function(n,l,m){$(n).fadeTo(m,l,function(){h.dequeue("loadView")})};g.Us.setContainers=function(){p3.Layout.Containers.Login=$("#site-login");p3.Layout.Containers.Logo=$("#site-login-logo");p3.Layout.Containers.Content=$("#site-login-content");p3.Layout.Containers.Main=$("#site-login-main");p3.Layout.Containers.Input=$("#site-login-input");p3.Layout.Containers.Alert=$("#site-login-alert");p3.Layout.Containers.Box=$("#site-login-box");p3.Layout.Containers.Footer=$("#site-login-footer");p3.Layout.Containers.Browser=$("#site-login-browser")};g.Us.setFocus=function(){$("form :input[type=text],[type=password],[type=button],[type=submit]:visible:enabled").filter(":first").focus();h.dequeue("loadView")};g.Us.LoginAttempt=function(m){if(p3.Data.CurrLoginInfo==undefined||p3.Data.CurrLoginInfo==null){p3.rV(new g.Vs.AlertView({type:"error",message:"Login info could not be found."}),m.Alert,false);return false}var n=new g.Ms.RememberRequest(),o="",l;n.fetch({success:function(p){if(p.get("Username")){p3.Data.CurrLoginInfo.set("Username",p.get("Username"));p3.Data.CurrLoginInfo.set("Rem",true)}}});if(window.location.href.indexOf("/apply")>-1){o="applyonline"}l=new g.Ms.Authentication();l.save({From:o,Username:p3.Data.CurrLoginInfo.get("Username"),Password:p3.Data.CurrLoginInfo.get("Pwd"),remember:p3.Data.CurrLoginInfo.get("Rem"),InterfaceSource:"WebApp"},{success:function(p,q){g.Us.SignInSuccess(p,q)},error:function(){$("#loginBtn").button("reset");$("#Username").select();$("#Password").val("");p3.Data.Alerts.add({type:"error",message:"An error has occurred."});g.Us.ResetLoginScreen();g.Us.RenderAlerts()}})};g.Us.SignInSuccess=function(n,o){var l=p3.Layout.Containers,p,m;if(o.LoginSuccessful===true){if(g.Data.BbidFlow&&g.Data.RequiresBbid){if(g.Data.BbidSession){location.reload(false)}else{g.Us.showBbidLoginInstructions()}}else{if(o.DaysToPasswordExpire>0&&o.DaysToPasswordExpire<100){p="Your password expires in "+o.DaysToPasswordExpire+" days.";p3.Layout.queueView(new g.Vs.PasswordReminder({Title:"Password Expiration",Text:p,Response:o}));h.dequeue("loadView")}else{if(window.location.href.indexOf("/apply")>-1){m=new g.Ms.LoginLocation();m.save({from:n.get("From")},{success:function(q,r){g.Us.CheckSignInActions(o,l)}})}else{if(window.location.href.indexOf("/external")>-1){g.Us.transferHome()}else{g.Us.CheckSignInActions(o,l)}}}}}else{if(o.PasswordExpired){p3.Layout.queueView(new g.Vs.UpdateExpPassword({Title:"Password Expiration",PasswordRules:o.PasswordRulesStr,userid:o.CurrentUserForExpired,Username:o.Username,IsExp:true}));h.dequeue("loadView")}else{if(o.AuthenticationResult==5){p3.Layout.queueView(new g.Vs.RequestComplete({Title:"Login Disabled",CustomMessageId:"3"}));h.dequeue("loadView")}else{$("#Username").select();$("#Password").val("");p3.Data.Alerts.add({type:"error",message:"Sign-In failed. Please try again."})}}g.Us.ResetLoginScreen();g.Us.RenderAlerts()}};g.Us.CheckSignInActions=function(n,l){if(n.SignInActions&&n.SignInActions.length>0){p3.Data.SignInActions=new g.Cs.SignInActions(n.SignInActions);p3.Data.UserId=n.CurrentUserForExpired;var m=p3.Data.SignInActions.find(function(o){return o.get("action_type")!=0});if(m!=undefined&&m!=null){p3.Data.CustomProfileDataMessages=new g.Cs.CustomMessages();p3.Data.CustomProfileDataMessages.add(new g.Ms.CustomMessage({custMsgId:10}));p3.Data.CustomProfileDataMessages.add(new g.Ms.CustomMessage({custMsgId:11}));p3.Data.CustomProfileDataMessages.add(new g.Ms.CustomMessage({custMsgId:12}));if(p3.Data.CustomProfileDataMessages.length>0){p3.Data.CustomProfileDataMessages.each(function(o){o.fetch({error:function(){p3.rV(new g.Vs.AlertView({type:"error",message:"Error getting CustomProfileDataMessage."}),l.Alert,false)}})})}}if(p3.Layout.Containers.Content&&p3.Layout.Containers.Content.length){p3.Layout.queueView(new g.Vs.SignInActionMessages({collection:p3.Data.SignInActions}))}else{h.queue("loadView",function(){p3.rV(new g.Vs.SignInActionMessages({collection:p3.Data.SignInActions}),p3.Layout.Containers.Main,true)});h.queue("loadView",function(){g.Us.renderResize(0)});h.queue("loadView",function(){g.Us.renderFade(p3.Layout.Containers.Login,1,700)})}h.dequeue("loadView")}else{g.Us.transferHome()}};g.Us.checkTimeout=function(){var n=p3.Data.UserStatus,m=false,l=false;if(n){m=n.get("TokenValid");l=n.get("DeviceValid")}if(n.get("AuthUsingBbid")){g.Us.isBbidTokenValidForUser().then(function(o){if(o&&m){if(n.get("MinutesSinceActive")<=3){g.Us.bbidKeepAlive()}else{if(n.get("MinutesSinceActive")>=13){p3.rV(new g.Vs.InactivityWarningModal(),p3.Layout.Containers.Modal,true);p3.showModal(p3.Layout.Containers.Modal)}}}else{n.unstream();g.Us.signout()}})}else{if(!m){n.unstream();if(!l){g.Us.showTimeout()}}}};g.Us.signout=function(){var l="/app/signout";location.href=l};g.Us.bbidKeepAlive=function(){$.ajax({url:"https://s21aidntoken00blkbapp01.nxt.blackbaud.com/session/csrf",type:"post",headers:{"X-CSRF":"token_needed"},xhrFields:{withCredentials:true},success:function(l){$.ajax({url:"https://s21aidntoken00blkbapp01.nxt.blackbaud.com/session/renew",type:"post",headers:{"X-CSRF":l.csrf_token},xhrFields:{withCredentials:true},success:function(m){return true},error:function(){return false}})},error:function(){return false}})};g.Us.OnSessionKeepAlive=function(){var l=new g.Ms.BbidStatusById();l.fetch({data:{userId:p3.Data.Context.get("MasterUserInfo").UserId}})};g.Us.isBbidTokenValidForUser=function(){var l=$.Deferred();b.BBAuth.getToken({disableRedirect:true}).then(function(m){$.ajax({url:"/api/bbid/isbbidtokenvalidforuser",headers:{Authorization:"Bearer "+m,"Content-Type":"application/json"},method:"GET",success:function(n){if(n){l.resolve(true)}else{l.resolve(false)}},error:function(o,p,n){l.resolve(false)}})},function(m){l.resolve(false)});return l};g.Us.forceTimeout=function(){if(p3.Data.UserStatus){p3.Data.UserStatus.set("TokenValid",false)}else{g.Us.showTimeout()}};g.Us.showTimeout=function(){var l=$(".login-modal");if(l.length==0){l=$("<div>").addClass("login-modal modal").appendTo("body")}if(!l.hasClass("in")){$(".guider").remove();p3.rV(new g.Vs.Timeout(),l,true);l.modal({backdrop:"static",keyboard:false});l.next().addClass("login-modal-backdrop")}};g.Us.hideTimeout=function(){var l=$(".login-modal");l.modal("hide");p3.clearContainer(l);if(p3.Data.UserStatus){p3.Data.UserStatus.restart(60*1000)}};g.Us.checkVersion=function(){var n=p3.Data.UserStatus,m,l;if(n&&p3.Config.VersionCheckEnabled){m=p3.Config.Version;l=n.get("CurrentVersion");if(m!==l&&!p3.getSessionState("VersionMsg")){p3.setSessionState("VersionMsg",true);p3.Layout.Containers.MainBulletin.html('<div class="main-bulletin-container"><div class="container"><i class="p3icon-notification iconColor pull-left mr-5" style="font-size:24px;"></i><div class="mt-5">There is a new version of the software available.  Please save any changes you have made and <a href="javascript:location.reload();">refresh</a> your browser as soon as possible to complete the upgrade.</div></div></div>')}}};g.Us.guid=function(){var l=new Date().getTime(),m="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var o=(l+Math.random()*16)%16|0;l=Math.floor(l/16);return(n==="x"?o:(o&7|8)).toString(16)});return m};g.Us.loadBrowserInfo=function(m){var l=new g.Ms.BrowserInfo();l.fetch({success:function(){return m(l.toJSON())},error:function(){return m({Status:0})}})};g.Us.showBbidLoginInstructions=function(){g.Us.setContainers();p3.clearContainer(p3.Layout.Containers.Footer);if(p3.Layout.Containers.Modal===undefined){p3.rV(new g.Vs.BbidLoginInstructionsContent(),p3.Layout.Containers.Content,true)}else{p3.rV(new g.Vs.BbidLoginInstructionsModal(),p3.Layout.Containers.Modal,true);p3.showModal(p3.Layout.Containers.Modal,{addClass:"modal-fullsize",backOnHide:false})}};g.Us.showBbidConfirmLink=function(){var l=p3.Data.Context?p3.Data.Context.get("MasterUserInfo").FirstName+" "+p3.Data.Context.get("MasterUserInfo").LastName:"(full name)",m=p3.Data.Context?p3.Data.Context.get("MasterUserInfo").UserName:"(user name)";g.Us.setContainers();p3.clearContainer(p3.Layout.Containers.Footer);if(p3.Layout.Containers.Modal===undefined){p3.rV(new g.Vs.BbidLinkContent({onName:l,onUsername:m}),p3.Layout.Containers.Content,true)}else{p3.rV(new g.Vs.BbidLinkModal({onName:l,onUsername:m}),p3.Layout.Containers.Modal,true);p3.showModal(p3.Layout.Containers.Modal,{addClass:"modal-fullsize",backOnHide:false})}};g.Us.clearBbidStatus=function(){g.Data.Linked=false;g.Data.Linkable=false;g.Data.RequiresBbid=false;g.Data.Hint="";g.Data.Match="";g.Data.MatchType=0;g.Data.DomainList="";g.Data.AlternateDomainList="";g.Data.Disabled=false};g.Us.setBbidStatus=function(l){g.Us.clearBbidStatus();if(l){g.Data.Linked=l.hasOwnProperty("Linked")?(l.Linked||false):(l.get("Linked")||false);g.Data.Linkable=l.hasOwnProperty("Linkable")?(l.Linkable||false):(l.get("Linkable")||false);g.Data.RequiresBbid=g.Data.Linked||g.Data.Linkable;g.Data.Hint=l.hasOwnProperty("Hint")?(l.Hint||""):(l.get("Hint")||"");g.Data.Match=l.hasOwnProperty("Match")?(l.Match||""):(l.get("Match")||"");g.Data.MatchType=l.hasOwnProperty("MatchType")?l.MatchType:(l.get("MatchType"));g.Data.DomainList=l.hasOwnProperty("DomainList")?l.DomainList:l.get("DomainList");g.Data.AlternateDomainList=l.hasOwnProperty("AlternateDomainList")?l.AlternateDomainList:(l.get("AlternateDomainList"));g.Data.Disabled=l.hasOwnProperty("Disabled")?(l.Disabled||false):(l.get("Disabled")||false)}};g.Us.clearBbidSettings=function(){g.Data.BbidFlow=false;g.Data.BbidSession=false;g.Data.BbidName="";g.Data.BbidEmailAddress="";g.Us.clearBbidStatus()};g.Us.LoginDisabled=function(m){var l={Title:"Login Disabled",CustomMessageId:"3",SuppressLink:(m||false)};if(p3.Layout.Containers.Content!==undefined&&p3.Layout.Containers.Content!==null&&p3.Layout.Containers.Content.length){p3.Layout.queueView(new g.Vs.RequestComplete(l))}else{h.queue("loadView",function(){p3.rV(new g.Vs.RequestComplete(l),p3.Layout.Containers.Main,true)});h.queue("loadView",function(){g.Us.renderResize(500,0)});h.queue("loadView",function(){g.Us.renderFade(p3.Layout.Containers.Login,1,700)})}h.dequeue("loadView")};g.Us.LinkRouteForLoginPage=function(){var l="login";if(window.location.href.indexOf("/apply")>-1){l="login/apply"}else{if(g.Data.BbidFlow){l="login"}}return l};g.Us.ReloadLinkRouteForLoginPage=function(){var l=false;if(window.location.href.indexOf("/apply")>-1){l=true}else{if(g.Data.BbidFlow){l=true}}return l};g.Us.ShowLoginHelpLink=function(l){if(l.SignInOption===0||l.SignInOption===2){return false}return true};g.Us.UseLoginHelpLink=function(l){if(l.SignInOption===0||l.SignInOption===1){return false}return true};g.Us.HelpPanel=function(m){var l=$("#bb-help-container");if(l){if(m){if(l&&g.Data.HelpPanel){l.show();g.Data.HelpPanel=false}}else{if(l&&l.is(":visible")){l.hide();g.Data.HelpPanel=true}else{g.Data.HelpPanel=false}}}};g.Us.redirectToBBLogin=function(m){var o=(!window.location.origin)?window.location.protocol+"//"+window.location.host:window.location.origin,n=o+"/app#login",l="https://signin.blackbaud.com/signin?redirectUrl="+encodeURIComponent(n);if(m!==undefined&&m.length>0){l=l+"&login_hint="+encodeURIComponent(m)}location.href=l};g.Us.RenderAlerts=function(l){if(l){p3.Layout.Containers.Alert=l}p3.rV(new g.Vs.AlertsView({collection:p3.Data.Alerts}),p3.Layout.Containers.Alert,false)};g.Us.ResetLoginScreen=function(){$("#loginBtn").button("reset");if(g.Data.BbidFlow){$("#areaCancel").show()}};g.Us.autoLinkBbidUser=function(l){$.ajax({url:"/api/bbid/link",data:{signout:true},headers:{Authorization:"Bearer "+l,"Content-Type":"application/json"},method:"GET",success:function(m){if(m.linked){window.location.reload(true)}}})};p3.router().route("login","login",function(m){function l(){if(p3.Layout.Containers.Content!==undefined&&p3.Layout.Containers.Content!==null&&p3.Layout.Containers.Content.length){p3.Layout.queueView(new g.Vs.BbidMain({showPassword:false}))}else{h.queue("loadView",function(){p3.rV(new g.Vs.BbidMain({showPassword:false}),p3.Layout.Containers.Main,true)});h.queue("loadView",function(){g.Us.renderResize(500,0)});h.queue("loadView",function(){g.Us.renderFade(p3.Layout.Containers.Login,1,700)})}h.dequeue("loadView")}if(p3.isAppEapActive(d.SimpleAppEAP.BBIDAUTH)){g.Us.clearBbidSettings();g.Data.BbidFlow=true;b.BBAuth.getToken({disableRedirect:true}).then(function(n){$.ajax({url:"/api/bbid/login",headers:{Authorization:"Bearer "+n,"Content-Type":"application/json"},method:"GET",success:function(p){var o;g.Data.BbidSession=true;if(p.AuthenticationResult===5){g.Us.LoginDisabled(true)}else{if(p.AuthenticationResult===0){if(p3.Data.Context){g.Us.transferHome()}else{g.Us.CheckSignInActions(p,p3.Layout.Containers)}}else{g.Data.BbidName=p.LinkName;g.Data.BbidEmailAddress=p.LinkEmail;if(p3.Data.Context){o=new g.Ms.BbidStatusById();o.fetch({data:{userId:p3.Data.Context.get("MasterUserInfo").UserId},success:function(q){g.Us.setBbidStatus(q);if(!g.Data.Linked){if(g.Data.Linkable){if(g.Data.MatchType==2&&(g.Data.BbidEmailAddress.toLowerCase()==g.Data.Match.toLowerCase())){g.Us.autoLinkBbidUser(n)}else{g.Us.showBbidConfirmLink()}}else{g.Us.transferHome()}}return false},error:function(){return false}})}else{o=new g.Ms.BbidStatusById();$.ajax({url:"/api/bbid/statusbybbid",headers:{Authorization:"Bearer "+n,"Content-Type":"application/json"},method:"GET",success:function(q){g.Us.setBbidStatus(q);if(!g.Data.Linked){if(g.Data.Linkable&&g.Data.MatchType==2&&(g.Data.BbidEmailAddress.toLowerCase()==g.Data.Match.toLowerCase())){g.Us.autoLinkBbidUser(n)}else{l()}}return false},error:function(){return false}})}}}return false},error:function(o){return false}})},function(o){if(p3.Data.Context){var n=new g.Ms.BbidStatusById();n.fetch({data:{userId:p3.Data.Context.get("MasterUserInfo").UserId},success:function(p){g.Us.setBbidStatus(p);if(g.Data.Linked){g.Us.redirectToBBLogin()}else{if(g.Data.Linkable){g.Us.showBbidLoginInstructions()}else{g.Us.transferHome()}}return false},error:function(){return false}})}else{l();return false}})}else{g.Us.clearBbidSettings();if(p3.Layout.Containers.Content!=undefined&&p3.Layout.Containers.Content!=null&&p3.Layout.Containers.Content.length){p3.Layout.queueView(new g.Vs.Main())}else{h.queue("loadView",function(){p3.rV(new g.Vs.Main(),p3.Layout.Containers.Main,true)});h.queue("loadView",function(){g.Us.renderResize(500,0)});h.queue("loadView",function(){g.Us.renderFade(p3.Layout.Containers.Login,1,700)})}h.dequeue("loadView")}});p3.router().route("login/request","loginRequest",function(l){g.Us.clearBbidSettings();if(l==="y"){g.Data.BbidFlow=true}if(p3.Layout.Containers.Content.length){p3.Layout.queueView(new g.Vs.Request({Title:"Login Help"}))}else{h.queue("loadView",function(){p3.rV(new g.Vs.Request({Title:"Login Help"}),p3.Layout.Containers.Main,true)});h.queue("loadView",function(){g.Us.renderResize(500,0)});h.queue("loadView",function(){g.Us.renderFade(p3.Layout.Containers.Login,1,700)})}h.dequeue("loadView")});p3.router().route("login/reset(/apply)","loginReset",function(l){if(p3.Layout.Containers.Content.length){p3.Layout.queueView(new g.Vs.UpdatePasswordLink({Title:"Login Reset"}))}else{h.queue("loadView",function(){p3.rV(new g.Vs.UpdatePasswordLink({Title:"Login Reset"}),p3.Layout.Containers.Main,true)});h.queue("loadView",function(){g.Us.renderResize(500,0)});h.queue("loadView",function(){g.Us.renderFade(p3.Layout.Containers.Login,1,700)})}h.dequeue("loadView")});p3.router().route("login/apply","loginApply",function(m){g.Us.clearBbidSettings();var l=new g.Ms.HasOnlineApp();l.fetch({success:function(s){var q,r,p,o,n;if(s.get("Message")=="False"){if(p3.Data.Context){a.Us.loadDefaultRoute()}else{window.location="#login"}}else{if(p3.Data.Context){q=_.some(p3.Data.Context.attributes.Personas,function(t){return t.Id==1});r=_.some(p3.Data.Context.attributes.Personas,function(t){return t.Id==2});p=(j.Us.getLinkById(53071).length)?true:false;o=0;if(p3.Data.Context.attributes.Children){n=_.filter(p3.Data.Context.attributes.Children,function(t){return t.ParentRoleId==554});if(n.length){o=n[0].Id}}if(q&&p&&o>0){window.location="/app/parent#candidateview/"+o+"/progress"}else{if(r){a.Us.loadDefaultRoute()}else{window.location="/app/"+p3.Data.Context.attributes.Personas[0].Description+"#apply"}}}else{p3.router().navigate("#login/apply",true)}if(p3.Layout.Containers.Content&&p3.Layout.Containers.Content.length){p3.Layout.queueView(new g.Vs.Apply())}else{h.queue("loadView",function(){p3.rV(new g.Vs.Apply(),p3.Layout.Containers.Main,true)});h.queue("loadView",function(){g.Us.renderResize(0)});h.queue("loadView",function(){g.Us.renderFade(p3.Layout.Containers.Login,1,700)})}h.dequeue("loadView")}}})});p3.router().route("login/ldaptest","loginLdaptest",function(l){g.Us.clearBbidSettings();if(p3.Layout.Containers.Content!=undefined&&p3.Layout.Containers.Content!=null&&p3.Layout.Containers.Content.length){p3.Layout.queueView(new g.Vs.LdapTest())}else{h.queue("loadView",function(){p3.rV(new g.Vs.LdapTest(),p3.Layout.Containers.Main,true)});h.queue("loadView",function(){g.Us.renderResize(500,0)});h.queue("loadView",function(){g.Us.renderFade(p3.Layout.Containers.Login,1,700)})}h.dequeue("loadView")});p3.router().route("login/bbid-beta-link","loginbbid",function(){b.BBAuth.getToken().then(function(l){$.ajax({url:"/api/bbid/link",headers:{Authorization:"Bearer "+l,"Content-Type":"application/json"},method:"GET",success:function(m){p3.log(m)}})})});p3.on("userStatusUpdated",function(){g.Us.checkTimeout();g.Us.checkVersion()})}(p3.module("login"),window.BBAuthClient));var podiumApp=p3,aP=p3.Config.ApiRootPath;p3.Utilities=p3.Us;
